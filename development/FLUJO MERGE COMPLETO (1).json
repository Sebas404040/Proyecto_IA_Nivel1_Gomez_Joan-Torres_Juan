{
  "name": "FLUJO MERGE COMPLETO",
  "nodes": [
    {
      "parameters": {
        "authentication": "serviceAccount",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 2006573822,
          "mode": "list",
          "cachedResultName": "USUARIOS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=2006573822"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "telegram_user",
              "lookupValue": "={{ $json.message.chat.id }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        432,
        6656
      ],
      "id": "f003ef94-6f52-418b-9f49-6c2f02d1dcab",
      "name": "verificar_usuario",
      "alwaysOutputData": true,
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "updates": [
          "message"
        ],
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegramTrigger",
      "typeVersion": 1.2,
      "position": [
        208,
        6656
      ],
      "id": "9d32d763-d5ff-4b3a-9b8e-55103c899264",
      "name": "Telegram Trigger1",
      "webhookId": "b9545048-0e69-4262-a3bf-ea600b19fb38",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "telegram_user",
              "lookupValue": "={{ $json.telegram_user }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        880,
        6560
      ],
      "id": "1e7cfab0-95e4-4adb-a467-68dba2eef199",
      "name": "verificar_sesi√≥n",
      "alwaysOutputData": true,
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "3dc0d987-8bed-4e00-aa71-d5f8a79c1cd0",
              "leftValue": "={{ $json[\"permitido\"] }}",
              "rightValue": true,
              "operator": {
                "type": "boolean",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        656,
        6656
      ],
      "id": "52520425-a668-4f82-855b-0e46f718f573",
      "name": "IF_usuario_existe"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "65b059c5-adb9-4fa8-b3a7-781da7836ce6",
              "leftValue": "={{ $json.pantalla_actual }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "empty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        1104,
        6656
      ],
      "id": "397ba023-0342-449a-aab0-3da179b022be",
      "name": "IF_sesion_iniciada"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "MENU_PRINCIPAL",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "f3f4f434-051e-44c0-8efc-a4999d4e9480"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "2b381b4c-36e3-43b7-a1e6-85fdc2cab3f7",
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "_FALLBACK",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "4bc74d3f-e04d-4ba8-9ea2-b5c552e58045",
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "VER_TAREAS",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "a479d554-8e41-4b26-9a98-543d18fd74f0",
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "MENU_AYUDA",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "281d1e00-6636-4a0b-8ab8-a7be39a84856",
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "MENU_TAREAS",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "29fd0132-ef59-483a-87d6-466a5d27da35",
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "CREAR_TAREA",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "5741e65f-fed6-43aa-96fa-0a1b10795853",
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "MENU_HABITOS",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "196d5f3c-fcab-4bad-be30-e1b901d65783",
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "COMPLETAR_TAREA",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "690c9dbb-afa6-4d0d-8dc9-3982d76ead11",
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "BIENVENIDO",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "8c04cc3b-e2e5-433d-aef2-796370cb8cb3",
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "COMPLETAR_HABITO",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "608ed967-f735-451d-b71c-a435348fbaab",
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "CREAR_HABITO",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "84af09e4-a8ff-4cc2-ad09-fc1e3effb355",
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "MENU_LISTAS",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "ef886759-8771-4f52-b158-c35475f43229",
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "CREAR_LISTA",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "0c611ecb-8d06-4cd8-9b87-c03f915f7ef3",
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "ADD_ITEM_LISTA",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "ee50183a-5b65-4858-be8d-c0829faebfcc",
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "AGREGAR_ITEM_A_LISTA",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {
          "fallbackOutput": "extra"
        }
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        1552,
        6432
      ],
      "id": "9fa25c83-1f07-4be9-a6f2-561da97224c4",
      "name": "CEREBRO_PRINCIPAL"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $json.telegram_user }}",
            "pantalla_actual": "BIENVENIDO",
            "paso_actual": "0",
            "timestamp_ultima_interaccion": "={{$now}}"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1328,
        6584
      ],
      "id": "432d50ab-d348-413b-96ad-692cf0509eaf",
      "name": "Append_session",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Perfecto üòä vamos con tus listas üóÇÔ∏è\n\n¬øQu√© deseas hacer?\n\n1. Crear una nueva lista\n\n2. Ver mis listas\n\n3. Agregar √≠tems a una lista\n\n4. Volver al men√∫ principal\n\nüí° Sugerencia:\nTe recomiendo 1 (Crear una nueva lista).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2000,
        10056
      ],
      "id": "cb59a6da-edcb-4745-9aac-872d8eb8e086",
      "name": "Men√∫ Listas",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Hmm ü§î esa fecha ya pas√≥.\n\nPor favor ingresa una fecha futura.\n\nVuelve a intentarlo üòÅ.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2672,
        6064
      ],
      "id": "397c5a31-8a72-41a2-a012-2ad000d147ba",
      "name": "Fecha en el pasado",
      "webhookId": "431e9db7-ea8c-443c-bb82-65fa90992bd9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Ups üòÖ la fecha no tiene el formato correcto.\n\nRecuerda usar: YYYY-MM-DD\nEjemplo: 2025-12-20\n\nVuelve a intentarlo. üòÅ",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        6160
      ],
      "id": "0c6b3b2f-b7c1-4cf2-827a-3147a6d80aff",
      "name": "Fecha Invalida",
      "webhookId": "032cae0e-0c44-46ea-ab8d-e61649d9bca9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Hola, soy AgendaBot üëã\n\nEstoy aqu√≠ para ayudarte a organizar tus citas, tareas y recordatorios\nde forma sencilla y sin complicaciones.\n\nPuedes escribirme en cualquier momento.\nPara avanzar, solo tienes que escribir el n√∫mero de la opci√≥n que quieras usar.\n\nMen√∫ principal:\n0. Ayuda\n\n1. Agenda (citas)\n\n2. Tareas\n\n3. Recordatorios\n\n4. H√°bitos\n\n5. Listas\n\n6. Reportes\n\n7. Configuraci√≥n\n\n8. Administrador\n\nTip r√°pido:\nescribe solo el n√∫mero (por ejemplo: 1) y presiona enviar.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        1776,
        4432
      ],
      "id": "7e41eeee-627d-43c9-89f6-c68ffadbf4d3",
      "name": "Bienvenida",
      "webhookId": "e85291c3-1b7e-48ad-8b3b-5569eb31d4c9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "=Ups, esa opci√≥n no existe en este men√∫ üòÖ\n\nPor favor escribe uno de los n√∫meros que ves en el menu.\n\n  üëâ Tip: escribe solo el n√∫mero (por ejemplo: 1). ",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2000,
        4048
      ],
      "id": "a3a7db7c-81ae-4a84-8638-832ae534f7ab",
      "name": "Opci√≥n No Valida",
      "webhookId": "e85291c3-1b7e-48ad-8b3b-5569eb31d4c9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "59ec2c01-acd7-45e6-8fc0-e448481b5018",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "0",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        1776,
        1840
      ],
      "id": "967836c6-d889-49d9-988e-01e9055d56e0",
      "name": "IF_ayuda"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Claro, te ayudo üòä\n\nSoy AgendaBot y puedo ayudarte a:\n\n- Agendar y gestionar citas\n\n- Crear y organizar tareas\n\n- Llevar recordatorios\n\n- Registrar h√°bitos\n\n- Crear listas personalizadas\n\nPara usarme, solo escribe el n√∫mero de la opci√≥n que quieras.\n\n¬øQu√© deseas hacer ahora?\n\n1. Ir al men√∫ principal\n\n2. Salir\n\nüí° Sugerencia:\nTe recomiendo ir al men√∫ principal (1) para empezar.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2000,
        1840
      ],
      "id": "96454d28-f88a-494c-b9dd-30bb88f98753",
      "name": "Men√∫ Ayuda",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "3fa5b9ad-92f0-4a62-8e17-26eb334ccd80",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "2",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        1776,
        2368
      ],
      "id": "f58290d0-2df3-4b1a-a1a5-9fe018a650ff",
      "name": "IF_menu_ayuda_opcion_2"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "f4420a47-aa1e-4af0-a46a-cc18451837ad",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "1",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        1776,
        2080
      ],
      "id": "2a16d007-5638-4f01-92ed-dc5c694482b9",
      "name": "IF_menu_ayuda_opcion_1"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "d6e404d8-8d75-4792-84b6-069a79cb7d26",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "2",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        1776,
        2608
      ],
      "id": "6bbe8b31-3ab9-4f92-9b7e-d5021dda4a55",
      "name": "IF_tarea"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "5630fc3c-757e-40b0-8323-6ff5372bde8a",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "4",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        1776,
        4240
      ],
      "id": "79f78e10-08f4-49cf-9878-62fabb31c2db",
      "name": "IF_habitos"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Perfecto, vamos con tus tareas üìù\n\n¬øQu√© deseas hacer?\n\n1. Crear una nueva tarea\n\n2. Ver mis tareas\n\n3. Cambiar estado de una tarea\n\n4. Volver al men√∫ principal\n\nüí° Sugerencia:\nTe recomiendo 1 (Crear una nueva tarea).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2000,
        2608
      ],
      "id": "47678b41-3000-44a5-ae47-f70d966b7967",
      "name": "Men√∫ Tareas",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Genial üòä vamos con tus h√°bitos üîÅ\n\n¬øQu√© deseas hacer?\n\n1. Crear un nuevo h√°bito\n\n2. Ver mis h√°bitos\n\n3. Activar / desactivar un h√°bito\n\n4. Volver al men√∫ principal\n\nüí° Sugerencia:\nTe recomiendo 1 (Crear un nuevo h√°bito).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2000,
        4240
      ],
      "id": "710a079b-c52a-4e5c-a9ef-b47f65bf7011",
      "name": "Men√∫ Habitos",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "26055ed2-afa9-44d1-a964-3c0b488a582c",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "1",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        1776,
        2848
      ],
      "id": "6e3c988b-f48d-44e9-97f6-4a254866dcd4",
      "name": "IF_menu_tareas_opcion_1"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "26055ed2-afa9-44d1-a964-3c0b488a582c",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "2",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        1776,
        3088
      ],
      "id": "ab84a7be-ecd6-40a3-8f27-532df30b666e",
      "name": "IF_menu_tareas_opcion_2"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "26055ed2-afa9-44d1-a964-3c0b488a582c",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "3",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        1776,
        3616
      ],
      "id": "45eda5cf-95e4-4b95-9bde-50c4a7e38bdc",
      "name": "IF_menu_tareas_opcion_3"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "26055ed2-afa9-44d1-a964-3c0b488a582c",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "4",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        1776,
        3808
      ],
      "id": "f24e4154-1372-473f-ba2d-b521438580ad",
      "name": "IF_menu_tareas_opcion_4"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 3
          },
          "conditions": [
            {
              "id": "26055ed2-afa9-44d1-a964-3c0b488a582c",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "1",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "looseTypeValidation": true,
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        1776,
        6968
      ],
      "id": "622438d0-9eb2-40c2-b300-5562315c29cb",
      "name": "IF_menu_habitos_opcion_1"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 3
          },
          "conditions": [
            {
              "id": "26055ed2-afa9-44d1-a964-3c0b488a582c",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "2",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "looseTypeValidation": true,
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        1776,
        7256
      ],
      "id": "ecf37aa3-5528-4704-82ef-4a64c8108936",
      "name": "IF_menu_habitos_opcion_2"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "26055ed2-afa9-44d1-a964-3c0b488a582c",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "3",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        1776,
        7688
      ],
      "id": "2da8d507-4362-4630-b1e1-6cae7ce4ba17",
      "name": "IF_menu_habitos_opcion_3"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 3
          },
          "conditions": [
            {
              "id": "26055ed2-afa9-44d1-a964-3c0b488a582c",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "4",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "looseTypeValidation": true,
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        1776,
        7880
      ],
      "id": "83a44f17-81d3-493c-bb06-a1a8b29e3389",
      "name": "IF_menu_habitos_opcion_4"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "=¬°Todo listo por ahora! üòä\n\nHe cerrado tu sesi√≥n correctamente.\n\nCuando quieras volver, solo escr√≠beme cualquier mensaje\ny retomamos desde el men√∫ principal.\n\n¬°Que tengas un excelente d√≠a! üëã",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2000,
        2416
      ],
      "id": "25f98e02-7ff2-44f8-bc90-2ddb59de7051",
      "name": "Mensaje de Salida",
      "webhookId": "e85291c3-1b7e-48ad-8b3b-5569eb31d4c9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "pantalla_actual": "MENU_AYUDA"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        1840
      ],
      "id": "2a06de15-43b5-4f0d-a087-07a43a0ada3f",
      "name": "Update State MENU_AYUDA",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "¬øEn qu√© te puedo ayudar hoy? üòä\n\nMen√∫ principal:\n0. Ayuda\n\n1. Agenda (citas)\n\n2. Tareas\n\n3. Recordatorios\n\n4. H√°bitos\n\n5. Listas\n\n6. Reportes\n\n7. Configuraci√≥n\n\n8. Administrador\n\nüí° Sugerencia:\nSi quieres empezar r√°pido, te recomiendo la opci√≥n 1 (Agenda).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2000,
        2032
      ],
      "id": "2bf85d83-40c0-42b9-8db0-86362b69c08a",
      "name": "Menu Principal_",
      "webhookId": "e85291c3-1b7e-48ad-8b3b-5569eb31d4c9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "pantalla_actual": "MENU_PRINCIPAL"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        2032
      ],
      "id": "6f496b6f-8097-45b9-bbe6-cc34ed504ab3",
      "name": "Update State MENU_PRINCIPAL",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "pantalla_actual": "BIENVENIDA"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        2416
      ],
      "id": "384b7b01-86a0-42bd-99d0-b3b38f36583e",
      "name": "Update State BIENVENIDA",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "pantalla_actual": "MENU_TAREAS"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        2608
      ],
      "id": "30410705-f32e-431a-824a-1e98391cb277",
      "name": "Update State MENU_TAREAS",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Genial üòä vamos a crear tu tarea.\n\nPaso 1 de 4 ‚Äî T√≠tulo\n\n¬øCu√°l es el t√≠tulo de la tarea?\n\nEscribe una frase corta y clara.\n\nEjemplo:\nPreparar presentaci√≥n del lunes\n\n9. Cancelar",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2000,
        2800
      ],
      "id": "48e45ee4-24b1-4bcc-85d1-82b63840816f",
      "name": "Crear Tarea Paso 1",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "pantalla_actual": "CREAR_TAREA",
            "paso_actual": "1"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        2800
      ],
      "id": "67827fc2-9dbb-4d8c-92b0-a5a62ab7fe3f",
      "name": "Update State CREAR TAREA - PASO 1",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "loose",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.paso_actual }}",
                    "rightValue": 1,
                    "operator": {
                      "type": "number",
                      "operation": "equals"
                    },
                    "id": "5dd6228f-228c-4aa8-8216-762179799a50"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "loose",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "6082eeb4-8f82-44e9-b24e-fb33addcb845",
                    "leftValue": "={{ $json.paso_actual }}",
                    "rightValue": 2,
                    "operator": {
                      "type": "number",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "loose",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "8e9650e2-ceb9-42bb-adbc-9b34fb9c7285",
                    "leftValue": "={{ $json.paso_actual }}",
                    "rightValue": "3",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "loose",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "98c64646-fbe1-4613-a061-b9ff1ed3a97a",
                    "leftValue": "={{ $json.paso_actual }}",
                    "rightValue": "4",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "looseTypeValidation": true,
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        2000,
        5520
      ],
      "id": "78dd0b0e-171c-42a5-8785-bd3415e0c79d",
      "name": "Pasos Tareas",
      "alwaysOutputData": false
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Perfecto üëç\n\nPaso 2 de 4 ‚Äî Prioridad\n\n¬øQu√© prioridad tiene esta tarea?\n\n1. Alta\n\n2. Media\n\n3. Baja\n\n4. Cancelar\n\nüí° Sugerencia:\nNormalmente se usa 2 (Media).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        4912
      ],
      "id": "2a72286d-8542-4698-83f1-e6ab0df1ec7e",
      "name": "Crear Tarea Paso 2",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Muy bien üòä\n\nPaso 3 de 4 ‚Äî Fecha objetivo\n\n¬øPara qu√© fecha te gustar√≠a completar esta tarea?\n\nFormato: YYYY-MM-DD\nEjemplo: 2025-02-15\n\n9. Cancelar\n\nüí° Sugerencia:\nSi no tienes una fecha exacta,\npuedes usar una aproximada y la puedes editar a futuro üòä",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2896,
        5200
      ],
      "id": "b3f8d885-1b8e-4887-bde8-6c44248836de",
      "name": "Crear Tarea Paso 3",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "datos_parciales": "={{\n{\"titulo\":$('Telegram Trigger1').item.json.message.text,\"prioridad\": \"\",\n\"estado\":\"PENDIENTE\",\n\"fecha_objetivo\":\"\",\n\"creado_por\":$('Telegram Trigger1').item.json.message.from.id}\n}}"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        4912
      ],
      "id": "e330de77-56ab-4211-8348-6129700c2861",
      "name": "Update DATOS PARCIALES TITULO",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text.trim() }}",
                    "rightValue": "1",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "f927f65c-783e-4952-8515-93dc69250e56"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "b537dbbf-00e3-4e29-9bd1-9afb646665f2",
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text.trim() }}",
                    "rightValue": "2",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "9202ef44-4e06-4733-ace3-962bce73f83b",
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text.trim() }}",
                    "rightValue": "3",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "1e3b64ac-9751-4922-a393-a024840743d3",
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text.trim() }}",
                    "rightValue": "4",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        2224,
        5456
      ],
      "id": "0e1c5548-0411-4d2d-aad3-e275be284600",
      "name": "Switch1"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "0b302e9e-e735-4a8a-8914-438078516210",
              "name": "datos_parciales",
              "value": "={{\n  Object.assign(\n    $('IF_sesion_iniciada').item.json.datos_parciales.parseJson(),\n    { prioridad: \"ALTA\" }\n  )\n}}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2448,
        5104
      ],
      "id": "a7d4a02e-b63c-46d5-b9c3-da9ed683e98b",
      "name": "PARSE AND ADD PRIORIDAD ALTA"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "0b302e9e-e735-4a8a-8914-438078516210",
              "name": "datos_parciales",
              "value": "={{\n  Object.assign(\n    $('IF_sesion_iniciada').item.json.datos_parciales.parseJson(),\n    { prioridad: \"MEDIA\" }\n  )\n}}",
              "type": "object"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2448,
        5296
      ],
      "id": "e1a39166-15fc-411a-8650-e580da03f35a",
      "name": "PARSE AND ADD PRIORIDAD MEDIA"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "0b302e9e-e735-4a8a-8914-438078516210",
              "name": "datos_parciales",
              "value": "={{\n  Object.assign(\n    $('IF_sesion_iniciada').item.json.datos_parciales.parseJson(),\n    { prioridad: \"BAJA\" }\n  )\n}}",
              "type": "object"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2448,
        5488
      ],
      "id": "71350cc8-3e50-4e1f-856a-1f9112b6d214",
      "name": "PARSE AND ADD PRIORIDAD BAJA"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Perfecto, vamos con tus tareas üìù\n\n¬øQu√© deseas hacer?\n\n1. Crear una nueva tarea\n\n2. Ver mis tareas\n\n3. Cambiar estado de una tarea\n\n4. Volver al men√∫ principal\n\nüí° Sugerencia:\nTe recomiendo 1 (Crear una nueva tarea).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2672,
        5680
      ],
      "id": "a1a1f3b4-0e66-4209-8a4c-c0c6a96ee202",
      "name": "Men√∫ Tareas1",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "pantalla_actual": "MENU_TAREAS"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2896,
        5680
      ],
      "id": "c018b3e5-db31-40d6-baa4-399ff4167165",
      "name": "Update State MENU_TAREAS1",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Est√° bien üòä\n\nHe cancelado la creaci√≥n de la tarea.\n\nVolviendo al men√∫ tareas.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        5680
      ],
      "id": "72582134-7446-4369-b614-7ab0d669ed1a",
      "name": "TEXTO CANCELACION TAREA",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "pantalla_actual": "MENU_HABITOS"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        4240
      ],
      "id": "13e7ffa1-daa9-4225-aa48-b0d8b4c86756",
      "name": "Update State MENU_HABITOS",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "paso_actual": "3"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        3120,
        5200
      ],
      "id": "7c758221-19a2-4aa9-a3b6-7acbac4eef5f",
      "name": "Update State CREAR TAREA - PASO 3",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "4463328a-2d11-4ad0-8d40-59e3c62d6419",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "=^(19|20)\\d{2}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|02-(?:0[1-9]|1\\d|2[0-8]))$",
              "operator": {
                "type": "string",
                "operation": "regex"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        2224,
        6064
      ],
      "id": "912d96cf-a9e0-4e8a-9317-e5a3a1ef3b65",
      "name": "Fecha Formato Valido?"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "paso_actual": "4"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        3344,
        5872
      ],
      "id": "79575605-0ed5-4d5e-bd69-9d4a3aa3c19c",
      "name": "Update State CREAR TAREA - PASO 4  ",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 3
          },
          "conditions": [
            {
              "id": "f741d9d5-3078-4d39-92ac-9f635887baec",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "={{ $now.format('yyyy-MM-dd') }}",
              "operator": {
                "type": "dateTime",
                "operation": "afterOrEquals"
              }
            }
          ],
          "combinator": "and"
        },
        "looseTypeValidation": true,
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        2448,
        5968
      ],
      "id": "417015a5-4632-4e1c-9fe6-52ecf11f9a49",
      "name": "Fecha Futura?"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "0b302e9e-e735-4a8a-8914-438078516210",
              "name": "datos_parciales",
              "value": "={{\n  Object.assign(\n    $('IF_sesion_iniciada').item.json.datos_parciales.parseJson(),\n    { fecha_objetivo: $('Telegram Trigger1').item.json.message.text }\n  )\n}}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2672,
        5872
      ],
      "id": "b7bf1c79-e878-4207-bca7-5cc2e958334e",
      "name": "PARSE AND ADD FECHA OBJETIVO"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "datos_parciales": "={{ $json.datos_parciales }}"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2896,
        5872
      ],
      "id": "e6eba9be-f895-4d04-8467-9622a38c4ea0",
      "name": "Update DATOS PARCIALES E1",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "datos_parciales": "={{ $json.datos_parciales }}"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2672,
        5200
      ],
      "id": "46ba5e32-3b49-4a78-9417-35ce3dbce7e8",
      "name": "Update DATOS PARCIALES PRIORIDAD",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "=Revisa la informaci√≥n de tu tarea üëÄ\n\nT√≠tulo: {{ $json.datos_parciales.parseJson().titulo }}\nPrioridad: {{ $json.datos_parciales.parseJson().prioridad }}\nFecha objetivo: {{ $json.datos_parciales.parseJson().fecha_objetivo }}\nEstado: {{ $json.datos_parciales.parseJson().estado }}\n\n¬øQu√© deseas hacer?\n\n1. Confirmar y guardar\n\n2. Cancelar\n\nüí° Sugerencia:\nTe recomiendo 1 (Confirmar y guardar).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        3120,
        5872
      ],
      "id": "1723807a-25e6-4c0f-ab87-b473bcac7751",
      "name": "Crear Tarea PASO 3 Confirmaci√≥n",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text.trim() }}",
                    "rightValue": "1",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "3b662b24-d82b-4ace-a3ca-d319919fd413"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "c52b8a1e-cdc0-4dd4-a5c8-3139b9c94dcf",
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text.trim() }}",
                    "rightValue": "2",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        2224,
        6448
      ],
      "id": "1b5ebfc3-a8e6-4e1a-a1e5-f06573e6b61d",
      "name": "Confirmar tarea?"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 817811180,
          "mode": "list",
          "cachedResultName": "TAREAS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=817811180"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "titulo": "={{ $json.datos_parciales.parseJson().titulo }}",
            "prioridad": "={{ $json.datos_parciales.parseJson().prioridad }}",
            "estado": "={{ $json.datos_parciales.parseJson().estado }}",
            "creado_por": "={{ $json.datos_parciales.parseJson().creado_por }}",
            "fecha_objetivo": "={{ $json.datos_parciales.parseJson().fecha_objetivo }}",
            "id_tarea": "={{ $json.tarea_id }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "id_tarea",
              "displayName": "id_tarea",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "titulo",
              "displayName": "titulo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "prioridad",
              "displayName": "prioridad",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "estado",
              "displayName": "estado",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "fecha_objetivo",
              "displayName": "fecha_objetivo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "creado_por",
              "displayName": "creado_por",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2896,
        6352
      ],
      "id": "cb5a9a7a-d9e4-4bdf-86a6-98034d9388c7",
      "name": "Append TAREA",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "telegram_user",
              "lookupValue": "={{ $('Telegram Trigger1').item.json.message.from.id }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2448,
        6352
      ],
      "id": "9de22470-4b23-46c6-a25e-1e25701ace50",
      "name": "Get row(s) in sheet",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "action": "generate",
        "dataPropertyName": "tarea_id"
      },
      "type": "n8n-nodes-base.crypto",
      "typeVersion": 1,
      "position": [
        2672,
        6352
      ],
      "id": "d7b13652-a0c9-4389-b8c0-df39f45def25",
      "name": "Crypto"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "¬°Listo! üéâ\n\nTu tarea fue creada correctamente.\n\nVolviendo al men√∫ de tareas",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        3120,
        6352
      ],
      "id": "8a7a7226-9ed0-4c9f-bbaf-2ae5824d82c9",
      "name": "Tarea Guardada Correctamente",
      "webhookId": "032cae0e-0c44-46ea-ab8d-e61649d9bca9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        2448,
        3088
      ],
      "id": "565e12b7-a19f-4c79-94eb-b65349098423",
      "name": "Loop Over Items"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "=-------------------------------------------------------------\n\nT√≠tulo: {{ $json.titulo }}\nPrioridad: {{ $json.prioridad }}\nFecha objetivo: {{ $json.fecha_objetivo }}\nEstado: {{ $json.estado }} {{ $json.estado === 'COMPLETADO' ? '‚úÖ' : '‚õî' }}\n\n-------------------------------------------------------------",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2672,
        3088
      ],
      "id": "635fd9b0-e900-417e-8579-b1422013a30c",
      "name": "Mostrar Tarea Mensaje",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Est√° bien üòä\n\nHe cancelado la creaci√≥n de la tarea.\n\nVolviendo al men√∫ tareas.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        3120,
        6544
      ],
      "id": "e8f28117-cfb9-4dbc-914c-54ada2c1482b",
      "name": "Cancelado Creaci√≥n Tarea Texto",
      "webhookId": "032cae0e-0c44-46ea-ab8d-e61649d9bca9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "pantalla_actual": "MENU_TAREAS"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        3568,
        6448
      ],
      "id": "bb792e3a-b3d1-4238-b3fc-06c749a0c87a",
      "name": "Update State MENU_TAREAS2",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Perfecto, vamos con tus tareas üìù\n\n¬øQu√© deseas hacer?\n\n1. Crear una nueva tarea\n\n2. Ver mis tareas\n\n3. Cambiar estado de una tarea\n\n4. Volver al men√∫ principal\n\nüí° Sugerencia:\nTe recomiendo 1 (Crear una nueva tarea).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        3344,
        6448
      ],
      "id": "37c8e6c8-d084-4a65-bd7b-f948bcb08fe0",
      "name": "Men√∫ Tareas2",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Est√° bien üòä\n\nHe cancelado la creaci√≥n de la tarea.\n\nVolviendo al men√∫ tareas.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2000,
        6728
      ],
      "id": "e80ae111-e351-4d9f-9806-bdaf47d32a41",
      "name": "Cancelado Creaci√≥n Tarea Texto1",
      "webhookId": "032cae0e-0c44-46ea-ab8d-e61649d9bca9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "pantalla_actual": "MENU_TAREAS"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2448,
        6728
      ],
      "id": "875d09c2-9ec5-4b01-9332-bc6e097c58a0",
      "name": "Update State MENU_TAREAS4",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Perfecto, vamos con tus tareas üìù\n\n¬øQu√© deseas hacer?\n\n1. Crear una nueva tarea\n\n2. Ver mis tareas\n\n3. Cambiar estado de una tarea\n\n4. Volver al men√∫ principal\n\nüí° Sugerencia:\nTe recomiendo 1 (Crear una nueva tarea).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2224,
        6728
      ],
      "id": "05e50ce8-c88b-4523-ab2b-5b1c1241365c",
      "name": "Men√∫ Tareas4",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "¬øEn qu√© te puedo ayudar hoy? üòä\n\nMen√∫ principal:\n0. Ayuda\n\n1. Agenda (citas)\n\n2. Tareas\n\n3. Recordatorios\n\n4. H√°bitos\n\n5. Listas\n\n6. Reportes\n\n7. Configuraci√≥n\n\n8. Administrador\n\nüí° Sugerencia:\nSi quieres empezar r√°pido, te recomiendo la opci√≥n 1 (Agenda).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2000,
        3856
      ],
      "id": "32ca7321-03a8-463e-8f51-923cad39cff1",
      "name": "Menu Principal_1",
      "webhookId": "e85291c3-1b7e-48ad-8b3b-5569eb31d4c9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "pantalla_actual": "MENU_PRINCIPAL"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        3856
      ],
      "id": "a75cd145-8784-4b1f-8669-d38d8a57b5fd",
      "name": "Update State MENU_PRINCIPAL1",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        2448,
        4048
      ],
      "id": "f0aeb9f4-23ae-44cc-bc2b-ba20a6e9d2d6",
      "name": "Loop Over Items1"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "=-------------------------------------------------------------\n\nID: {{ $json.id_tarea }}\nT√≠tulo: {{ $json.titulo }}\nPrioridad: {{ $json.prioridad }}\nFecha objetivo: {{ $json.fecha_objetivo }}\nEstado: {{ $json.estado }} {{ $json.estado === 'COMPLETADO' ? '‚úÖ' : '‚õî' }}\n\n-------------------------------------------------------------",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2672,
        4048
      ],
      "id": "8e042d86-8673-4f29-b9b3-3ca66186435d",
      "name": "Mostrar Tarea Mensaje1",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "=Dame el id de la tarea que desees marcar como completada üòÅ.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2672,
        3856
      ],
      "id": "100f6bce-2148-43f6-8c6c-c2d6883f15a4",
      "name": "Pedir ID Tarea para completar",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "executeOnce": true,
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "paso_actual": "1",
            "pantalla_actual": "COMPLETAR_TAREA"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2896,
        3856
      ],
      "id": "53aaf946-75d7-4b85-9832-fac7336c4e57",
      "name": "Update State COMPLETAR TAREA - PASO 1",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 817811180,
          "mode": "list",
          "cachedResultName": "TAREAS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=817811180"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "id_tarea": "={{ $('Telegram Trigger1').item.json.message.text }}",
            "estado": "COMPLETADO"
          },
          "matchingColumns": [
            "id_tarea"
          ],
          "schema": [
            {
              "id": "id_tarea",
              "displayName": "id_tarea",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "titulo",
              "displayName": "titulo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "prioridad",
              "displayName": "prioridad",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "estado",
              "displayName": "estado",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "fecha_objetivo",
              "displayName": "fecha_objetivo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "creado_por",
              "displayName": "creado_por",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1776,
        4624
      ],
      "id": "b57ec98c-b8dd-4e3c-87fe-5acbed8df78b",
      "name": "Update row Marcar Tarea Completada",
      "alwaysOutputData": true,
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Perfecto, vamos con tus tareas üìù\n\n¬øQu√© deseas hacer?\n\n1. Crear una nueva tarea\n\n2. Ver mis tareas\n\n3. Cambiar estado de una tarea\n\n4. Volver al men√∫ principal\n\nüí° Sugerencia:\nTe recomiendo 1 (Crear una nueva tarea).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2672,
        2896
      ],
      "id": "68c2a2f9-b490-4415-bf2f-696aa865c0e4",
      "name": "Men√∫ Tareas5",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "executeOnce": true,
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "pantalla_actual": "MENU_TAREAS"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2896,
        2896
      ],
      "id": "f6b61c0b-4d3c-4481-8d69-20331346c2b9",
      "name": "Update State MENU_TAREAS5",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "ddd619b2-6740-45de-a958-a8bf36816a53",
              "leftValue": "={{ $json.id_tarea }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        2000,
        4624
      ],
      "id": "48b7b934-6905-4dd0-a9ff-fa7ce240468f",
      "name": "Se actualizo correcto?"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "=Excelente üòä\n\nSe a marcado la tarea de ID:{{ $('Update row Marcar Tarea Completada').item.json.id_tarea }} , como completada\n\nVolviendo al men√∫ tareas.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2224,
        4528
      ],
      "id": "40e18c66-c293-42e9-b135-10e4453ce213",
      "name": "TAREA ACTUALIZADA TEXTO",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "=Oh oh, no hemos encontrado ninguna tarea con esa ID ü•∫\n\nVolviendo al men√∫ tareas.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2224,
        4720
      ],
      "id": "e16e7ac2-d4a4-46ae-8f13-049cc63faa01",
      "name": "VOLVIENDO MENU TAREAS TEXTO",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Perfecto, vamos con tus tareas üìù\n\n¬øQu√© deseas hacer?\n\n1. Crear una nueva tarea\n\n2. Ver mis tareas\n\n3. Cambiar estado de una tarea\n\n4. Volver al men√∫ principal\n\nüí° Sugerencia:\nTe recomiendo 1 (Crear una nueva tarea).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        4624
      ],
      "id": "5d65a48a-eb78-4c65-92b3-aa54c32c4155",
      "name": "Men√∫ Tareas6",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "pantalla_actual": "MENU_TAREAS"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2672,
        4624
      ],
      "id": "3364ee18-2b4b-42fa-90f8-631aa95a842c",
      "name": "Update State MENU_TAREAS6",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 2006573822,
          "mode": "list",
          "cachedResultName": "USUARIOS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=2006573822"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "nombre": "={{ $('Telegram Trigger1').item.json.message.from.first_name }}",
            "rol": "USER",
            "permitido": "TRUE"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "nombre",
              "displayName": "nombre",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "rol",
              "displayName": "rol",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "permitido",
              "displayName": "permitido",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        880,
        6752
      ],
      "id": "fbf0cd88-3e9d-4b66-8e23-7f1e79da08dd",
      "name": "Crear Usuario",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "pantalla_actual": "MENU_PRINCIPAL"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2000,
        4432
      ],
      "id": "54172b38-b70b-44ef-b1d0-dbaf0960e670",
      "name": "Update State MENU_PRINCIPAL2",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "26055ed2-afa9-44d1-a964-3c0b488a582c",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "1",
              "operator": {
                "type": "string",
                "operation": "notEquals"
              }
            },
            {
              "id": "5afdbbd6-d21b-4fe1-b42f-dc891e23d7f3",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "2",
              "operator": {
                "type": "string",
                "operation": "notEquals"
              }
            },
            {
              "id": "18ea7c38-a443-4c28-b1c7-e3ae748007d3",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "3",
              "operator": {
                "type": "string",
                "operation": "notEquals"
              }
            },
            {
              "id": "a33cff58-dafb-484a-82eb-44bc6bd4d0ce",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "=4",
              "operator": {
                "type": "string",
                "operation": "notEquals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        1776,
        4048
      ],
      "id": "a6e9cb08-b8b5-4583-a359-5da0bef19a26",
      "name": "IF_menu_tareas_opcion_no_valida"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Perfecto, vamos con tus tareas üìù\n\n¬øQu√© deseas hacer?\n\n1. Crear una nueva tarea\n\n2. Ver mis tareas\n\n3. Cambiar estado de una tarea\n\n4. Volver al men√∫ principal\n\nüí° Sugerencia:\nTe recomiendo 1 (Crear una nueva tarea).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2224,
        4048
      ],
      "id": "b0a3947d-b293-4fca-9701-1a81f77de3b0",
      "name": "Men√∫ Tareas7",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Genial üòä vamos a crear tu h√°bito.\n\nPaso 1 de 4 ‚Äî Nombre\n\n¬øC√≥mo se llama el h√°bito?\n\nEscribe una frase corta y clara.\n\nEjemplo:\nTomar 2 litros de agua\n\n9. Cancelar",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2000,
        6920
      ],
      "id": "c29b0930-711d-45ff-838e-8d85907e3f99",
      "name": "CREAR HABITO PASO 1",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 3
          },
          "conditions": [
            {
              "id": "befa34cd-bb19-4c26-94a2-8c4711de9bb9",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "9",
              "operator": {
                "type": "string",
                "operation": "notEquals"
              }
            }
          ],
          "combinator": "and"
        },
        "looseTypeValidation": true,
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        1776,
        5672
      ],
      "id": "8cf028ff-5f43-437e-80ef-492d16f3f425",
      "name": "IF no cancelar crear tarea?"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 3
          },
          "conditions": [
            {
              "id": "befa34cd-bb19-4c26-94a2-8c4711de9bb9",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "9",
              "operator": {
                "type": "string",
                "operation": "notEquals"
              }
            }
          ],
          "combinator": "and"
        },
        "looseTypeValidation": true,
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        1776,
        8864
      ],
      "id": "f5da9a07-3c2f-4ff1-8570-5408ce8668db",
      "name": "IF no cancelar crear habito?"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "loose",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.paso_actual }}",
                    "rightValue": "1",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "d71c40af-b85a-44be-9408-6e0c697ea94b"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "loose",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "2c3caf4c-3b74-485b-8391-a38442e1d7e0",
                    "leftValue": "={{ $json.paso_actual }}",
                    "rightValue": "2",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "loose",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "854d4ea5-7853-4137-ab76-1ce938e854e0",
                    "leftValue": "={{ $json.paso_actual }}",
                    "rightValue": "3",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "loose",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "681e83b5-68c5-4d1c-abc0-0c93aea12581",
                    "leftValue": "={{ $json.paso_actual }}",
                    "rightValue": "4",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "looseTypeValidation": true,
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        2000,
        8752
      ],
      "id": "c70b7899-69e2-4d6c-9bf9-a6f9769de8f8",
      "name": "Pasos Habitos"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Est√° bien üòä\n\nHe cancelado la creaci√≥n del habito.\n\nVolviendo al men√∫ de h√°bitos.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2000,
        9576
      ],
      "id": "4cea7db2-a57f-4071-95ec-1258a24e948e",
      "name": "Cancelado Creaci√≥n Habito",
      "webhookId": "032cae0e-0c44-46ea-ab8d-e61649d9bca9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Genial üòä vamos con tus h√°bitos üîÅ\n\n¬øQu√© deseas hacer?\n\n1. Crear un nuevo h√°bito\n\n2. Ver mis h√°bitos\n\n3. Activar / desactivar un h√°bito\n\n4. Volver al men√∫ principal\n\nüí° Sugerencia:\nTe recomiendo 1 (Crear un nuevo h√°bito).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2224,
        9576
      ],
      "id": "aa989a87-e42f-42df-8d29-ff2927a14436",
      "name": "Men√∫ Habitos1",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "pantalla_actual": "MENU_HABITOS"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2448,
        9576
      ],
      "id": "0a6fa34e-3626-4e9e-aef8-885c66534aa0",
      "name": "Update State MENU_HABITOS1",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "paso_actual": "2"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2896,
        8024
      ],
      "id": "0d7ea3c6-af81-4330-b5d5-f870c6ab683a",
      "name": "Update State CREAR HABITO - PASO 2",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "pantalla_actual": "CREAR_HABITO",
            "paso_actual": "1"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        6920
      ],
      "id": "87660a9c-816b-4cef-a61c-7fe44fe94da4",
      "name": "Update State CREAR HABITO - PASO 1",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "datos_parciales": "={{\n{\"nombre\":$('Telegram Trigger1').item.json.message.text,\"prioridad\": \"\",\n\"frecuencia\":\"\",\n\"estado\":\"ACTIVO\",\n\"hora_recordatorio\":\"\",\n\"creado_por\":$('Telegram Trigger1').item.json.message.from.id}\n}}"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2448,
        8024
      ],
      "id": "9332f749-6830-4a8b-a2b5-6564cab5214c",
      "name": "Update DATOS PARCIALES Nombre HABITO",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text.trim() }}",
                    "rightValue": "1",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "f927f65c-783e-4952-8515-93dc69250e56"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "b537dbbf-00e3-4e29-9bd1-9afb646665f2",
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text.trim() }}",
                    "rightValue": "2",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "9202ef44-4e06-4733-ace3-962bce73f83b",
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text.trim() }}",
                    "rightValue": "3",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        2224,
        8680
      ],
      "id": "b6329898-e436-4d1e-8f87-ac7b165f1fc9",
      "name": "Switch2"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "0b302e9e-e735-4a8a-8914-438078516210",
              "name": "datos_parciales",
              "value": "={{\n  Object.assign(\n    $('IF_sesion_iniciada').item.json.datos_parciales.parseJson(),\n    { frecuencia: \"DIARIA\" }\n  )\n}}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2448,
        8408
      ],
      "id": "a93b0948-bbb0-4016-9c12-974e7f32f2b2",
      "name": "PARSE AND ADD PRIORIDAD ALTA1"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "0b302e9e-e735-4a8a-8914-438078516210",
              "name": "datos_parciales",
              "value": "={{\n  Object.assign(\n    $('IF_sesion_iniciada').item.json.datos_parciales.parseJson(),\n    { prioridad: \"SEMANAL\" }\n  )\n}}",
              "type": "object"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2448,
        8600
      ],
      "id": "7f0a663c-2581-4a0e-b593-f50001ea496f",
      "name": "PARSE AND ADD PRIORIDAD MEDIA1"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "0b302e9e-e735-4a8a-8914-438078516210",
              "name": "datos_parciales",
              "value": "={{\n  Object.assign(\n    $('IF_sesion_iniciada').item.json.datos_parciales.parseJson(),\n    { prioridad: \"MENSUAL\" }\n  )\n}}",
              "type": "object"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2448,
        8792
      ],
      "id": "0ea1d52f-d1d1-42a9-8454-562a987d12f0",
      "name": "PARSE AND ADD PRIORIDAD BAJA1"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "datos_parciales": "={{ $json.datos_parciales }}"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2672,
        8504
      ],
      "id": "1cdf2bc9-d3c5-4f8d-9225-c07f6526a14e",
      "name": "Update DATOS PARCIALES FRECUENCIA Crear Habito",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Muy bien üòä\n\nPaso 3 de 4 ‚Äî Hora de recordatorio\n\n¬øA qu√© hora te gustar√≠a que te recuerde este h√°bito?\n\nFormato 24 horas: HH:MM\nEjemplo: 08:00\n\n9. Cancelar\n\nüí° Sugerencia:\nUna buena hora suele ser en la ma√±ana üòä",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2896,
        8504
      ],
      "id": "f02cb445-1e91-4775-a65d-5f14a71c229d",
      "name": "Crear Habito Paso 3",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Perfecto üëç\n\nPaso 2 de 4 ‚Äî Frecuencia\n\n¬øCon qu√© frecuencia quieres realizar este h√°bito?\n\n1. Diario\n\n2. Semanal\n\n3. Mensual\n\n9. Cancelar\n\nüí° Sugerencia:\nNormalmente se usa 1 (Diario).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2672,
        8024
      ],
      "id": "ad4d1259-8b97-4094-a3bd-ae69db6b808a",
      "name": "Crear Habito Paso 2",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "paso_actual": "3"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        3120,
        8504
      ],
      "id": "76e691c1-65e0-4cca-b566-34fabce0d793",
      "name": "Update State CREAR HABITO - PASO 3",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Ups üòÖ la hora no tiene un formato v√°lido.\n\nRecuerda usar formato 24 horas:\nHH:MM\n\nEjemplo: 08:00\n\n9. Cancelar",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        9176
      ],
      "id": "a115f94c-6ed4-4619-b7e6-d5b0a70f64ab",
      "name": "Fecha Invalida1",
      "webhookId": "032cae0e-0c44-46ea-ab8d-e61649d9bca9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "4463328a-2d11-4ad0-8d40-59e3c62d6419",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "=^([01]\\d|2[0-3]):[0-5]\\d$",
              "operator": {
                "type": "string",
                "operation": "regex"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        2224,
        9080
      ],
      "id": "41feaca6-db41-4929-86fa-6476f9605aac",
      "name": "Fecha Formato Valido?1"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "paso_actual": "4"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        3120,
        8984
      ],
      "id": "06d89dc1-0dde-428d-99e9-a1f4610f7677",
      "name": "Update State CREAR TAREA - PASO 4  1",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "0b302e9e-e735-4a8a-8914-438078516210",
              "name": "datos_parciales",
              "value": "={{\n  Object.assign(\n    $('IF_sesion_iniciada').item.json.datos_parciales.parseJson(),\n    { hora_recordatorio: $('Telegram Trigger1').item.json.message.text }\n  )\n}}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2448,
        8984
      ],
      "id": "137e1be3-d9b8-428d-bf3b-6ec519686e3b",
      "name": "PARSE AND ADD Hora Recordatorio Habito"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "datos_parciales": "={{ $json.datos_parciales }}"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2672,
        8984
      ],
      "id": "8f96b7a2-8a0d-4a0a-a57a-feec7e8ca3f0",
      "name": "Update DATOS PARCIALES HORA Crear Habito",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "=Revisa la informaci√≥n de tu h√°bito üëÄ\n\nNombre: {{ $json.datos_parciales.parseJson().nombre }}\nFrecuencia: {{$json.datos_parciales.parseJson().frecuencia}}\nHora de recordatorio: {{$json.datos_parciales.parseJson().hora_recordatorio}}\nEstado: {{$json.datos_parciales.parseJson().estado}}\n\n¬øQu√© deseas hacer?\n\n1. Confirmar y guardar\n\n9. Cancelar\n\nüí° Sugerencia:\nTe recomiendo 1 (Confirmar y guardar).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2896,
        8984
      ],
      "id": "6cb7552c-82bf-4ed5-8294-2cd27756e652",
      "name": "Crear Habito PASO 3 Confirmaci√≥n1",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Genial üòä vamos con tus h√°bitos üîÅ\n\n¬øQu√© deseas hacer?\n\n1. Crear un nuevo h√°bito\n\n2. Ver mis h√°bitos\n\n3. Activar / desactivar un h√°bito\n\n4. Volver al men√∫ principal\n\nüí° Sugerencia:\nTe recomiendo 1 (Crear un nuevo h√°bito).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        3120,
        9368
      ],
      "id": "792f4f89-f173-4383-9ff4-80f8c8ea4f5e",
      "name": "Men√∫ Habitos2",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "pantalla_actual": "MENU_HABITOS"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        3344,
        9368
      ],
      "id": "5df2c7c4-9125-4561-b995-c0dc2389a1d5",
      "name": "Update State MENU_HABITOS2",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "telegram_user",
              "lookupValue": "={{ $('Telegram Trigger1').item.json.message.from.id }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        9368
      ],
      "id": "66edc8b4-31c1-4f82-8d29-8838b56273c0",
      "name": "Get row(s) in sheet3",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "action": "generate",
        "dataPropertyName": "habito_id"
      },
      "type": "n8n-nodes-base.crypto",
      "typeVersion": 1,
      "position": [
        2448,
        9368
      ],
      "id": "4d8a548d-1f61-4025-87eb-4bda3098b7bb",
      "name": "Crypto1"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1702648085,
          "mode": "list",
          "cachedResultName": "HABITOS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1702648085"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "id_habito": "={{ $json.habito_id }}",
            "nombre": "={{ $json.datos_parciales.parseJson().nombre }}",
            "hora_recordatorio": "={{ $json.datos_parciales.parseJson().hora_recordatorio }}",
            "frecuencia": "={{ $json.datos_parciales.parseJson().frecuencia }}",
            "estado": "={{ $json.datos_parciales.parseJson().estado }}",
            "creado_por": "={{ $json.datos_parciales.parseJson().creado_por }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "id_habito",
              "displayName": "id_habito",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "nombre",
              "displayName": "nombre",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "frecuencia",
              "displayName": "frecuencia",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "hora_recordatorio",
              "displayName": "hora_recordatorio",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "estado",
              "displayName": "estado",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "creado_por",
              "displayName": "creado_por",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2672,
        9368
      ],
      "id": "c6588468-02f5-40b3-965a-728dddf0aa70",
      "name": "Append HABITO",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "¬°Listo! üéâ\n\nTu h√°bito fue creado correctamente.\n\nVolviendo al men√∫ de habitos",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2896,
        9368
      ],
      "id": "fe389911-a86c-49ef-b684-69f3ee09d329",
      "name": "Habito Guardado Correctamente",
      "webhookId": "032cae0e-0c44-46ea-ab8d-e61649d9bca9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "¬øEn qu√© te puedo ayudar hoy? üòä\n\nMen√∫ principal:\n0. Ayuda\n\n1. Agenda (citas)\n\n2. Tareas\n\n3. Recordatorios\n\n4. H√°bitos\n\n5. Listas\n\n6. Reportes\n\n7. Configuraci√≥n\n\n8. Administrador\n\nüí° Sugerencia:\nSi quieres empezar r√°pido, te recomiendo la opci√≥n 1 (Agenda).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2000,
        7928
      ],
      "id": "a7a667fa-5334-4e80-b280-fb986aaeabb7",
      "name": "Menu Principal_2",
      "webhookId": "e85291c3-1b7e-48ad-8b3b-5569eb31d4c9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "pantalla_actual": "MENU_PRINCIPAL"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        7928
      ],
      "id": "cb00b9a1-b75d-4004-9940-0bd02ed44a10",
      "name": "Update State MENU_PRINCIPAL3",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 817811180,
          "mode": "list",
          "cachedResultName": "TAREAS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=817811180"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "creado_por",
              "lookupValue": "={{ $('Telegram Trigger1').item.json.message.from.id }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2000,
        3184
      ],
      "id": "1f52e7bc-6e08-4d60-90fb-b7b847331b31",
      "name": "Get row(s) Traer Tareas",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 817811180,
          "mode": "list",
          "cachedResultName": "TAREAS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=817811180"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "creado_por",
              "lookupValue": "={{ $('Telegram Trigger1').item.json.message.from.id }}"
            },
            {
              "lookupColumn": "estado",
              "lookupValue": "PENDIENTE"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2000,
        3664
      ],
      "id": "b0f56991-4278-4557-8219-d5a7ab7bbf45",
      "name": "Get row(s) Traer Tareas No Completadas2",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        2448,
        7112
      ],
      "id": "95eed270-41bc-4b48-862e-5d2a4ec9d141",
      "name": "Loop Over Items2"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1702648085,
          "mode": "list",
          "cachedResultName": "HABITOS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1702648085"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "creado_por",
              "lookupValue": "={{ $('Telegram Trigger1').item.json.message.from.id }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2000,
        7304
      ],
      "id": "ad6ac32b-3061-4d45-a87b-83d7f7e80606",
      "name": "Get row(s) Traer Habitos",
      "alwaysOutputData": true,
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Genial üòä vamos con tus h√°bitos üîÅ\n\n¬øQu√© deseas hacer?\n\n1. Crear un nuevo h√°bito\n\n2. Ver mis h√°bitos\n\n3. Activar / desactivar un h√°bito\n\n4. Volver al men√∫ principal\n\nüí° Sugerencia:\nTe recomiendo 1 (Crear un nuevo h√°bito).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2672,
        6880
      ],
      "id": "537f2c02-44d6-4af5-8496-76f551a62664",
      "name": "Men√∫ Habitos3",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "executeOnce": true,
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "pantalla_actual": "MENU_HABITOS"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2896,
        6880
      ],
      "id": "aab8a258-f6cc-43c8-ad06-87cbd3589b07",
      "name": "Update State MENU_HABITOS3",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        2448,
        7832
      ],
      "id": "13bbd7a5-7c71-4bf1-9689-11475eab30d1",
      "name": "Loop Over Items3"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "=-------------------------------------------------------------\nID: {{ $json.id_habito }}\nNombre: {{ $json.nombre }}\nFrecuencia: {{ $json.frecuencia }}\nHora de recordatorio: {{ $json.hora_recordatorio }}\nEstado: {{ $json.estado }} {{ $json.estado == 'ACTIVO' ? '‚úÖ' : '‚õî' }}\n\n-------------------------------------------------------------",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2672,
        7832
      ],
      "id": "272e9e17-fce7-48e8-863f-082f8843534f",
      "name": "Mostrar Tarea Mensaje3",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "paso_actual": "1",
            "pantalla_actual": "COMPLETAR_HABITO"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2896,
        7640
      ],
      "id": "c36c0249-5d57-4169-a011-cab25d69ee7f",
      "name": "Update State COMPLETAR TAREA - PASO ",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1702648085,
          "mode": "list",
          "cachedResultName": "HABITOS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1702648085"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "creado_por",
              "lookupValue": "={{ $('Telegram Trigger1').item.json.message.from.id }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2000,
        7736
      ],
      "id": "5fec0846-6287-4a0f-b9d2-f728d9eda06a",
      "name": "Get row(s) Traer Habitos1",
      "alwaysOutputData": true,
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "=Dame el id de la tarea para cambiar su estado (ACTIVADA -> DESACTIVADA) o (DESACTIVADA -> ACTIVADA) üòÅ.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2672,
        7640
      ],
      "id": "604a07c4-0654-4614-9d13-34865d7857f6",
      "name": "Pedir ID Habito para Toogle",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "executeOnce": true,
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "ddd619b2-6740-45de-a958-a8bf36816a53",
              "leftValue": "={{ $json.id_habito }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        2224,
        9864
      ],
      "id": "05abfe9b-6301-43c3-9e79-228a74720a12",
      "name": "Se actualizo correcto?1"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "=Oh oh, no hemos encontrado ningun habito con esa ID ü•∫\n\nVolviendo al men√∫ habitos.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        10104
      ],
      "id": "80b5d07c-abb8-47e4-af90-f769e8681c3f",
      "name": "VOLVIENDO MENU TAREAS TEXTO1",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1702648085,
          "mode": "list",
          "cachedResultName": "HABITOS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1702648085"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1776,
        9864
      ],
      "id": "3c392d88-ad47-4e0d-916d-b7f8a461220d",
      "name": "Get row(s) in sheet2",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1702648085,
          "mode": "list",
          "cachedResultName": "HABITOS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1702648085"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "estado": "={{ $json.estado == 'ACTIVO' ? 'DESACTIVADO' : 'ACTIVO' }}",
            "id_habito": "={{ $json.id_habito }}"
          },
          "matchingColumns": [
            "id_habito"
          ],
          "schema": [
            {
              "id": "id_habito",
              "displayName": "id_habito",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "nombre",
              "displayName": "nombre",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "frecuencia",
              "displayName": "frecuencia",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "hora_recordatorio",
              "displayName": "hora_recordatorio",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "estado",
              "displayName": "estado",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "creado_por",
              "displayName": "creado_por",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2000,
        9864
      ],
      "id": "b6dcf5e8-03b3-47a4-ba94-b67cdf44799e",
      "name": "Update row Marcar Habito Activado / Desactivado",
      "alwaysOutputData": true,
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "=Excelente üòä\n\nSe a marcado el habito de ID:{{ $('Update row Marcar Habito Activado / Desactivado').item.json.id_habito }} , como {{ $('Update row Marcar Habito Activado / Desactivado').item.json.estado }}\n\nVolviendo al men√∫ tareas.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        9768
      ],
      "id": "366de8e8-a635-4294-b70b-a0ea369a7d1b",
      "name": "HABITO ACTUALIZADA TEXTO1",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Genial üòä vamos con tus h√°bitos üîÅ\n\n¬øQu√© deseas hacer?\n\n1. Crear un nuevo h√°bito\n\n2. Ver mis h√°bitos\n\n3. Activar / desactivar un h√°bito\n\n4. Volver al men√∫ principal\n\nüí° Sugerencia:\nTe recomiendo 1 (Crear un nuevo h√°bito).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2672,
        9864
      ],
      "id": "c6bd9901-27d6-48cc-a19d-e517e733a1d3",
      "name": "Men√∫ Habitos4",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "pantalla_actual": "MENU_HABITOS"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2896,
        9864
      ],
      "id": "db6e81ef-3524-4451-96e4-b521ded0d7d7",
      "name": "Update State MENU_HABITOS4",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "paso_actual": "2"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2672,
        4912
      ],
      "id": "3b7ed156-9363-426e-a60b-7310d9f524ec",
      "name": "Update State CREAR HABITO- PASO 2",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "72667c0d-ae70-4412-83b6-eaa1e51c4dd7",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        2224,
        8120
      ],
      "id": "dc31008c-4bbe-4624-b356-449a77e22c7a",
      "name": "If"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Ups üòÖ el nombre del h√°bito no puede estar vac√≠o.\n\nPor favor escribe un nombre m√°s claro.\n\nEjemplo:\nTomar 2 litros de agua\n\n9. Cancelar",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        8216
      ],
      "id": "34766cac-97c0-4bd0-b540-62ca8c9270fe",
      "name": "Invalido NOMBRE HABITO VACIO",
      "webhookId": "032cae0e-0c44-46ea-ab8d-e61649d9bca9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 3
          },
          "conditions": [
            {
              "id": "3f462906-3232-4515-a2f9-68ad75e6194f",
              "leftValue": "={{ $json }}",
              "rightValue": "",
              "operator": {
                "type": "object",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "looseTypeValidation": true,
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        2224,
        7304
      ],
      "id": "46353b56-ae05-498d-97ed-3ae381c124df",
      "name": "IF TIENE HABITOS?"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Ups üòÖ primero debes de crear un habito.\n\nPuedes hacerlo desde el men√∫ de h√°bitos usando la opci√≥n 1.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        7448
      ],
      "id": "c21dda51-5be6-4781-ab77-5767f919bed2",
      "name": "NO TIENE HABITOS",
      "webhookId": "032cae0e-0c44-46ea-ab8d-e61649d9bca9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 3
          },
          "conditions": [
            {
              "id": "3f462906-3232-4515-a2f9-68ad75e6194f",
              "leftValue": "={{ $json }}",
              "rightValue": "",
              "operator": {
                "type": "object",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "looseTypeValidation": true,
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        2224,
        7736
      ],
      "id": "6b042ce1-1d5b-4cca-ba01-b0bfd194454b",
      "name": "IF TIENE HABITOS?1"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Genial üòä vamos con tus h√°bitos üîÅ\n\n¬øQu√© deseas hacer?\n\n1. Crear un nuevo h√°bito\n\n2. Ver mis h√°bitos\n\n3. Activar / desactivar un h√°bito\n\n4. Volver al men√∫ principal\n\nüí° Sugerencia:\nTe recomiendo 1 (Crear un nuevo h√°bito).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2672,
        7448
      ],
      "id": "6fe2feb3-ffba-44f1-b992-a87b9eaa9155",
      "name": "Men√∫ Habitos5",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "pantalla_actual": "MENU_HABITOS"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2896,
        7448
      ],
      "id": "c54ede83-037d-4803-bff7-b72a2b240a39",
      "name": "Update State MENU_HABITOS5",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 3
          },
          "conditions": [
            {
              "id": "5630fc3c-757e-40b0-8323-6ff5372bde8a",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "5",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "looseTypeValidation": true,
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        1776,
        10056
      ],
      "id": "e8046973-0396-4996-807d-9b550757cfe9",
      "name": "IF_Listas"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "pantalla_actual": "MENU_LISTAS"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        10056
      ],
      "id": "36268e98-f969-4bab-8339-11888adef3e1",
      "name": "Update State MENU_LISTAS",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "26055ed2-afa9-44d1-a964-3c0b488a582c",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "1",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        1776,
        10296
      ],
      "id": "9c2c8d0f-605f-42f9-b02b-500c4e27766f",
      "name": "IF_menu_listas_opcion_1"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "26055ed2-afa9-44d1-a964-3c0b488a582c",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "2",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        1776,
        10584
      ],
      "id": "71bbfda2-fd1b-4a1e-87f8-5a5a42b8609e",
      "name": "IF_menu_listas_opcion_2"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "26055ed2-afa9-44d1-a964-3c0b488a582c",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "3",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        1776,
        11112
      ],
      "id": "805b3375-cc1c-4697-af86-569d92bfd3d2",
      "name": "IF_menu_listas_opcion_3"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "26055ed2-afa9-44d1-a964-3c0b488a582c",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "4",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        1776,
        11304
      ],
      "id": "48f2cc91-58c4-4c6d-a860-3a208f66da22",
      "name": "IF_menu_listas_opcion_4"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Genial üòä vamos a crear tu lista.\n\nPaso 1 de 2 ‚Äî Nombre\n\n¬øC√≥mo se llamar√° la lista?\n\nEscribe un nombre corto y claro.\n\nEjemplo:\nCompras del supermercado\n\n9. Cancelar",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2000,
        10248
      ],
      "id": "59550788-ad64-49ac-ad80-61d95bc6a58e",
      "name": "Crear Lista Paso 1",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "pantalla_actual": "CREAR_LISTA",
            "paso_actual": "1"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        10248
      ],
      "id": "5438e255-a337-457e-b3b7-05f1fb838f65",
      "name": "Update State CREAR LISTAS - PASO 1",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 3
          },
          "conditions": [
            {
              "id": "befa34cd-bb19-4c26-94a2-8c4711de9bb9",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "9",
              "operator": {
                "type": "string",
                "operation": "notEquals"
              }
            }
          ],
          "combinator": "and"
        },
        "looseTypeValidation": true,
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        1776,
        11736
      ],
      "id": "59e85733-e176-4817-a0fc-b9f0951c40d9",
      "name": "IF no cancelar crear lista?"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "datos_parciales": "={{\n{\"nombre_lista\":$('Telegram Trigger1').item.json.message.text,\n\"creado_por\":$('Telegram Trigger1').item.json.message.from.id}\n}}"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        11544
      ],
      "id": "57f735ac-cccb-4fc9-8999-2629bca9c726",
      "name": "Update DATOS PARCIALES NOMBRE LISTA",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "=Revisa la informaci√≥n de tu lista üëÄ\n\nNombre: {{$json.datos_parciales.nombre_lista}}\n\n¬øQu√© deseas hacer?\n\n1. Confirmar y guardar\n\n9. Cancelar\n\nüí° Sugerencia:\nTe recomiendo 1 (Confirmar y guardar).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        11544
      ],
      "id": "7b2dae09-827e-4db9-aede-e52a9f8edca5",
      "name": "Crear LISTA Paso 2",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "paso_actual": "2"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2672,
        11544
      ],
      "id": "68b1cb84-ca62-417f-abda-c7a50b0a3f55",
      "name": "Update State CREAR LISTA- PASO 2",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "telegram_user",
              "lookupValue": "={{ $('Telegram Trigger1').item.json.message.from.id }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        11736
      ],
      "id": "f5b770d3-dfc2-4cca-bac3-2b43cb3399c0",
      "name": "Get row(s) in sheet4",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "action": "generate",
        "dataPropertyName": "id_lista"
      },
      "type": "n8n-nodes-base.crypto",
      "typeVersion": 1,
      "position": [
        2448,
        11736
      ],
      "id": "460dbd3e-c7a5-4c99-877c-6fe4b7fa0ec8",
      "name": "Crypto2"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "¬°Listo! üéâ\n\nTu lista fue creada correctamente.\n\nVolviendo al men√∫ de listas",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2896,
        11736
      ],
      "id": "82d33389-cf46-4017-9b4d-62dbac8d8fea",
      "name": "Habito Guardado Correctamente1",
      "webhookId": "032cae0e-0c44-46ea-ab8d-e61649d9bca9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1968167309,
          "mode": "list",
          "cachedResultName": "LISTAS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1968167309"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "creado_por": "={{ $json.datos_parciales.parseJson().creado_por }}",
            "id_lista": "={{ $json.id_lista }}",
            "nombre_lista": "={{ $json.datos_parciales.parseJson().nombre_lista }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "id_lista",
              "displayName": "id_lista",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "nombre_lista",
              "displayName": "nombre_lista",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "creado_por",
              "displayName": "creado_por",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2672,
        11736
      ],
      "id": "025e987b-9454-46ed-9505-e23cfcd8b91a",
      "name": "Append LISTA",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Perfecto üòä vamos con tus listas üóÇÔ∏è\n\n¬øQu√© deseas hacer?\n\n1. Crear una nueva lista\n\n2. Ver mis listas\n\n3. Agregar √≠tems a una lista\n\n4. Volver al men√∫ principal\n\nüí° Sugerencia:\nTe recomiendo 1 (Crear una nueva lista).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        3120,
        11736
      ],
      "id": "13c2d4cd-d21b-4760-a8cb-64c18a0c1ac4",
      "name": "Men√∫ Listas1",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "pantalla_actual": "MENU_LISTAS"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        3344,
        11736
      ],
      "id": "df0989c8-e01f-49e6-abc6-6fd5820abe3c",
      "name": "Update State MENU_LISTAS1",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "loose",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.paso_actual }}",
                    "rightValue": 1,
                    "operator": {
                      "type": "number",
                      "operation": "equals"
                    },
                    "id": "5dd6228f-228c-4aa8-8216-762179799a50"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "loose",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "6082eeb4-8f82-44e9-b24e-fb33addcb845",
                    "leftValue": "={{ $json.paso_actual }}",
                    "rightValue": 2,
                    "operator": {
                      "type": "number",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "looseTypeValidation": true,
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        2000,
        11640
      ],
      "id": "74011ca1-6d18-42c1-b0c4-bd9ce118c6a9",
      "name": "Pasos Listas"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Perfecto üòä vamos con tus listas üóÇÔ∏è\n\n¬øQu√© deseas hacer?\n\n1. Crear una nueva lista\n\n2. Ver mis listas\n\n3. Agregar √≠tems a una lista\n\n4. Volver al men√∫ principal\n\nüí° Sugerencia:\nTe recomiendo 1 (Crear una nueva lista).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2224,
        11928
      ],
      "id": "240876af-1334-419e-a2a9-fedcc16b683f",
      "name": "Men√∫ Listas2",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "pantalla_actual": "MENU_LISTAS"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2448,
        11928
      ],
      "id": "e0521f3f-a212-49c4-bd46-6ab35667d16e",
      "name": "Update State MENU_LISTAS2",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        2448,
        10560
      ],
      "id": "425711a0-e07a-4442-9371-73fcd21198d1",
      "name": "Loop Over Items4"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1968167309,
          "mode": "list",
          "cachedResultName": "LISTAS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1968167309"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "creado_por",
              "lookupValue": "={{ $('Telegram Trigger1').item.json.message.from.id }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2000,
        10632
      ],
      "id": "267a0df5-e425-4f57-8680-1abc51a3152e",
      "name": "Get row(s) Traer Listas",
      "alwaysOutputData": true,
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Perfecto üòä vamos con tus listas üóÇÔ∏è\n\n¬øQu√© deseas hacer?\n\n1. Crear una nueva lista\n\n2. Ver mis listas\n\n3. Agregar √≠tems a una lista\n\n4. Volver al men√∫ principal\n\nüí° Sugerencia:\nTe recomiendo 1 (Crear una nueva lista).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2672,
        10248
      ],
      "id": "9911eddd-7c96-441d-9ec5-44ab7deaa0dd",
      "name": "Men√∫ Listas3",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "executeOnce": true,
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "pantalla_actual": "MENU_LISTAS"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2896,
        10248
      ],
      "id": "5a0c2f3e-2898-435d-bef5-384bf2d2faf0",
      "name": "Update State MENU_LISTAS3",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1968167309,
          "mode": "list",
          "cachedResultName": "LISTAS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1968167309"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "creado_por",
              "lookupValue": "={{ $('Telegram Trigger1').item.json.message.from.id }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2000,
        11160
      ],
      "id": "257937f4-1527-4bb2-b330-00244b287292",
      "name": "Get row(s) Traer Listas1",
      "alwaysOutputData": true,
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Ups üòÖ primero debes de crear un habito.\n\nPuedes hacerlo desde el men√∫ de h√°bitos usando la opci√≥n 1.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        10872
      ],
      "id": "f4d6954b-e896-4b1c-be9e-c1f42c22ce06",
      "name": "NO TIENE LISTAS",
      "webhookId": "032cae0e-0c44-46ea-ab8d-e61649d9bca9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Perfecto üòä vamos con tus listas üóÇÔ∏è\n\n¬øQu√© deseas hacer?\n\n1. Crear una nueva lista\n\n2. Ver mis listas\n\n3. Agregar √≠tems a una lista\n\n4. Volver al men√∫ principal\n\nüí° Sugerencia:\nTe recomiendo 1 (Crear una nueva lista).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2672,
        10872
      ],
      "id": "99797a85-e47a-4d01-9b2a-237a2ae19115",
      "name": "Men√∫ Listas5",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "executeOnce": true,
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "pantalla_actual": "MENU_LISTAS"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2896,
        10872
      ],
      "id": "594ff1eb-9a3e-4c6b-a137-c62ac22e3e9d",
      "name": "Update State MENU_LISTAS5",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "655ef5ab-d91a-4659-9bbc-50b18c8526e1",
              "leftValue": "={{ $json }}",
              "rightValue": "",
              "operator": {
                "type": "object",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        2224,
        10632
      ],
      "id": "bde37da3-3e52-4eaa-8d62-04ab34d7d6e6",
      "name": "IF THERES LISTAS?"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        2448,
        11256
      ],
      "id": "dce64f76-e6c9-4618-bc74-068782940665",
      "name": "Loop Over Items5"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "655ef5ab-d91a-4659-9bbc-50b18c8526e1",
              "leftValue": "={{ $json }}",
              "rightValue": "",
              "operator": {
                "type": "object",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        2224,
        11160
      ],
      "id": "4053edea-4302-4e92-86db-ae5b05f25c4b",
      "name": "IF THERES LISTAS?1"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "=-------------------------------------------------------------\nID: {{ $json.id_lista }}\nNombre Lista: {{ $json.nombre_lista }}\n\n-------------------------------------------------------------",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2672,
        11256
      ],
      "id": "7a7277e4-b6ec-48ca-a032-d9728535bd7f",
      "name": "Mostrar Lista Mensaje5",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "21be4a91-3f6d-429e-8d68-767909c66757",
              "leftValue": "={{ $json }}",
              "rightValue": "",
              "operator": {
                "type": "object",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        2224,
        3184
      ],
      "id": "a6144f6f-4dd9-42a3-af02-0523a7a68f5e",
      "name": "HAY TAREAS"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "21be4a91-3f6d-429e-8d68-767909c66757",
              "leftValue": "={{ $json }}",
              "rightValue": "",
              "operator": {
                "type": "object",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        2224,
        3664
      ],
      "id": "085e5904-b0a5-4813-aa08-33dd950dcde5",
      "name": "HAY TAREAS1"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Ups üòÖ parece que no tienes ninguna tarea sin completar.\n\nVolviendo al men√∫ de Tareas.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        3472
      ],
      "id": "a5cfb776-a13f-4715-bab5-cb0679c4647f",
      "name": "NO TIENE TAREAS SIN COMPLETAR",
      "webhookId": "032cae0e-0c44-46ea-ab8d-e61649d9bca9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Ups üòÖ parece que no tienes ninguna tarea.\n\nVolviendo al men√∫ de Tareas.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        3280
      ],
      "id": "b92cd7b9-5f13-4772-bc18-f2a073a6e225",
      "name": "NO TIENE TAREAS SIN COMPLETAR1",
      "webhookId": "032cae0e-0c44-46ea-ab8d-e61649d9bca9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Perfecto, vamos con tus tareas üìù\n\n¬øQu√© deseas hacer?\n\n1. Crear una nueva tarea\n\n2. Ver mis tareas\n\n3. Cambiar estado de una tarea\n\n4. Volver al men√∫ principal\n\nüí° Sugerencia:\nTe recomiendo 1 (Crear una nueva tarea).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2672,
        3376
      ],
      "id": "9847d045-f5cc-4868-8881-239f868b9077",
      "name": "Men√∫ Tareas8",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "executeOnce": true,
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "pantalla_actual": "MENU_TAREAS"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2896,
        3376
      ],
      "id": "b2973beb-2df8-47f1-bba3-b813de3fe76c",
      "name": "Update State MENU_TAREAS7",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "paso_actual": "1",
            "pantalla_actual": "ADD_ITEM_LISTA"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2896,
        11064
      ],
      "id": "17766960-c15f-49b7-8b2b-3f224df7d8e6",
      "name": "Update State COMPLETAR TAREA - PASO 2",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "=Dame el id de la lista para que le a√±adamos items üòÅ.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2672,
        11064
      ],
      "id": "a3039447-8a3a-46a9-8861-6abbc7799863",
      "name": "Pedir ID Lista para A√±adir Item",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "executeOnce": true,
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1968167309,
          "mode": "list",
          "cachedResultName": "LISTAS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1968167309"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "id_lista",
              "lookupValue": "={{ $('Telegram Trigger1').item.json.message.text }}"
            },
            {
              "lookupColumn": "creado_por",
              "lookupValue": "={{ $('Telegram Trigger1').item.json.message.from.id }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1776,
        12216
      ],
      "id": "213772b5-5854-4bf5-9ed5-283bc69bd9dd",
      "name": "Get Lista por ID",
      "alwaysOutputData": true,
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "ddd619b2-6740-45de-a958-a8bf36816a53",
              "leftValue": "={{ $json }}",
              "rightValue": "",
              "operator": {
                "type": "object",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        2000,
        12216
      ],
      "id": "f77e6412-606b-4296-9995-0152012037d1",
      "name": "Existe la lista y es del user?"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Genial üòä vamos a crear tu √≠tem.\n\nCada mensaje ser√° un √≠tem y cuando est√©s list@ escribe:\n\n0. Guardar √çtems\n\n9. Cancelar",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2224,
        12120
      ],
      "id": "67937065-25c3-4a0c-9be0-c38f7c7e229f",
      "name": "AGREGAR ITEM A LISTA PASO 1",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "pantalla_actual": "AGREGAR_ITEM_A_LISTA",
            "paso_actual": "1"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2448,
        12120
      ],
      "id": "56599a8f-3059-4740-82b5-e685984b056e",
      "name": "Update State AGREGAR ITEM A LISTA - PASO ",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "=Oh oh, no hemos encontrado ninguna lista con esa ID ü•∫\n\nVolviendo al men√∫ listas.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2224,
        12312
      ],
      "id": "03bf915e-67e6-4cd5-b109-49547fb3285c",
      "name": "VOLVIENDO MENU LISTA",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Perfecto üòä vamos con tus listas üóÇÔ∏è\n\n¬øQu√© deseas hacer?\n\n1. Crear una nueva lista\n\n2. Ver mis listas\n\n3. Agregar √≠tems a una lista\n\n4. Volver al men√∫ principal\n\nüí° Sugerencia:\nTe recomiendo 1 (Crear una nueva lista).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        12312
      ],
      "id": "18d44477-e9de-478e-b787-117b03f42768",
      "name": "Men√∫ Listas4",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "pantalla_actual": "MENU_LISTAS"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2672,
        12312
      ],
      "id": "a73aa374-7678-4fd1-876c-cce706908d6d",
      "name": "Update State MENU_LISTAS4",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 3
          },
          "conditions": [
            {
              "id": "befa34cd-bb19-4c26-94a2-8c4711de9bb9",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "9",
              "operator": {
                "type": "string",
                "operation": "notEquals"
              }
            }
          ],
          "combinator": "and"
        },
        "looseTypeValidation": true,
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        1776,
        12696
      ],
      "id": "078210ad-0b67-46fa-932e-09e8b2c082ce",
      "name": "IF no cancelar crear lista?1"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 3
          },
          "conditions": [
            {
              "id": "befa34cd-bb19-4c26-94a2-8c4711de9bb9",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "0",
              "operator": {
                "type": "string",
                "operation": "notEquals"
              }
            }
          ],
          "combinator": "and"
        },
        "looseTypeValidation": true,
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        2000,
        12600
      ],
      "id": "935208a2-0be0-4084-8efb-aea0f1e1a731",
      "name": "IF seguir a√±adiendo √≠tems"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "datos_parciales": "={{\n{\n\"lista_id\":$('Existe la lista y es del user?').item.json.id_lista,\n\"items\":[]\n}\n}}"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2672,
        12120
      ],
      "id": "979b2584-82f5-464b-917f-20079b7b711f",
      "name": "Update DATOS PARCIALES LISTA ID",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Est√° bien üòä\n\nHe cancelado la creaci√≥n de la lista.\n\nVolviendo al men√∫ listas.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2000,
        11928
      ],
      "id": "e5dc3336-dfee-4411-b9ed-d6c6931b7c63",
      "name": "Cancelado Creaci√≥n Lista",
      "webhookId": "032cae0e-0c44-46ea-ab8d-e61649d9bca9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Perfecto üòä vamos con tus listas üóÇÔ∏è\n\n¬øQu√© deseas hacer?\n\n1. Crear una nueva lista\n\n2. Ver mis listas\n\n3. Agregar √≠tems a una lista\n\n4. Volver al men√∫ principal\n\nüí° Sugerencia:\nTe recomiendo 1 (Crear una nueva lista).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2224,
        12888
      ],
      "id": "d9f91c04-8209-4610-9ead-95c1da497a5f",
      "name": "Men√∫ Listas6",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "pantalla_actual": "MENU_LISTAS"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2448,
        12888
      ],
      "id": "2dd6bdeb-a80e-4b51-a116-cf3d0b60a13a",
      "name": "Update State MENU_LISTAS6",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Est√° bien üòä\n\nHe cancelado la adici√≥n de items.\n\nVolviendo al men√∫ listas.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2000,
        12888
      ],
      "id": "0839aae6-fd12-40a4-82ac-98f5eba354c4",
      "name": "Cancelado Adici√≥n de √çtems",
      "webhookId": "032cae0e-0c44-46ea-ab8d-e61649d9bca9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "datos_parciales": "={{ $json.datos_parciales }}"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2448,
        12504
      ],
      "id": "412c8a86-666a-4bff-beab-9a599d0f3ecd",
      "name": "Update DATOS PARCIALES LISTA ID1",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "mode": "runOnceForEachItem",
        "jsCode": "// 1. Obtener datos_parciales (puede venir como objeto o string)\nlet datos = $json.datos_parciales;\n\nif (typeof datos === 'string') {\n  datos = JSON.parse(datos);\n}\n\n// 2. Agregar el nuevo item desde Telegram\ndatos.items.push({\n  nombre_item: $node[\"Telegram Trigger1\"].json.message.text\n});\n\n// 3. Devolver el item manteniendo TODO lo dem√°s\nreturn {\n  json: {\n    ...$json,\n    datos_parciales: datos\n  }};\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2224,
        12504
      ],
      "id": "883afc99-806d-4745-87ea-76a80647ec51",
      "name": "Code in JavaScript",
      "executeOnce": false
    },
    {
      "parameters": {
        "mode": "raw",
        "jsonOutput": "={\n  \"objetos\": {{$json.datos_parciales.parseJson().items}}\n}\n",
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2224,
        12696
      ],
      "id": "afdf328d-0b7e-44f7-9e38-8e3c6cd5b70c",
      "name": "Parse Datos Parciales"
    },
    {
      "parameters": {
        "jsCode": "const salida = [];\n\nconst datos = $input.first().json.objetos;\n\nfor (const entrada of datos) {\n  salida.push({\n    json: {\n      nombre_item: entrada.nombre_item\n    }\n  });\n}\n\nreturn salida;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2448,
        12696
      ],
      "id": "2aa5658f-effa-45c9-a9d4-df97e6ab62ce",
      "name": "Code in JavaScript1",
      "executeOnce": false
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        2672,
        12696
      ],
      "id": "17b5c318-a6de-4d82-8c14-60ba0a618df8",
      "name": "Loop Over Items6"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 495463117,
          "mode": "list",
          "cachedResultName": "ITEMS_LISTA",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=495463117"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "id_item": "={{ $json.id_item }}",
            "id_lista": "={{ $('IF seguir a√±adiendo √≠tems').item.json.datos_parciales.parseJson().lista_id}}",
            "item": "={{ $json.nombre_item }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "id_item",
              "displayName": "id_item",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "id_lista",
              "displayName": "id_lista",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "item",
              "displayName": "item",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        3120,
        12696
      ],
      "id": "5161dbde-9f4f-42b2-8b9c-56fad99de34c",
      "name": "Append ITEM_LISTA",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "action": "generate",
        "dataPropertyName": "id_item"
      },
      "type": "n8n-nodes-base.crypto",
      "typeVersion": 1,
      "position": [
        2896,
        12608
      ],
      "id": "b806d1f6-d315-49ac-9117-e966b1bd8156",
      "name": "Crypto3"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "=-------------------------------------------------------------\n\nNombre: {{ $json.nombre }}\nFrecuencia: {{ $json.frecuencia }}\nHora de recordatorio: {{ $json.hora_recordatorio }}\nEstado: {{ $json.estado }} {{ $json.estado == 'ACTIVO' ? '‚úÖ' : '‚õî' }}\n\n-------------------------------------------------------------",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2672,
        7112
      ],
      "id": "ce1f3e37-79a3-4e7a-86ed-7695fb9130c0",
      "name": "Mostrar Habitos Mensaje2",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "=\nitem: {{ $json.item }}\n",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        3344,
        10512
      ],
      "id": "3f6d8c3d-f79b-4f40-a1c2-ff312b1d9da8",
      "name": "Mostrar Listas √çtem Mensaje1",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 495463117,
          "mode": "list",
          "cachedResultName": "ITEMS_LISTA",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=495463117"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "id_lista",
              "lookupValue": "={{ $('Loop Over Items4').item.json.id_lista }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2896,
        10440
      ],
      "id": "4013438f-e05f-4cf3-a645-4c90ec0fafbd",
      "name": "Get row(s) in sheet1",
      "alwaysOutputData": true,
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "=-------------------------------------------------------------\n\nNombre Lista: {{ $json.nombre_lista }}\n",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2672,
        10440
      ],
      "id": "045286ba-4aa9-48b4-a82b-ed70b7188f62",
      "name": "Mostrar Listas Mensaje",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Perfecto üòÅ\n\nlos √≠tems han sido a√±adidos a la lista\n\nVolviendo al men√∫ listas.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2896,
        12216
      ],
      "id": "eae8085d-0a70-4f66-b2c4-9288d22d9651",
      "name": "Confirmaci√≥n √çtems Puestos",
      "webhookId": "032cae0e-0c44-46ea-ab8d-e61649d9bca9",
      "executeOnce": true,
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
        "text": "Perfecto üòä vamos con tus listas üóÇÔ∏è\n\n¬øQu√© deseas hacer?\n\n1. Crear una nueva lista\n\n2. Ver mis listas\n\n3. Agregar √≠tems a una lista\n\n4. Volver al men√∫ principal\n\nüí° Sugerencia:\nTe recomiendo 1 (Crear una nueva lista).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        3120,
        12216
      ],
      "id": "4d832459-e29f-4ab5-92a9-13fafbccbc1d",
      "name": "Men√∫ Listas7",
      "webhookId": "e53a7f73-09d7-4b20-aa71-6cea408b1691",
      "executeOnce": false,
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "pantalla_actual": "MENU_LISTAS"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        3344,
        12216
      ],
      "id": "fea42097-7367-4dca-ad6a-8a7997768ce3",
      "name": "Update State MENU_LISTAS7",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "¬øEn qu√© te puedo ayudar hoy? üòä\n\nMen√∫ principal:\n0. Ayuda\n\n1. Agenda (citas)\n\n2. Tareas\n\n3. Recordatorios\n\n4. H√°bitos\n\n5. Listas\n\n6. Reportes\n\n7. Configuraci√≥n\n\n8. Administrador\n\nüí° Sugerencia:\nSi quieres empezar r√°pido, te recomiendo la opci√≥n 1 (Agenda).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2000,
        11352
      ],
      "id": "40ebf7e9-69be-415a-9e0b-576c2de9e0c7",
      "name": "Menu Principal_3",
      "webhookId": "e85291c3-1b7e-48ad-8b3b-5569eb31d4c9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.from.id }}",
            "pantalla_actual": "MENU_PRINCIPAL"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        11352
      ],
      "id": "3ee1bedd-1ac0-4c52-8000-671e9c8e5e28",
      "name": "Update State MENU_PRINCIPAL4",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "a6dd3cbf-543b-4374-94dc-3b6a0cbcdce2",
              "leftValue": "={{ $json }}",
              "rightValue": "",
              "operator": {
                "type": "object",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        3120,
        10440
      ],
      "id": "7a6b20c7-fab0-4483-957c-b627e65af14f",
      "name": "not empty?"
    },
    {
      "parameters": {
        "mode": "raw",
        "jsonOutput": "={\n  \"timestamp\": {{$now}},\n  \"telegram_user\": {{ $json.telegram_user }},\n  \"pantalla\": {{ $json.pantalla_actual }},\n  \"opcion_elegida\": {{ $('Telegram Trigger1').item.json.message.text }},\n  \"resultado\": {{ \"opcion \" +  $('Telegram Trigger1').item.json.message.text + \" del menu \" +$('verificar_sesi√≥n').item.json.pantalla_actual + \" ejecutada correctamente\"}}\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2000,
        7112
      ],
      "id": "6b4f0f7e-7566-4854-bf18-61bbb2c43343",
      "name": "Edit To Log"
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "value": "QMKXdvzOL7ZZR0EF",
          "mode": "list",
          "cachedResultName": "My Sub-Workflow 2",
          "cachedResultUrl": "/workflow/QMKXdvzOL7ZZR0EF"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {},
          "matchingColumns": [],
          "schema": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": true
        },
        "mode": "each",
        "options": {}
      },
      "type": "n8n-nodes-base.executeWorkflow",
      "typeVersion": 1.3,
      "position": [
        2224,
        7112
      ],
      "id": "0bc81485-2bd7-4e3a-bc71-f9e37ba032ca",
      "name": "Call 'My Sub-Workflow 2'"
    },
    {
      "parameters": {
        "mode": "raw",
        "jsonOutput": "={\n  \"timestamp\": {{$now}},\n  \"telegram_user\": {{ $json.telegram_user }},\n  \"pantalla\": {{ $json.pantalla_actual }},\n  \"opcion_elegida\": {{ $('Telegram Trigger1').item.json.message.text }},\n  \"resultado\": {{ \"opcion \" +  $('Telegram Trigger1').item.json.message.text + \" del menu \" +$('verificar_sesi√≥n').item.json.pantalla_actual + \" ejecutada correctamente\"}}\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2000,
        10440
      ],
      "id": "1ea3d6e9-6dd1-494b-8745-9cad05bdf15c",
      "name": "Edit To Log1"
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "value": "QMKXdvzOL7ZZR0EF",
          "mode": "list",
          "cachedResultName": "My Sub-Workflow 2",
          "cachedResultUrl": "/workflow/QMKXdvzOL7ZZR0EF"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {},
          "matchingColumns": [],
          "schema": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": true
        },
        "mode": "each",
        "options": {}
      },
      "type": "n8n-nodes-base.executeWorkflow",
      "typeVersion": 1.3,
      "position": [
        2224,
        10440
      ],
      "id": "5e891e85-a75e-4ee5-b9d5-c0affbddf2e7",
      "name": "Call 'My Sub-Workflow 2'1"
    },
    {
      "parameters": {
        "mode": "raw",
        "jsonOutput": "={\n  \"timestamp\": {{$now}},\n  \"telegram_user\": {{ $json.telegram_user }},\n  \"pantalla\": {{ $json.pantalla_actual }},\n  \"opcion_elegida\": {{ $('Telegram Trigger1').item.json.message.text }},\n  \"resultado\": {{ \"opcion \" +  $('Telegram Trigger1').item.json.message.text + \" del menu \" +$('verificar_sesi√≥n').item.json.pantalla_actual + \" ejecutada correctamente\"}}\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2000,
        2992
      ],
      "id": "490a1e57-599a-45e0-8a5a-4fe8060f823f",
      "name": "Edit To Log2"
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "value": "QMKXdvzOL7ZZR0EF",
          "mode": "list",
          "cachedResultName": "My Sub-Workflow 2",
          "cachedResultUrl": "/workflow/QMKXdvzOL7ZZR0EF"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {},
          "matchingColumns": [],
          "schema": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": true
        },
        "mode": "each",
        "options": {}
      },
      "type": "n8n-nodes-base.executeWorkflow",
      "typeVersion": 1.3,
      "position": [
        2224,
        2992
      ],
      "id": "f7c75a10-f801-4db6-afab-fb2cac598750",
      "name": "Call 'My Sub-Workflow 2'2"
    },
    {
      "parameters": {
        "mode": "raw",
        "jsonOutput": "={\n  \"timestamp\": {{$now}},\n  \"telegram_user\": {{ $json.telegram_user }},\n  \"pantalla\": {{ $json.pantalla_actual }},\n  \"opcion_elegida\": {{ $('Telegram Trigger1').item.json.message.text }},\n  \"resultado\": {{ \"opcion \" +  $('Telegram Trigger1').item.json.message.text + \" del menu \" +$('verificar_sesi√≥n').item.json.pantalla_actual + \" ejecutada correctamente\"}}\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2000,
        2224
      ],
      "id": "f7b90386-2414-4605-964e-ffc75ea8fefe",
      "name": "Edit To Log3"
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "value": "QMKXdvzOL7ZZR0EF",
          "mode": "list",
          "cachedResultName": "My Sub-Workflow 2",
          "cachedResultUrl": "/workflow/QMKXdvzOL7ZZR0EF"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {},
          "matchingColumns": [],
          "schema": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": true
        },
        "mode": "each",
        "options": {}
      },
      "type": "n8n-nodes-base.executeWorkflow",
      "typeVersion": 1.3,
      "position": [
        2224,
        2224
      ],
      "id": "695c746f-a4b1-41a9-9776-09d23636d52c",
      "name": "Call 'My Sub-Workflow 2'3"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "¬øEn qu√© te puedo ayudar hoy? üòä\n\nMen√∫ principal:\n0. Ayuda\n\n1. Agenda (citas)\n\n2. Tareas\n\n3. Recordatorios\n\n4. H√°bitos\n\n5. Listas\n\n6. Reportes\n\n7. Configuraci√≥n\n\n8. Administrador\n\nüí° Sugerencia:\nSi quieres empezar r√°pido, te recomiendo la opci√≥n 1 (Agenda).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2672,
        15200
      ],
      "id": "8026978b-ae3a-4fbb-9f33-78f53a86e9a1",
      "name": "Menu Principal",
      "webhookId": "e85291c3-1b7e-48ad-8b3b-5569eb31d4c9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $node[\"Telegram Trigger1\"].json[\"message\"][\"chat\"][\"id\"] }}",
        "text": "=Ups üò¨ ya tienes una cita agendada\nen esa misma fecha y hora.\n\nPor favor escribe otra hora.\n\n9. Cancelar",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        3344,
        12888
      ],
      "id": "714f0b8a-6d94-4fc9-aeed-cd44f3fbb87b",
      "name": "Error Doble Reserva",
      "webhookId": "a60929b2-6f11-4032-926d-05a0c072384d",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "=Revisa la informaci√≥n de tu cita üëÄ\n\nüë§ *Nombre:*  {{ JSON.parse($node[\"verificar_sesi√≥n\"].json[\"datos_parciales\"]).nombre }}\nüìÖ *Fecha:* {{ JSON.parse($node[\"verificar_sesi√≥n\"].json[\"datos_parciales\"]).fecha }}\n‚è∞ *Hora:* {{ JSON.parse($node[\"verificar_sesi√≥n\"].json[\"datos_parciales\"]).hora }}\nüìù *Motivo:* {{ JSON.parse($node[\"verificar_sesi√≥n\"].json[\"datos_parciales\"]).motivo }}\nüì° *Canal:*  {{ $json.canal }}\n\n¬øQu√© deseas hacer?\n  1. Confirmar y guardar\n  2. Editar informaci√≥n\n  3. Cancelar\n\nüí° Sugerencia: Te recomiendo 1 (Confirmar y guardar).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        3120,
        14528
      ],
      "id": "c40957f5-db9e-42b0-b8ca-1781ce24217d",
      "name": "Agendar Cita Paso 6 Confirmar",
      "webhookId": "53686d34-b4e3-4ec5-8047-9eba5a560364",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "=Perfecto üòä\n\nPaso 5 de 6 ‚Äî Canal\n\n¬øC√≥mo ser√° la atenci√≥n?\n\n1. Presencial\n\n2. Virtual\n\n3. Llamada\n\n4. Cancelar\n\nüí° Sugerencia:\nNormalmente se usa 2 (Virtual).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2672,
        14232
      ],
      "id": "fc6b4d2e-ed2c-401f-a60c-483ef6da0f79",
      "name": "Agendar Cita Paso 5",
      "webhookId": "68cb4abc-ec1d-4a8a-953b-da48a167af0b",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "Muy bien üëç\n\nPaso 4 de 6 ‚Äî Motivo\n\nCu√©ntame brevemente el motivo de la cita.\n\nEjemplo: Asesor√≠a t√©cnica\n\n9. Cancelar",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2672,
        14040
      ],
      "id": "58d2d0f6-124b-4468-89c9-aac932bd34ed",
      "name": "Agendar Cita Paso 4",
      "webhookId": "68cb4abc-ec1d-4a8a-953b-da48a167af0b",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $node[\"Telegram Trigger1\"].json[\"message\"][\"chat\"][\"id\"] }}",
        "text": "Genial üòä\n\nPaso 3 de 6 ‚Äî Nombre\n\n¬øA nombre de qui√©n es la cita?\n\nEscribe el nombre completo.\n\nEjemplo: Pedro G√≥mez\n\n9. Cancelar",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        3568,
        13752
      ],
      "id": "98206426-d574-4926-8a9e-25a214a04381",
      "name": "Agendar Cita Paso 3",
      "webhookId": "68cb4abc-ec1d-4a8a-953b-da48a167af0b",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "=Ups üòÖ la hora no tiene un formato v√°lido.\n\nRecuerda usar formato 24 horas:\nHH:MM\n\nEjemplo: 14:30\n\n9. Cancelar",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2672,
        13848
      ],
      "id": "58feecd7-badc-40a2-8706-26c8a8860015",
      "name": "Hora Invalida",
      "webhookId": "89a3d27f-d5de-425c-8c71-1bdf700a711e",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "Perfecto üëç\n\nPaso 2 de 6 ‚Äî Hora\n\n¬øA qu√© hora ser√° la cita?\n\nFormato 24 horas: HH:MM\nEjemplo: 14:30\n\n9. Cancelar",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        3120,
        13080
      ],
      "id": "1f73270a-f872-4f8b-aed5-f5ce047a29da",
      "name": "Agendar Cita Paso 2",
      "webhookId": "51955384-d352-46f0-a7db-4ba879bc682f",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "Perfecto, vamos con tu agenda üìÖ\n\n¬øQu√© deseas hacer?\n\n1. Agendar una nueva cita\n\n2. Consultar tu agenda\n\n3. Reprogramar una cita\n\n4. Cancelar una cita\n\n5. Marcar una cita como completada\n\n6. Volver al men√∫ principal\n\nüí° Sugerencia:\nTe recomiendo la opci√≥n 1 (Agendar una nueva cita).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2672,
        15008
      ],
      "id": "8352926a-87d8-49f7-869a-af6e613e085a",
      "name": "Men√∫ Agenda",
      "webhookId": "95c2e7db-d561-4644-9f1a-dfd17f305b61",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "paso_actual": "2",
            "datos_parciales": "={{\n(() => {\n  let data = {};\n  try {\n    data = $json[\"datos_parciales\"] ? JSON.parse($json[\"datos_parciales\"]) : {};\n  } catch (e) {\n    data = {};\n  }\n\n  const mensaje = $('Telegram Trigger1').item.json.message.text;\n\n  data.fecha = mensaje;\n\n  return JSON.stringify(data);\n})()\n}}",
            "pantalla_actual": "=AGENDAR"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2896,
        13080
      ],
      "id": "03f11995-7d47-4d00-a09c-7305d14f63cb",
      "name": "Agendar_paso_1",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "pantalla_actual": "MENU_PRINCIPAL",
            "paso_actual": "0"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        13080
      ],
      "id": "ebd978d5-1953-4e34-aabf-46d575491b46",
      "name": "Cancelar_agendamiento",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "datos_parciales": "={{\n(() => {\n  let data = {};\n  \n  // 1. RESCATAR: Leemos la sesi√≥n desde el nodo seguro (verificar_sesi√≥n)\n  // As√≠ no importa si venimos de un IF, un Code o un Filter.\n  try {\n    // Aseg√∫rate de que 'verificar_sesi√≥n' sea el nombre de tu nodo verde\n    const rawData = $node[\"verificar_sesi√≥n\"].json[\"datos_parciales\"];\n    data = rawData ? JSON.parse(rawData) : {};\n  } catch (e) {\n    data = {};\n  }\n\n  // 2. AGREGAR: Leemos la hora usando la referencia absoluta al Trigger\n  // Usamos $node[\"Nombre\"] en vez de $('Nombre').item para evitar errores\n  const horaTelegram = $node[\"Telegram Trigger1\"].json[\"message\"][\"text\"];\n\n  data.hora = horaTelegram;\n\n  // 3. RETORNAR\n  return JSON.stringify(data);\n})()\n}}",
            "telegram_user": "={{ $node[\"Telegram Trigger1\"].json[\"message\"][\"chat\"][\"id\"] }}",
            "paso_actual": "3"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        3344,
        13752
      ],
      "id": "5836e922-b762-4dac-bc5a-6db7235fe640",
      "name": "Agendar_paso_2",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "datos_parciales": "={{\n(() => {\n  let data = {};\n  try {\n    data = $json[\"datos_parciales\"] ? JSON.parse($json[\"datos_parciales\"]) : {};\n  } catch (e) {\n    data = {};\n  }\n\n  const mensaje = $('Telegram Trigger1').item.json.message.text;\n\n  data.nombre = mensaje;\n\n  return JSON.stringify(data);\n})()\n}}",
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "paso_actual": "4"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2448,
        14040
      ],
      "id": "581560de-c055-4719-abe4-9d16c557ed0b",
      "name": "Agendar_paso_3",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "datos_parciales": "={{\n(() => {\n  let data = {};\n  try {\n    data = $json[\"datos_parciales\"] ? JSON.parse($json[\"datos_parciales\"]) : {};\n  } catch (e) {\n    data = {};\n  }\n\n  const mensaje = $('Telegram Trigger1').item.json.message.text;\n\n  data.motivo = mensaje;\n\n  return JSON.stringify(data);\n})()\n}}",
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "paso_actual": "5"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2448,
        14232
      ],
      "id": "02bac09e-1048-4748-95fe-c293882fbafc",
      "name": "Agendar_paso_4",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json[\"paso_actual\"].toString() }}",
                    "rightValue": "1",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "27c28973-9ef6-49bf-8f43-efd8ee1d30b2"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "bc90d83a-3bca-4d2e-8b84-dd245e0fcf5e",
                    "leftValue": "={{ $json[\"paso_actual\"].toString() }}",
                    "rightValue": "2",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "06e2a91d-cba1-4a92-8f1a-f8c3d73b9b17",
                    "leftValue": "={{ $json[\"paso_actual\"].toString() }}",
                    "rightValue": "3",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "ad24f2c7-509e-449d-8cc3-c3ae986befca",
                    "leftValue": "={{ $json[\"paso_actual\"].toString() }}",
                    "rightValue": "4",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "36ef200f-aac4-4028-9ac9-bcb26be001a6",
                    "leftValue": "={{ $json[\"paso_actual\"].toString() }}",
                    "rightValue": "5",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        2224,
        14136
      ],
      "id": "40d844ca-4697-4f4b-b6a1-496889bce57c",
      "name": "Monitor_edici√≥n"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "datos_parciales": "={{\n(() => {\n  let data = {};\n  // Intentamos leer lo que hay. Si est√° vac√≠o o da error, iniciamos vacio.\n  try {\n    data = JSON.parse($json[\"datos_parciales\"]);\n  } catch (e) {\n    data = {};\n  }\n  \n  // AQU√ç AGREGAMOS EL DATO NUEVO (Cambia 'fecha' seg√∫n el nodo)\n  data.canal = \"presencial\"\n  \n  return JSON.stringify(data);\n})()\n}}",
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "paso_actual": "",
            "pantalla_actual": "VERIFICACION"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2672,
        14424
      ],
      "id": "7d975adf-3cbb-40ac-8cac-f8b6490bd3ef",
      "name": "Agendar_paso_5 (presencial)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "datos_parciales": "={{\n(() => {\n  let data = {};\n  // Intentamos leer lo que hay. Si est√° vac√≠o o da error, iniciamos vacio.\n  try {\n    data = JSON.parse($json[\"datos_parciales\"]);\n  } catch (e) {\n    data = {};\n  }\n  \n  // AQU√ç AGREGAMOS EL DATO NUEVO (Cambia 'fecha' seg√∫n el nodo)\n  data.canal = \"virtual\";\n  \n  return JSON.stringify(data);\n})()\n}}",
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "paso_actual": "",
            "pantalla_actual": "VERIFICACION"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2672,
        14616
      ],
      "id": "397ec3c4-a5e4-4acf-9ae5-d31fa26b1258",
      "name": "Agendar_paso_5 (virtual)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "datos_parciales": "={{\n(() => {\n  let data = {};\n  // Intentamos leer lo que hay. Si est√° vac√≠o o da error, iniciamos vacio.\n  try {\n    data = JSON.parse($json[\"datos_parciales\"]);\n  } catch (e) {\n    data = {};\n  }\n  \n  // AQU√ç AGREGAMOS EL DATO NUEVO (Cambia 'fecha' seg√∫n el nodo)\n  data.canal = \"llamada\";\n  \n  return JSON.stringify(data);\n})()\n}}",
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "paso_actual": "",
            "pantalla_actual": "VERIFICACION"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2672,
        14808
      ],
      "id": "c0e9dcc2-855c-42f0-b1b1-35b461792f7f",
      "name": "Agendar_paso_5 (llamada)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "9cc5a521-6683-43af-a5e1-802bd6b92274",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "9",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        2000,
        13776
      ],
      "id": "bf27c0f9-f42d-4ba6-bd50-433f47c4ed81",
      "name": "IF_cancelar_agendamiento"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "876f334e-7aea-408a-a110-a88c69f6e76e",
              "name": "canal",
              "value": "={{ JSON.parse($node[\"Agendar_paso_5 (presencial)\"].json[\"datos_parciales\"]).canal }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2896,
        14424
      ],
      "id": "aa1cedeb-ee98-40cc-a827-cfc6e218a355",
      "name": "field_presencial"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "876f334e-7aea-408a-a110-a88c69f6e76e",
              "name": "canal",
              "value": "={{ JSON.parse($node[\"Agendar_paso_5 (virtual)\"].json[\"datos_parciales\"]).canal }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2896,
        14616
      ],
      "id": "77c7fd35-aeed-4ea4-aa4d-58ebda179d07",
      "name": "field_virtual"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "876f334e-7aea-408a-a110-a88c69f6e76e",
              "name": "canal",
              "value": "={{ JSON.parse($node[\"Agendar_paso_5 (llamada)\"].json[\"datos_parciales\"]).canal }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2896,
        14808
      ],
      "id": "e7eed618-ac86-4241-b80d-f6bf120c9b91",
      "name": "field_llamada"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "CITAS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "id_cita": "={{ 'CITA-' + $now.format('yyyyMMddHHmmss') }}",
            "fecha": "={{ JSON.parse($node[\"verificar_sesi√≥n\"].json[\"datos_parciales\"]).fecha }}",
            "hora": "={{ JSON.parse($node[\"verificar_sesi√≥n\"].json[\"datos_parciales\"]).hora }}",
            "nombre": "={{ JSON.parse($node[\"verificar_sesi√≥n\"].json[\"datos_parciales\"]).nombre }}",
            "motivo": "={{ JSON.parse($node[\"verificar_sesi√≥n\"].json[\"datos_parciales\"]).motivo }}",
            "creado_por": "={{ $('Telegram Trigger1').item.json.message.from.first_name }}",
            "timestamp_creacion": "={{$now}}",
            "estado": "Pendiente",
            "canal": "={{ JSON.parse($node[\"verificar_sesi√≥n\"].json[\"datos_parciales\"]).canal }}",
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "id_cita",
              "displayName": "id_cita",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "fecha",
              "displayName": "fecha",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "hora",
              "displayName": "hora",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "nombre",
              "displayName": "nombre",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "motivo",
              "displayName": "motivo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "canal",
              "displayName": "canal",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "estado",
              "displayName": "estado",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "creado_por",
              "displayName": "creado_por",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp_creacion",
              "displayName": "timestamp_creacion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "recordatorio_enviado",
              "displayName": "recordatorio_enviado",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        25184
      ],
      "id": "6078d6ab-a1b5-4a10-9da8-996ecb863d57",
      "name": "Append_cita",
      "alwaysOutputData": true,
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "eb38a67e-f4fe-4761-b573-11dc55c8e227",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "={{ \"1\" }}",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        2224,
        15104
      ],
      "id": "616d04b6-181c-4966-af58-b2c01b1fd566",
      "name": "IF_agendar_cita"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "pantalla_actual": "MENU_CITAS",
            "paso_actual": "0"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2448,
        15008
      ],
      "id": "26dcc1bc-2079-42fd-b062-ab04a802cb0a",
      "name": "Actualizar_estado (MENU_CITAS)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "={{ \"1\" }}",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "4cbc81a2-8cf4-405f-9e1c-0061a99bcafe"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "8af760ed-a14c-48e3-815f-7750da444a02",
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "={{ \"2\" }}",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "8aee58a1-a925-4798-ab0a-3bbd70e9b5cb",
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "={{ \"3\" }}",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "d5478f88-f019-4760-899e-5aca37f0901d",
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "={{ \"4\" }}",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "562ad6ff-08b0-4905-b876-4875ba64a11c",
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "={{ \"5\" }}",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "4f6bc30e-1d43-4e8b-97c6-11d3b1364835",
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "={{ \"6\" }}",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {
          "fallbackOutput": "extra"
        }
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        2000,
        27024
      ],
      "id": "202f88c4-dbc1-433e-8546-c7e46559fe85",
      "name": "Switch_MENU_CITAS"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "pantalla_actual": "AGENDAR",
            "paso_actual": "1"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        25952
      ],
      "id": "3894dd83-7170-4c05-b913-fc172f0ecb36",
      "name": "Actualizar_estado (AGENDAR)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "pantalla_actual": "MENU_PRINCIPAL",
            "paso_actual": "0"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        27680
      ],
      "id": "40493871-e46d-4e82-8746-f2ac7d80d2df",
      "name": "Actualizar_estado (MENU_PRINCIPAL) /SWITCH MENU_CITAS",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "=Operaci√≥n cancelada. Est√°s en el men√∫ principal.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        13080
      ],
      "id": "f185c45f-4ae4-410a-8eea-81762958c5a2",
      "name": "Cancelar_agendamiento_message",
      "webhookId": "51955384-d352-46f0-a7db-4ba879bc682f",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "=Empecemos a crear tu cita üòä\n\nPaso 1 de 6 ‚Äî Fecha\n\n¬øCu√°l es la fecha de la cita?\n\nFormato: YYYY-MM-DD\nEjemplo: 2025-12-20\n\n9. Cancelar",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        25952
      ],
      "id": "21a1ff39-ba0d-41b2-afcc-41c600733036",
      "name": "Agendar Cita Paso inicial",
      "webhookId": "51955384-d352-46f0-a7db-4ba879bc682f",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "=¬°Listo! Tu cita qued√≥ agendada correctamente.\n\nID de la cita: {{ $('Append_cita').item.json.id_cita }}\n\n¬øQu√© deseas hacer ahora?\n1. Volver a Agenda\n2. Ir al men√∫ principal",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2672,
        25184
      ],
      "id": "3fea491b-91fc-4d93-8142-40b3d3d14924",
      "name": "Mensaje_registro_exitoso",
      "webhookId": "53686d34-b4e3-4ec5-8047-9eba5a560364",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "1",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "a7189d17-b037-404f-baf4-24eed23819e6"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "41448d46-c520-42a0-9394-a4ef6269320b",
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "2",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "746bee75-46a6-4597-a700-00477ecf3b07",
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "3",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        2448,
        14696
      ],
      "id": "4a3e14f3-ceea-48d5-b2b7-fbf8d3e33736",
      "name": "Switch_tipo_canal"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "={{\"1\"}}",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "93dabcdb-4b32-4dd8-8c73-731828d793d3"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "f315a1ec-da4f-4a2f-b6e1-75159a79e01a",
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "={{ \"2\" }}",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "f4d361a8-4163-4764-8739-d51cebd886b3",
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "={{\"3\"}}",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        2000,
        25360
      ],
      "id": "666656ec-848f-4c38-b3d8-9317148d20d2",
      "name": "Switch_edicion_creaci√≥n"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "={{ \"1\" }}",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "689583d8-cb58-4338-9cde-e5c1a6e78c8d"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "8bf08cda-2e27-42c1-baff-56c13179eb64",
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "={{ \"2\" }}",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        2000,
        25760
      ],
      "id": "0b2a9e70-29e5-4547-8d97-35d9d722969b",
      "name": "Switch_CONFIRMACION_CITA"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "pantalla_actual": "MENU_CITAS",
            "paso_actual": "0"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        25568
      ],
      "id": "3a2ef331-cfb3-4981-a00c-8a58e5b46dfe",
      "name": "Actualizar_estado (volver MENU_CITAS)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "pantalla_actual": "MENU_PRINCIPAL",
            "paso_actual": "0"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        25760
      ],
      "id": "1faf5be5-e903-4e9d-a83c-4ca2654be226",
      "name": "Actualizar_estado (volver MENU_PRINCIPAL)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "Perfecto, vamos con tu agenda üìÖ\n\n¬øQu√© deseas hacer?\n\n1. Agendar una nueva cita\n\n2. Consultar tu agenda\n\n3. Reprogramar una cita\n\n4. Cancelar una cita\n\n5. Marcar una cita como completada\n\n6. Volver al men√∫ principal\n\nüí° Sugerencia:\nTe recomiendo la opci√≥n 1 (Agendar una nueva cita).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        25568
      ],
      "id": "f97f323c-4741-4bdf-b289-ed08dd1e5b65",
      "name": "Mostrar_Menu_agenda",
      "webhookId": "95c2e7db-d561-4644-9f1a-dfd17f305b61",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "¬øEn qu√© te puedo ayudar hoy? üòä\n\nMen√∫ principal:\n0. Ayuda\n\n1. Agenda (citas)\n\n2. Tareas\n\n3. Recordatorios\n\n4. H√°bitos\n\n5. Listas\n\n6. Reportes\n\n7. Configuraci√≥n\n\n8. Administrador\n\nüí° Sugerencia:\nSi quieres empezar r√°pido, te recomiendo la opci√≥n 1 (Agenda).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        25760
      ],
      "id": "ee34a72c-a94c-4d6f-a3b5-093db673e6b1",
      "name": "Mostrar_menu_principal",
      "webhookId": "e85291c3-1b7e-48ad-8b3b-5569eb31d4c9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "pantalla_actual": "CONFIRMACION_CITA",
            "paso_actual": "0",
            "datos_parciales": ""
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2448,
        25184
      ],
      "id": "f876161f-db8f-4ac1-a598-601284469727",
      "name": "Actualizar_estado (CONFIRMACION_CITA)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "=‚úèÔ∏è *Modo Edici√≥n*\n\n¬øQu√© dato quieres corregir?\n\n1. Nombre\n2. Fecha\n3. Hora\n4. Motivo\n5. Canal\n6. üîô Volver sin cambios",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        25376
      ],
      "id": "c62fb786-d743-486a-b593-70b43888974d",
      "name": "Mensaje_edicion_cita",
      "webhookId": "53686d34-b4e3-4ec5-8047-9eba5a560364",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "={{ \"1\" }}",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "28f0bbc3-8195-4dbd-85cb-dd11c85789a3"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "e8f021de-f6d2-4c70-9231-5194c2f1da57",
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "={{ \"2\" }}",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "5215c1bb-1f54-4b04-95a1-21469533279f",
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "={{ \"3\" }}",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "c9e79605-7c9c-4b8b-a37d-2923bf6a3291",
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "={{ \"4\" }}",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "eb617738-ec83-4d86-87ec-96db7c23bb74",
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "={{ \"5\" }}",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "1cf6c36b-abbc-498b-ba67-5987245d9847",
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "={{ \"6\" }}",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {
          "fallbackOutput": "extra"
        }
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        2000,
        17472
      ],
      "id": "f29d9093-92e3-4fb9-8c9e-1f9dc7cbdb55",
      "name": "Switch_edici√≥n_cita"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "=üìÖ Por favor, escribe la nueva fecha (Ej: 2025-12-25):",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        17312
      ],
      "id": "fd71211b-80a7-4e4f-866c-2cb946f48648",
      "name": "Mensaje_nueva_fecha",
      "webhookId": "e85291c3-1b7e-48ad-8b3b-5569eb31d4c9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "pantalla_actual": "EDITAR_FECHA",
            "paso_actual": "0"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        17312
      ],
      "id": "959aff5b-9438-48b2-8735-0a68e844e07d",
      "name": "Actualizar_estado (EDITAR FECHA)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "pantalla_actual": "EDITAR_NOMBRE",
            "paso_actual": "0"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        16736
      ],
      "id": "235f07ef-ddeb-46ff-9b07-a6524b655996",
      "name": "Actualizar_estado (EDITAR_NOMBRE)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "=üìÖ Por favor, escribe un nuevo nombre:",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        16736
      ],
      "id": "20dcd2dc-7cc0-4324-9309-eb91cf05eea0",
      "name": "Mensaje_nuevo_nombre",
      "webhookId": "e85291c3-1b7e-48ad-8b3b-5569eb31d4c9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "pantalla_actual": "EDITAR_HORA",
            "paso_actual": "0"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        16928
      ],
      "id": "0780c7ed-f052-463d-8405-683878fd02cc",
      "name": "Actualizar_estado (EDITAR_HORA)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "= Por favor, escribe la nueva hora (Ej: 14:30):",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        16928
      ],
      "id": "eb77b479-e1ad-4dd2-a060-bf4ebff1a53d",
      "name": "Mensaje_nueva_hora",
      "webhookId": "e85291c3-1b7e-48ad-8b3b-5569eb31d4c9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "pantalla_actual": "VERIFICACION",
            "datos_parciales": "={{\n(() => {\n  const rawInfo = $node[\"verificar_sesi√≥n\"] ? $node[\"verificar_sesi√≥n\"].json[\"datos_parciales\"] : \"\";\n  \n  let data = {};\n  \n  if (rawInfo) {\n      try {\n          data = typeof rawInfo === 'string' ? JSON.parse(rawInfo) : rawInfo;\n      } catch (e) {\n          data = {};\n      }\n  }\n\n  const nuevoDato = $node[\"Telegram Trigger1\"].json[\"message\"][\"text\"];\n  \n  data.fecha = nuevoDato; \n\n  return JSON.stringify(data);\n})()\n}}"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2448,
        18080
      ],
      "id": "e1082439-ffc7-442b-baaa-8e745e5e407d",
      "name": "Actualizar_campo (fecha)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "pantalla_actual": "MENU_EDITAR",
            "paso_actual": "6"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        25376
      ],
      "id": "8dd04cba-43da-4c37-997e-8cabc2a39988",
      "name": "Actualizar_estado (MENU_EDITAR)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "=Revisa la informaci√≥n de tu cita üëÄ\n\nüë§ *Nombre:*  {{ JSON.parse($json[\"datos_parciales\"]).nombre }}\nüìÖ *Fecha:* {{ JSON.parse($json[\"datos_parciales\"]).fecha }}\n‚è∞ *Hora:* {{ JSON.parse($json[\"datos_parciales\"]).hora }}\nüìù *Motivo:* {{ JSON.parse($json[\"datos_parciales\"]).motivo }}\nüì° *Canal:*  {{ JSON.parse($json[\"datos_parciales\"]).canal }}\n\n¬øQu√© deseas hacer?\n  1. Confirmar y guardar\n  2. Editar informaci√≥n\n  3. Cancelar\n\nüí° Sugerencia: Te recomiendo 1 (Confirmar y guardar).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2672,
        18080
      ],
      "id": "b2852a63-33af-4a43-a0fb-9f7ba482b4e1",
      "name": "Agendar Cita Paso 6 Confirmar (EDITAR_FECHA)",
      "webhookId": "53686d34-b4e3-4ec5-8047-9eba5a560364",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "pantalla_actual": "VERIFICACION",
            "datos_parciales": "={{\n(() => {\n  const rawInfo = $node[\"verificar_sesi√≥n\"] ? $node[\"verificar_sesi√≥n\"].json[\"datos_parciales\"] : \"\";\n  \n  let data = {};\n  \n  if (rawInfo) {\n      try {\n          data = typeof rawInfo === 'string' ? JSON.parse(rawInfo) : rawInfo;\n      } catch (e) {\n          data = {};\n      }\n  }\n\n  const nuevoDato = $node[\"Telegram Trigger1\"].json[\"message\"][\"text\"];\n  \n  data.nombre = nuevoDato; \n\n  return JSON.stringify(data);\n})()\n}}"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2000,
        18560
      ],
      "id": "81109828-4f0a-415a-9482-c124d5bc4dcf",
      "name": "Actualizar_campo (nombre)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "=Revisa la informaci√≥n de tu cita üëÄ\n\nüë§ *Nombre:*  {{ JSON.parse($json[\"datos_parciales\"]).nombre }}\nüìÖ *Fecha:* {{ JSON.parse($json[\"datos_parciales\"]).fecha }}\n‚è∞ *Hora:* {{ JSON.parse($json[\"datos_parciales\"]).hora }}\nüìù *Motivo:* {{ JSON.parse($json[\"datos_parciales\"]).motivo }}\nüì° *Canal:*  {{ JSON.parse($json[\"datos_parciales\"]).canal }}\n\n¬øQu√© deseas hacer?\n  1. Confirmar y guardar\n  2. Editar informaci√≥n\n  3. Cancelar\n\nüí° Sugerencia: Te recomiendo 1 (Confirmar y guardar).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2224,
        18560
      ],
      "id": "dbab5517-c9fc-490d-9a8a-e32c68d7ddbc",
      "name": "Agendar Cita Paso 6 Confirmar (EDITAR_NOMBRE)",
      "webhookId": "53686d34-b4e3-4ec5-8047-9eba5a560364",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "=Revisa la informaci√≥n de tu cita üëÄ\n\nüë§ *Nombre:*  {{ JSON.parse($json[\"datos_parciales\"]).nombre }}\nüìÖ *Fecha:* {{ JSON.parse($json[\"datos_parciales\"]).fecha }}\n‚è∞ *Hora:* {{ JSON.parse($json[\"datos_parciales\"]).hora }}\nüìù *Motivo:* {{ JSON.parse($json[\"datos_parciales\"]).motivo }}\nüì° *Canal:*  {{ JSON.parse($json[\"datos_parciales\"]).canal }}\n\n¬øQu√© deseas hacer?\n  1. Confirmar y guardar\n  2. Editar informaci√≥n\n  3. Cancelar\n\nüí° Sugerencia: Te recomiendo 1 (Confirmar y guardar).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        18752
      ],
      "id": "99370785-6da2-4f73-9745-a9bf724c4b3a",
      "name": "Agendar Cita Paso 6 Confirmar (EDITAR_HORA)",
      "webhookId": "53686d34-b4e3-4ec5-8047-9eba5a560364",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "=Revisa la informaci√≥n de tu cita üëÄ\n\nüë§ *Nombre:*  {{ JSON.parse($json[\"datos_parciales\"]).nombre }}\nüìÖ *Fecha:* {{ JSON.parse($json[\"datos_parciales\"]).fecha }}\n‚è∞ *Hora:* {{ JSON.parse($json[\"datos_parciales\"]).hora }}\nüìù *Motivo:* {{ JSON.parse($json[\"datos_parciales\"]).motivo }}\nüì° *Canal:*  {{ JSON.parse($json[\"datos_parciales\"]).canal }}\n\n¬øQu√© deseas hacer?\n  1. Confirmar y guardar\n  2. Editar informaci√≥n\n  3. Cancelar\n\nüí° Sugerencia: Te recomiendo 1 (Confirmar y guardar).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2224,
        19136
      ],
      "id": "0ab6c371-7b0a-414d-b6ed-e78246ad17ef",
      "name": "Agendar Cita Paso 6 Confirmar (EDITAR_MOTIVO)",
      "webhookId": "53686d34-b4e3-4ec5-8047-9eba5a560364",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "pantalla_actual": "VERIFICACION",
            "datos_parciales": "={{\n(() => {\n  const rawInfo = $node[\"verificar_sesi√≥n\"] ? $node[\"verificar_sesi√≥n\"].json[\"datos_parciales\"] : \"\";\n  \n  let data = {};\n  \n  if (rawInfo) {\n      try {\n          data = typeof rawInfo === 'string' ? JSON.parse(rawInfo) : rawInfo;\n      } catch (e) {\n          data = {};\n      }\n  }\n\n  const nuevoDato = $node[\"Telegram Trigger1\"].json[\"message\"][\"text\"];\n  \n  data.motivo = nuevoDato; \n\n  return JSON.stringify(data);\n})()\n}}"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2000,
        19136
      ],
      "id": "fd317a04-840e-470e-b8a0-19f965d64c2d",
      "name": "Actualizar_campo (motivo)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "pantalla_actual": "VERIFICACION",
            "datos_parciales": "={{\n(() => {\n  const rawInfo = $node[\"verificar_sesi√≥n\"] ? $node[\"verificar_sesi√≥n\"].json[\"datos_parciales\"] : \"\";\n  \n  let data = {};\n  \n  if (rawInfo) {\n      try {\n          data = typeof rawInfo === 'string' ? JSON.parse(rawInfo) : rawInfo;\n      } catch (e) {\n          data = {};\n      }\n  }\n\n  const nuevoDato = $node[\"Telegram Trigger1\"].json[\"message\"][\"text\"];\n  \n  data.hora = nuevoDato; \n\n  return JSON.stringify(data);\n})()\n}}"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        18752
      ],
      "id": "4214dc5f-cfdb-4125-b75a-54f1f6280973",
      "name": "Actualizar_campo (hora)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "datos_parciales": "={{\n(() => {\n  let data = {};\n  // Intentamos leer lo que hay. Si est√° vac√≠o o da error, iniciamos vacio.\n  try {\n    data = JSON.parse($json[\"datos_parciales\"]);\n  } catch (e) {\n    data = {};\n  }\n  \n  // AQU√ç AGREGAMOS EL DATO NUEVO (Cambia 'fecha' seg√∫n el nodo)\n  data.canal = \"virtual\";\n  \n  return JSON.stringify(data);\n})()\n}}",
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "paso_actual": "",
            "pantalla_actual": "VERIFICACION"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        24608
      ],
      "id": "edd6f974-dd4a-4203-8b1e-011a76450114",
      "name": "Agendar_paso_5 (virtual)1",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "876f334e-7aea-408a-a110-a88c69f6e76e",
              "name": "canal",
              "value": "={{ JSON.parse($node[\"Agendar_paso_5 (presencial)1\"].json[\"datos_parciales\"]).canal }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2448,
        24416
      ],
      "id": "a727cbf0-6d82-4306-8617-64680d1e292b",
      "name": "field_presencial1"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "876f334e-7aea-408a-a110-a88c69f6e76e",
              "name": "canal",
              "value": "={{ JSON.parse($node[\"Agendar_paso_5 (virtual)1\"].json[\"datos_parciales\"]).canal }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2448,
        24608
      ],
      "id": "92bd2358-cac8-403d-a78a-aae4d892e01b",
      "name": "field_virtual1"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "datos_parciales": "={{\n(() => {\n  let data = {};\n  // Intentamos leer lo que hay. Si est√° vac√≠o o da error, iniciamos vacio.\n  try {\n    data = JSON.parse($json[\"datos_parciales\"]);\n  } catch (e) {\n    data = {};\n  }\n  \n  // AQU√ç AGREGAMOS EL DATO NUEVO (Cambia 'fecha' seg√∫n el nodo)\n  data.canal = \"llamada\";\n  \n  return JSON.stringify(data);\n})()\n}}",
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "paso_actual": "",
            "pantalla_actual": "VERIFICACION"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        24800
      ],
      "id": "bdc3489f-1058-4583-bf83-eb871ed6f9c5",
      "name": "Agendar_paso_5 (llamada)1",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "876f334e-7aea-408a-a110-a88c69f6e76e",
              "name": "canal",
              "value": "={{ JSON.parse($node[\"Agendar_paso_5 (llamada)1\"].json[\"datos_parciales\"]).canal }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2448,
        24800
      ],
      "id": "f726a9a4-ed04-49e5-a1b1-a3db925ca5c7",
      "name": "field_llamada1"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "=Revisa la informaci√≥n de tu cita üëÄ\n\nüë§ *Nombre:*  {{ JSON.parse($node[\"verificar_sesi√≥n\"].json[\"datos_parciales\"]).nombre }}\nüìÖ *Fecha:* {{ JSON.parse($node[\"verificar_sesi√≥n\"].json[\"datos_parciales\"]).fecha }}\n‚è∞ *Hora:* {{ JSON.parse($node[\"verificar_sesi√≥n\"].json[\"datos_parciales\"]).hora }}\nüìù *Motivo:* {{ JSON.parse($node[\"verificar_sesi√≥n\"].json[\"datos_parciales\"]).motivo }}\nüì° *Canal:* {{ $json.canal }}\n\n¬øQu√© deseas hacer?\n  1. Confirmar y guardar\n  2. Editar informaci√≥n\n  3. Cancelar\n\nüí° Sugerencia: Te recomiendo 1 (Confirmar y guardar).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2672,
        24704
      ],
      "id": "94388216-765b-463c-bbf4-146fc3207945",
      "name": "Agendar Cita Paso 6 Confirmar (EDITAR_CANAL)",
      "webhookId": "53686d34-b4e3-4ec5-8047-9eba5a560364",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "1",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "a7189d17-b037-404f-baf4-24eed23819e6"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "41448d46-c520-42a0-9394-a4ef6269320b",
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "2",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "746bee75-46a6-4597-a700-00477ecf3b07",
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "3",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {
          "fallbackOutput": "extra"
        }
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        2000,
        24864
      ],
      "id": "605228b3-819b-4aa2-bbe0-c6997d4af7b7",
      "name": "Switch_editar_tipo_canal"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "pantalla_actual": "VERIFICACION",
            "datos_parciales": "={{\n(() => {\n  const rawInfo = $node[\"verificar_sesi√≥n\"] ? $node[\"verificar_sesi√≥n\"].json[\"datos_parciales\"] : \"\";\n  \n  let data = {};\n  \n  if (rawInfo) {\n      try {\n          data = typeof rawInfo === 'string' ? JSON.parse(rawInfo) : rawInfo;\n      } catch (e) {\n          data = {};\n      }\n  }\n\n  const nuevoDato = $node[\"Telegram Trigger1\"].json[\"message\"][\"text\"];\n  \n  data.canal = \"presencial\"; \n\n  return JSON.stringify(data);\n})()\n}}"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        24416
      ],
      "id": "2715f9ea-a540-4ceb-a11e-6c424af0be34",
      "name": "Actualizar_campo (motivo)1",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "=¬øC√≥mo ser√° la atenci√≥n?\n\n1. Presencial\n\n2. Virtual\n\n3. Llamada\n\n4. Cancelar\n\nüí° Sugerencia:\nNormalmente se usa 2 (Virtual).",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        17504
      ],
      "id": "db7f9852-1635-408f-b592-a8e68f406f8e",
      "name": "Mensaje_nuevo_canal",
      "webhookId": "e85291c3-1b7e-48ad-8b3b-5569eb31d4c9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "pantalla_actual": "EDITAR_CANAL",
            "paso_actual": "0"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        17504
      ],
      "id": "0616622e-b892-4b4c-bc66-7b0cf61a1a91",
      "name": "Actualizar_estado (EDITAR_CANAL)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "pantalla_actual": "EDITAR_MOTIVO",
            "paso_actual": "0"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        17120
      ],
      "id": "dcf19081-5cde-4598-9d8f-d3cf47c24dfa",
      "name": "Actualizar_estado (EDITAR_MOTIVO)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "Por favor, escribe un nuevo motivo: ",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        17120
      ],
      "id": "a2e8d77b-e795-4fed-b7c3-cba1963d7ebb",
      "name": "Mensaje_nuevo_motivo",
      "webhookId": "e85291c3-1b7e-48ad-8b3b-5569eb31d4c9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "pantalla_actual": "VERIFICACION",
            "paso_actual": "0"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        17888
      ],
      "id": "b94038a9-351d-4a21-9e84-1efb243f468f",
      "name": "Actualizar_estado (VALIDACION)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "=Volviendo...",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        17888
      ],
      "id": "46dc2ed1-87b7-4479-9a82-53afa02126d9",
      "name": "Mensaje_cancelaci√≥n_edici√≥n",
      "webhookId": "e85291c3-1b7e-48ad-8b3b-5569eb31d4c9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "=Revisa la informaci√≥n de tu cita üëÄ\n\nüë§ *Nombre:*  {{ JSON.parse($node[\"verificar_sesi√≥n\"].json[\"datos_parciales\"]).nombre }}\nüìÖ *Fecha:* {{ JSON.parse($node[\"verificar_sesi√≥n\"].json[\"datos_parciales\"]).fecha }}\n‚è∞ *Hora:* {{ JSON.parse($node[\"verificar_sesi√≥n\"].json[\"datos_parciales\"]).hora }}\nüìù *Motivo:* {{ JSON.parse($node[\"verificar_sesi√≥n\"].json[\"datos_parciales\"]).motivo }}\nüì° *Canal:*  {{ JSON.parse($node[\"verificar_sesi√≥n\"].json[\"datos_parciales\"]).canal }}\n\n¬øQu√© deseas hacer?\n  1. Confirmar y guardar\n  2. Editar informaci√≥n\n  3. Cancelar\n\nüí° Sugerencia: Te recomiendo 1 (Confirmar y guardar).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2672,
        17888
      ],
      "id": "0b2e864e-9f8b-41cf-8c0c-3f2787f50c4f",
      "name": "Agendar Cita Paso 6 Confirmar1",
      "webhookId": "53686d34-b4e3-4ec5-8047-9eba5a560364",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "=Volviendo al men√∫ principal...",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        27680
      ],
      "id": "9756efcd-2cca-40fa-a53a-65698146076c",
      "name": "mensaje_regreso_MENU_CITAS",
      "webhookId": "e85291c3-1b7e-48ad-8b3b-5569eb31d4c9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "=Ups, esa opci√≥n no existe en este men√∫ üòÖ\n\nPor favor escribe uno de los n√∫meros que ves en pantalla.\n\nEst√°s en: {{ $json.pantalla_actual }}\nOpciones disponibles: 0 al 8\n\nüëâ Tip: escribe solo el n√∫mero (por ejemplo: 1).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2224,
        27872
      ],
      "id": "746283ef-4b48-4c34-9ec8-fabb92d3ddb1",
      "name": "Opci√≥n_no_valida (MENU_CITAS)",
      "webhookId": "e85291c3-1b7e-48ad-8b3b-5569eb31d4c9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "=Ups, esa opci√≥n no existe en este men√∫ üòÖ\n\nPor favor escribe uno de los n√∫meros que ves en pantalla.\n\nEst√°s en: {{ $json.pantalla_actual }}\nOpciones disponibles: 0 al 8\n\nüëâ Tip: escribe solo el n√∫mero (por ejemplo: 1).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2224,
        17696
      ],
      "id": "f40f1fb5-6a85-4d21-b1b9-55ff6ef33137",
      "name": "Opci√≥n_no_valida (MENU_EDITAR)",
      "webhookId": "e85291c3-1b7e-48ad-8b3b-5569eb31d4c9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "CITAS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=0"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "creado_por",
              "lookupValue": "={{ $('Telegram Trigger1').item.json.message.from.first_name }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        26144
      ],
      "id": "755e2c4e-e95a-48af-8803-25e9f4a119df",
      "name": "Obtener_citas",
      "alwaysOutputData": true,
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "=üì≠ *No tienes citas pendientes.*\n\nTu agenda est√° libre por ahora. Si quieres agendar una, elige la opci√≥n 1 en el men√∫ anterior.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2672,
        26240
      ],
      "id": "089c924e-53ec-42dc-aaab-0ca3b5411e53",
      "name": "Mensaje_sin_citas",
      "webhookId": "e85291c3-1b7e-48ad-8b3b-5569eb31d4c9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $node[\"Telegram Trigger1\"].json[\"message\"][\"chat\"][\"id\"] }}",
        "text": "={{ $json.texto_final }}",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2896,
        25760
      ],
      "id": "fd2a7c0b-ddfe-4622-ac31-70b3a05c2401",
      "name": "Mensaje_citas_resultado",
      "webhookId": "21ceb000-bd6f-4287-8ed6-a0a8e7cef777",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "CITAS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=0"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "creado_por",
              "lookupValue": "={{ $('Telegram Trigger1').item.json.message.from.first_name }}"
            },
            {
              "lookupColumn": "estado",
              "lookupValue": "Pendiente"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        27296
      ],
      "id": "10a0ce5a-5aa3-400c-a09e-b7b7a4a160fb",
      "name": "Obtener_citas1",
      "alwaysOutputData": true,
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "641737a1-1452-4fd6-a1fb-c7272fbe711c",
              "leftValue": "={{ $input.all().length }}",
              "rightValue": 0,
              "operator": {
                "type": "number",
                "operation": "gt"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        2448,
        26144
      ],
      "id": "e343f534-eea4-4576-9fd2-14c76afcaf08",
      "name": "IF_revisar_citas1"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "=üì≠ *No tienes citas para reprogramar.*",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2672,
        27392
      ],
      "id": "0592d474-66de-43a9-a078-e90acaa8dfbe",
      "name": "Mensaje_sin_citas_reprogramar",
      "webhookId": "e85291c3-1b7e-48ad-8b3b-5569eb31d4c9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "641737a1-1452-4fd6-a1fb-c7272fbe711c",
              "leftValue": "={{ $input.all().length }}",
              "rightValue": 0,
              "operator": {
                "type": "number",
                "operation": "gt"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        2448,
        27296
      ],
      "id": "d18a051e-6c91-4130-9e8b-1114fc417f76",
      "name": "IF_revisar_citas_reprogramar"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "pantalla_actual": "REPROGRAMAR_FECHA",
            "paso_actual": "0",
            "datos_parciales": "={{ JSON.stringify({ \"id_cita_editar\":  $('Telegram Trigger1').item.json.message.text}) }}"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2000,
        19328
      ],
      "id": "1ef09ea0-f66b-4d4d-90a9-996ba1f5aea2",
      "name": "Actualizar_estado (REPROGRAMAR_FECHA)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $node[\"Telegram Trigger1\"].json[\"message\"][\"chat\"][\"id\"] }}",
        "text": "=‚úÖ ID recibido. ¬øPara qu√© Nueva Fecha la deseas? (Ej: 2026-02-15)",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2224,
        19328
      ],
      "id": "028e7d71-4f68-4727-8f22-b77b90efa113",
      "name": "Mensaje_reprogramar_citas",
      "webhookId": "21ceb000-bd6f-4287-8ed6-a0a8e7cef777",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "pantalla_actual": "REPROGRAMAR_HORA",
            "paso_actual": "0",
            "datos_parciales": "={{\n(() => {\n  let data = {};\n  const rawInfo = $node[\"verificar_sesi√≥n\"].json[\"datos_parciales\"];\n  \n  if (rawInfo) {\n      try {\n          data = typeof rawInfo === 'string' ? JSON.parse(rawInfo) : rawInfo;\n      } catch (e) { data = {}; }\n  }\n\n  data.nueva_fecha = $node[\"Telegram Trigger1\"].json[\"message\"][\"text\"]; \n\n  // 3. RETORNAR\n  return JSON.stringify(data);\n})()\n}}"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2448,
        20288
      ],
      "id": "44c5553d-fbca-451e-9f4f-9602ac7b6e84",
      "name": "Actualizar_estado (REPROGRAMAR_HORA)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $node[\"Telegram Trigger1\"].json[\"message\"][\"chat\"][\"id\"] }}",
        "text": "=üìÖ Fecha guardada. ¬øA qu√© Nueva Hora? (Ej: 15:30)",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2672,
        20288
      ],
      "id": "ab574c62-c899-4589-a1c2-44b458247219",
      "name": "Mensaje_reprogramar_hora",
      "webhookId": "21ceb000-bd6f-4287-8ed6-a0a8e7cef777",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "CITAS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "id_cita": "={{ JSON.parse($node[\"verificar_sesi√≥n\"].json[\"datos_parciales\"]).id_cita_editar }}",
            "fecha": "={{ JSON.parse($node[\"verificar_sesi√≥n\"].json[\"datos_parciales\"]).nueva_fecha }}",
            "hora": "={{ $node[\"Telegram Trigger1\"].json[\"message\"][\"text\"] }}"
          },
          "matchingColumns": [
            "id_cita"
          ],
          "schema": [
            {
              "id": "id_cita",
              "displayName": "id_cita",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "fecha",
              "displayName": "fecha",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "hora",
              "displayName": "hora",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "nombre",
              "displayName": "nombre",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "motivo",
              "displayName": "motivo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "canal",
              "displayName": "canal",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "estado",
              "displayName": "estado",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "creado_por",
              "displayName": "creado_por",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_creacion",
              "displayName": "timestamp_creacion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        19520
      ],
      "id": "61fe4dae-f857-49a4-bf2c-38ee14256b94",
      "name": "Reprogramar_cita",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "pantalla_actual": "MENU_CITAS",
            "paso_actual": "0"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2448,
        19520
      ],
      "id": "b248b317-9f1a-41fd-916d-02252f9f7554",
      "name": "Actualizar_estado-reprogramar (volver MENU_CITAS)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "\nlet mensaje = \"üìÖ *Tu Agenda Actual:*\\n\\n\";\n\nfor (let i = 0; i < items.length; i++) {\n  const cita = items[i].json;\n  \n  // 3. Construimos el bloque de texto para cada cita\n  mensaje += `*${i + 1}.* üóì ${cita.fecha || \"Sin fecha\"} - ‚è∞ ${cita.hora || \"Sin hora\"}\\n`;\n  mensaje += `    üë§ Nombre: ${cita.nombre}\\n`;\n  mensaje += `    üìù Motivo: ${cita.motivo}\\n`;\n  mensaje += `    üîπ Estado: \\`${cita.estado}\\`\\n`; \n  mensaje += `    üÜî ID: \\`${cita.id_cita}\\`\\n`; \n  mensaje += `    -------------------------\\n`;\n}\n\nreturn [{ json: { texto_final: mensaje } }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2672,
        27200
      ],
      "id": "c609fe6b-9405-4b76-bed6-87f6b28461bf",
      "name": "Obtener_formater_citas (REPROGRAMAR_CITA)"
    },
    {
      "parameters": {
        "chatId": "={{ $node[\"Telegram Trigger1\"].json[\"message\"][\"chat\"][\"id\"] }}",
        "text": "={{ $('Obtener_formater_citas (REPROGRAMAR_CITA)').item.json.texto_final }}\n\nüëÜ Arriba tienes tus citas.\n\n‚úçÔ∏è Por favor, **copia y pega el ID** de la cita que deseas cambiar (Ej: `CITA-20260124...`).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        3120,
        27200
      ],
      "id": "c05663fe-52e2-45a9-9bca-dfb9a871fe1b",
      "name": "Mensaje_solicitar_cita_id",
      "webhookId": "e85291c3-1b7e-48ad-8b3b-5569eb31d4c9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $node[\"Telegram Trigger1\"].json[\"message\"][\"chat\"][\"id\"] }}",
            "pantalla_actual": "REPROGRAMAR_ESPERAR_ID",
            "paso_actual": "0"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2896,
        27200
      ],
      "id": "6872ab72-ba28-4bfa-855d-dd2dee25b6f9",
      "name": "Actualizar_estado (REPROGRAMAR_ESPERAR_ID)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $node[\"Telegram Trigger1\"].json[\"message\"][\"chat\"][\"id\"] }}",
        "text": "=üîÑ *¬°Cita Reprogramada con √âxito!*  Se ha actualizado la fecha y hora de tu cita.  ¬øQu√© deseas hacer ahora? \n\n1. Agendar nueva \n2. Consultar",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2672,
        19520
      ],
      "id": "27e02220-4d38-4065-8078-fde2a66b488a",
      "name": "Mensaje_reprogramar_cita_resultado",
      "webhookId": "21ceb000-bd6f-4287-8ed6-a0a8e7cef777",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "CITAS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=0"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "creado_por",
              "lookupValue": "={{ $('Telegram Trigger1').item.json.message.from.first_name }}"
            },
            {
              "lookupColumn": "estado",
              "lookupValue": "Pendiente"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        26528
      ],
      "id": "0072e38b-5fc1-494d-bdb2-13a4ca85b564",
      "name": "Obtener_citas2",
      "alwaysOutputData": true,
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "641737a1-1452-4fd6-a1fb-c7272fbe711c",
              "leftValue": "={{ $input.all().length }}",
              "rightValue": 0,
              "operator": {
                "type": "number",
                "operation": "gt"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        2448,
        26528
      ],
      "id": "736b02b0-784f-497e-bc9d-894678d41653",
      "name": "IF_revisar_citas_cancelar"
    },
    {
      "parameters": {
        "jsCode": "\nlet mensaje = \"üìÖ *Tu Agenda Actual:*\\n\\n\";\n\nfor (let i = 0; i < items.length; i++) {\n  const cita = items[i].json;\n\n  mensaje += `*${i + 1}.* üóì ${cita.fecha || \"Sin fecha\"} - ‚è∞ ${cita.hora || \"Sin hora\"}\\n`;\n  mensaje += `    üë§ Nombre: ${cita.nombre}\\n`;\n  mensaje += `    üìù Motivo: ${cita.motivo}\\n`;\n  mensaje += `    üîπ Estado: \\`${cita.estado}\\`\\n`; \n  mensaje += `    üÜî ID: \\`${cita.id_cita}\\`\\n`; \n  mensaje += `    -------------------------\\n`;\n}\n\nreturn [{ json: { texto_final: mensaje } }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2672,
        26432
      ],
      "id": "5afbc867-c1d1-48e0-a73f-92ff14503360",
      "name": "Obtener_cancelar_citas (CANCELAR_CITA)"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $node[\"Telegram Trigger1\"].json[\"message\"][\"chat\"][\"id\"] }}",
            "pantalla_actual": "CANCELAR_ESPERAR_ID",
            "paso_actual": "0"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2896,
        26432
      ],
      "id": "8bf1c9c9-21e3-4b24-acb9-39e0509527d0",
      "name": "Actualizar_estado (CANCELAR_ESPERAR_ID)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $node[\"Telegram Trigger1\"].json[\"message\"][\"chat\"][\"id\"] }}",
        "text": "={{ $node[\"Obtener_cancelar_citas (CANCELAR_CITA)\"].json[\"texto_final\"] }}\n\nüëÜ Aqu√≠ tienes tus citas activas.\n\nüóëÔ∏è Para cancelar una, por favor **copia y pega el ID** de la cita (Ej: `CITA-2025...`).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        3120,
        26432
      ],
      "id": "724f90b1-81a6-4fae-bb06-b313a7f143e5",
      "name": "Mensaje_solicitar_cita_id_cancelar",
      "webhookId": "e85291c3-1b7e-48ad-8b3b-5569eb31d4c9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $node[\"Telegram Trigger1\"].json[\"message\"][\"chat\"][\"id\"] }}",
        "text": "=üóëÔ∏è *¬°Cita Cancelada!*\n\nLa cita ha sido eliminada de tu agenda activa.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        20096
      ],
      "id": "78d3447c-0d48-49ca-b044-7b4163e6e74e",
      "name": "Mensaje_cancelar_cita_resultado",
      "webhookId": "21ceb000-bd6f-4287-8ed6-a0a8e7cef777",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "CITAS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "id_cita": "={{ $node[\"Telegram Trigger1\"].json[\"message\"][\"text\"] }}",
            "estado": "Cancelada"
          },
          "matchingColumns": [
            "id_cita"
          ],
          "schema": [
            {
              "id": "id_cita",
              "displayName": "id_cita",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "fecha",
              "displayName": "fecha",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "hora",
              "displayName": "hora",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "nombre",
              "displayName": "nombre",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "motivo",
              "displayName": "motivo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "canal",
              "displayName": "canal",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "estado",
              "displayName": "estado",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "creado_por",
              "displayName": "creado_por",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_creacion",
              "displayName": "timestamp_creacion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2000,
        20096
      ],
      "id": "954cdaec-089d-4ebf-b4d6-8d493c7f8b9b",
      "name": "Actualizar_campo (CANCELAR)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "pantalla_actual": "MENU_CITAS",
            "paso_actual": "0",
            "datos_parciales": "-"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        20096
      ],
      "id": "b49c71e4-7273-40d1-b471-0e244249671a",
      "name": "Actualizar_estado_cancelar (MENU_CITAS)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "CITAS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=0"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "creado_por",
              "lookupValue": "={{ $('Telegram Trigger1').item.json.message.from.first_name }}"
            },
            {
              "lookupColumn": "estado",
              "lookupValue": "Pendiente"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        26912
      ],
      "id": "8c43bda3-52ee-4b9c-a575-15bcccbb2b36",
      "name": "Obtener_citas3",
      "alwaysOutputData": true,
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "641737a1-1452-4fd6-a1fb-c7272fbe711c",
              "leftValue": "={{ $input.all().length }}",
              "rightValue": 0,
              "operator": {
                "type": "number",
                "operation": "gt"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        2448,
        26912
      ],
      "id": "7e84afe1-15f3-4d68-89c1-4d04b8a3eac2",
      "name": "IF_revisar_citas_completar"
    },
    {
      "parameters": {
        "jsCode": "\nlet mensaje = \"üìÖ *Tu Agenda Actual:*\\n\\n\";\n\nfor (let i = 0; i < items.length; i++) {\n  const cita = items[i].json;\n\n  mensaje += `*${i + 1}.* üóì ${cita.fecha || \"Sin fecha\"} - ‚è∞ ${cita.hora || \"Sin hora\"}\\n`;\n  mensaje += `    üë§ Nombre: ${cita.nombre}\\n`;\n  mensaje += `    üìù Motivo: ${cita.motivo}\\n`;\n  mensaje += `    üîπ Estado: \\`${cita.estado}\\`\\n`; \n  mensaje += `    üÜî ID: \\`${cita.id_cita}\\`\\n`; \n  mensaje += `    -------------------------\\n`;\n}\n\nreturn [{ json: { texto_final: mensaje } }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2672,
        26816
      ],
      "id": "67abda6c-2b1d-437b-a789-62f68005cc05",
      "name": "Obtener_completar_citas (CCOMPLETAR_CITA)"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $node[\"Telegram Trigger1\"].json[\"message\"][\"chat\"][\"id\"] }}",
            "pantalla_actual": "COMPLETAR_ESPERAR_ID",
            "paso_actual": "0"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2896,
        26816
      ],
      "id": "1b7274ec-2445-4a10-ac30-e046e7bf961a",
      "name": "Actualizar_estado (COMPLETAR_ESPERAR_ID)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $node[\"Telegram Trigger1\"].json[\"message\"][\"chat\"][\"id\"] }}",
        "text": "={{ $node[\"Obtener_completar_citas (CCOMPLETAR_CITA)\"].json[\"texto_final\"] }}\n\nüëÜ Aqu√≠ tienes tus citas pendientes.\n\n‚úÖ Para marcar una como realizada, **copia y pega el ID** de la cita (Ej: `CITA-2025...`).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        3120,
        26816
      ],
      "id": "77c8d08b-a9a8-4724-8a5f-be1d08381b8a",
      "name": "Mensaje_solicitar_cita_id_completar",
      "webhookId": "e85291c3-1b7e-48ad-8b3b-5569eb31d4c9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "CITAS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "id_cita": "={{ $node[\"Telegram Trigger1\"].json[\"message\"][\"text\"] }}",
            "estado": "Completada"
          },
          "matchingColumns": [
            "id_cita"
          ],
          "schema": [
            {
              "id": "id_cita",
              "displayName": "id_cita",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "fecha",
              "displayName": "fecha",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "hora",
              "displayName": "hora",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "nombre",
              "displayName": "nombre",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "motivo",
              "displayName": "motivo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "canal",
              "displayName": "canal",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "estado",
              "displayName": "estado",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "creado_por",
              "displayName": "creado_por",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_creacion",
              "displayName": "timestamp_creacion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2000,
        19904
      ],
      "id": "fd5bab83-294b-48c1-a942-44a345655e3d",
      "name": "Actualizar_campo (COMPLETAR)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "pantalla_actual": "MENU_CITAS",
            "paso_actual": "0",
            "datos_parciales": "-"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        19904
      ],
      "id": "3259a509-2c54-4fc7-b735-6585001bdd25",
      "name": "Actualizar_estado_completar (MENU_CITAS)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $node[\"Telegram Trigger1\"].json[\"message\"][\"chat\"][\"id\"] }}",
        "text": "=üéâ *¬°Excelente! Cita marcada como completada.*\n\nSe ha guardado en tu historial.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        19904
      ],
      "id": "12577440-5fc1-4504-856b-b3d110fe30b8",
      "name": "Mensaje_completar_cita_resultado",
      "webhookId": "21ceb000-bd6f-4287-8ed6-a0a8e7cef777",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "=üì≠ *No tienes citas para cancrlar.*\n\nTu agenda est√° libre por ahora. Si quieres agendar una, elige la opci√≥n 1 en el men√∫ anterior.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2672,
        26624
      ],
      "id": "f31380fe-31b4-4de1-b015-3681f97566f1",
      "name": "Mensaje_sin_citas_cancelar",
      "webhookId": "e85291c3-1b7e-48ad-8b3b-5569eb31d4c9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "=üì≠ *No tienes citas pendientes.*\n\nTu agenda est√° libre por ahora. Si quieres agendar una, elige la opci√≥n 1 en el men√∫ anterior.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2672,
        27008
      ],
      "id": "a6ab8b34-52e2-47df-9a14-95f7ccd5f353",
      "name": "Mensaje_sin_citas_completar",
      "webhookId": "e85291c3-1b7e-48ad-8b3b-5569eb31d4c9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "={{ \"1\" }}",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "38f29dd4-22dc-4f60-8034-104b08f759c2"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "91595c7f-cb48-4f06-a331-8d8016e10989",
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "={{ \"3\" }}",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "52b8306b-4fc7-497d-8f26-c75ab916b7ac",
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "={{ \"6\" }}",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "7822bff0-b809-448a-bc3b-546eeb2ea936",
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "={{ \"7\" }}",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "5900d2d6-4eb6-42a5-b6e7-0792e9b6745e",
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "={{ \"8\" }}",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {
          "fallbackOutput": "extra"
        }
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        2000,
        15952
      ],
      "id": "0dfd6c7b-8abb-4911-98fe-c69bde1252c3",
      "name": "Switch_menu_principal"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "pantalla_actual": "MENU_CONFIGURACION",
            "paso_actual": "0"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        16352
      ],
      "id": "19827ae6-25c5-4daa-bc5b-8d12636349f0",
      "name": "Actualizar_estado (MENU_CONFIGURACION)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $node[\"Telegram Trigger1\"].json[\"message\"][\"chat\"][\"id\"] }}",
        "text": "=‚öôÔ∏è *Configuraci√≥n*\n\nAqu√≠ puedes gestionar tu cuenta y el bot.\n\n1. üë§ Ver mi perfil\n2Ô∏è. üîÑ Reiniciar conversaci√≥n (Si algo falla)\n3Ô∏è. üîô Volver al men√∫ principal",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        16352
      ],
      "id": "cbde2d06-8038-49a2-9231-aa6bf5f76f1b",
      "name": "Mensaje_menu_configuracion",
      "webhookId": "21ceb000-bd6f-4287-8ed6-a0a8e7cef777",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "={{ \"1\" }}",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "e69cfef1-495d-4e90-9e9d-5ff6ea637623"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "f4c25ecd-267c-4c0f-a971-b5b38d38d2b4",
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "={{ \"2\" }}",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "9f5e1107-b9bc-4848-a57f-2a6b8146238e",
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "={{ \"3\" }}",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        2000,
        24112
      ],
      "id": "1612766b-51d1-4400-9a08-a11eab070457",
      "name": "Switch_menu_configuracion"
    },
    {
      "parameters": {
        "chatId": "={{ $node[\"Telegram Trigger1\"].json[\"message\"][\"chat\"][\"id\"] }}",
        "text": "=üë§ *Tu Perfil de Usuario*\n\n*Nombre:* {{ $node[\"Telegram Trigger1\"].json[\"message\"][\"chat\"][\"first_name\"] }}\n*Apellido:* {{ $node[\"Telegram Trigger1\"].json[\"message\"][\"chat\"][\"last_name\"] }}\n*ID de Usuario:* `{{ $node[\"Telegram Trigger1\"].json[\"message\"][\"chat\"][\"id\"] }}`\n*Idioma:* {{ $node[\"Telegram Trigger1\"].json[\"message\"][\"from\"][\"language_code\"] }}\n\n‚ÑπÔ∏è _Este ID es √∫nico y sirve para identificar tu agenda._",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2224,
        23840
      ],
      "id": "8ceac5ae-c5c4-45c2-818a-c5f151a34cc6",
      "name": "Mensaje_user_info",
      "webhookId": "e85291c3-1b7e-48ad-8b3b-5569eb31d4c9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "pantalla_actual": "MENU_PRINCIPAL",
            "paso_actual": "",
            "datos_parciales": "={}"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        24032
      ],
      "id": "0c885077-61c6-4fd1-a965-d987b7de6ef7",
      "name": "Actualizar_estado_reinicio (MENU_PRINCIPAL)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $node[\"Telegram Trigger1\"].json[\"message\"][\"chat\"][\"id\"] }}",
        "text": "=üîÑ *¬°Bot Reiniciado!*\n\nHe borrado la memoria temporal de nuestra conversaci√≥n. Estamos listos para empezar de nuevo.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        24032
      ],
      "id": "aedceade-cd87-40e7-950f-227c790da104",
      "name": "Mensaje_user_reinicio",
      "webhookId": "e85291c3-1b7e-48ad-8b3b-5569eb31d4c9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $node[\"Telegram Trigger1\"].json[\"message\"][\"chat\"][\"id\"] }}",
        "text": "=Hola, soy AgendaBot üëã\n\nEstoy aqu√≠ para ayudarte a organizar tus citas, tareas y recordatorios\nde forma sencilla y sin complicaciones.\n\nPuedes escribirme en cualquier momento.\nPara avanzar, solo tienes que escribir el n√∫mero de la opci√≥n que quieras usar.\n\nMen√∫ principal:\n0. Ayuda\n1. Agenda (citas)\n2. Tareas\n3. Recordatorios\n4. H√°bitos\n5. Listas\n6. Reportes\n7. Configuraci√≥n\n8. Administrador",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2672,
        24032
      ],
      "id": "8de66712-3733-4c1b-adf8-9304051af635",
      "name": "Mensaje_user_menu_principal",
      "webhookId": "e85291c3-1b7e-48ad-8b3b-5569eb31d4c9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "¬øEn qu√© te puedo ayudar hoy? üòä\n\nMen√∫ principal:\n0. Ayuda\n\n1. Agenda (citas)\n\n2. Tareas\n\n3. Recordatorios\n\n4. H√°bitos\n\n5. Listas\n\n6. Reportes\n\n7. Configuraci√≥n\n\n8. Administrador\n\nüí° Sugerencia:\nSi quieres empezar r√°pido, te recomiendo la opci√≥n 1 (Agenda).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        24224
      ],
      "id": "8a37f253-9e17-459e-b419-e41441957f19",
      "name": "Menu Principal_regreso",
      "webhookId": "e85291c3-1b7e-48ad-8b3b-5569eb31d4c9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "e556100d-4272-4a61-8297-59b04fba537a",
              "leftValue": "={{ $json.rol }}",
              "rightValue": "administrador",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        2448,
        15488
      ],
      "id": "7649ecb8-917e-4b5d-a64b-e0e17670353b",
      "name": "If_es_ADMIN?"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 2006573822,
          "mode": "list",
          "cachedResultName": "USUARIOS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=2006573822"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "rol",
              "lookupValue": "administrador"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        15488
      ],
      "id": "67bbc7d4-d2fd-494c-a658-daded49917f0",
      "name": "Obtener_usuario",
      "alwaysOutputData": true,
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "=‚õî *Acceso Denegado*\n\nEsta opci√≥n est√° reservada √∫nicamente para administradores del sistema.\n\nüëÆ‚Äç‚ôÇÔ∏è Tu intento ha sido registrado.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2672,
        15584
      ],
      "id": "47a14ae5-2f4f-466a-bb7c-e81244890306",
      "name": "Mensaje_denegacion_permiso",
      "webhookId": "53686d34-b4e3-4ec5-8047-9eba5a560364",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "pantalla_actual": "MENU_ADMIN",
            "paso_actual": "0"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2672,
        15392
      ],
      "id": "6a6d2aa5-5b3a-4548-a612-1247c4c3acc5",
      "name": "Actualizar_estado (MENU_ADMIN)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "=üïµÔ∏è‚Äç‚ôÇÔ∏è *Panel de Administrador*\n\nBienvenido, Jefe. ¬øQu√© deseas supervisar?\n\n1Ô∏è. üåç Ver TODAS las citas (Global)\n2Ô∏è. üìä Ver Estad√≠sticas (Usuarios/Citas)\n3Ô∏è. üì¢ Enviar Anuncio Global (Broadcast)\n4Ô∏è. üîô Volver al Men√∫ Principal",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2896,
        15392
      ],
      "id": "fab4460d-eba6-4938-b970-0a5def59e32a",
      "name": "Mensaje_MENU_ADMIN",
      "webhookId": "53686d34-b4e3-4ec5-8047-9eba5a560364",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "={{ \"1\" }}",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "19ceeda5-942f-465e-85e4-7fc624f631ed"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "28eafc6a-73a5-46c5-b43b-4e312f7742c5",
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "={{ \"2\" }}",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "84e5e911-17f3-43cc-a901-71de7f7bea54",
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "={{ \"3\" }}",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "4ffed133-ead8-46d0-b73d-7e2de83accc0",
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "={{ \"4\" }}",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        2000,
        23384
      ],
      "id": "3ec686ff-13aa-4869-90cf-69ff2c480701",
      "name": "Switch_ADMIN"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "CITAS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=0"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        22880
      ],
      "id": "ad393a52-022a-49a7-8203-0c737d7a81c6",
      "name": "Obtener_citas_global",
      "alwaysOutputData": true,
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "641737a1-1452-4fd6-a1fb-c7272fbe711c",
              "leftValue": "={{ $input.all().length }}",
              "rightValue": 0,
              "operator": {
                "type": "number",
                "operation": "gt"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        2448,
        22880
      ],
      "id": "d399118a-5141-4c05-b628-d5ecb2134035",
      "name": "IF_revisar_citas_global"
    },
    {
      "parameters": {
        "jsCode": "\nlet mensaje = \"üìÖ *Tu Agenda Actual:*\\n\\n\";\n\nfor (let i = 0; i < items.length; i++) {\n  const cita = items[i].json;\n\n  mensaje += `*${i + 1}.* üóì ${cita.fecha || \"Sin fecha\"} - ‚è∞ ${cita.hora || \"Sin hora\"}\\n`;\n  mensaje += `    üë§ Nombre: ${cita.nombre}\\n`;\n  mensaje += `    üìù Motivo: ${cita.motivo}\\n`;\n  mensaje += `    üîπ Estado: \\`${cita.estado}\\`\\n`; \n  mensaje += `    üÜî ID: \\`${cita.id_cita}\\`\\n`; \n  mensaje += `    -------------------------\\n`;\n}\n\nreturn [{ json: { texto_final: mensaje } }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2672,
        22784
      ],
      "id": "07dfc0e0-27fd-4bd9-8a9c-8122318e6048",
      "name": "Obtener_citas (global)"
    },
    {
      "parameters": {
        "chatId": "={{ $node[\"Telegram Trigger1\"].json[\"message\"][\"chat\"][\"id\"] }}",
        "text": "=No hay citas agendadas globalmente.\n\n(ADMIN)",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2672,
        23072
      ],
      "id": "3de56ac2-be36-4760-8d7c-ebdfe5c20fee",
      "name": "Mensaje_sin citas_global",
      "webhookId": "e85291c3-1b7e-48ad-8b3b-5569eb31d4c9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $node[\"Telegram Trigger1\"].json[\"message\"][\"chat\"][\"id\"] }}",
        "text": "=AGENDAMIENTOS GLOBALES:\n\n{{ $json.texto_final }}\n\nADMIN",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2896,
        22784
      ],
      "id": "73f6e0db-2027-438e-8230-d0f16045c765",
      "name": "Mensaje_citas_global",
      "webhookId": "e85291c3-1b7e-48ad-8b3b-5569eb31d4c9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "CITAS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=0"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2448,
        23648
      ],
      "id": "eec83c78-4fdb-448e-91fe-7832e63baa3c",
      "name": "Obtener_citas_global_estadisticas",
      "alwaysOutputData": true,
      "executeOnce": true,
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        23648
      ],
      "id": "8927dffb-d1dc-446c-9d50-c009e256e15d",
      "name": "Obtener_sesiones_global_estadisticas",
      "alwaysOutputData": true,
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "let usuariosRaw = [];\nlet citasRaw = [];\n\ntry {\n    usuariosRaw = $items(\"Obtener_sesiones_global_estadisticas\"); \n} catch (e) {}\n\ntry {\n    citasRaw = $items(\"Obtener_citas_global_estadisticas\"); \n} catch (e) {\n    citasRaw = [];\n}\n\nconst usuariosReales = usuariosRaw.filter(u => u.json.telegram_user && u.json.telegram_user !== \"\");\n\nconst citasReales = citasRaw.filter(c => c.json.id_cita && c.json.id_cita !== \"\");\n\nconst citasPendientes = citasReales.filter(c => c.json.estado === 'Pendiente').length;\n\nconst msg = `üìä *Estad√≠sticas del Bot*\n\nüë• *Usuarios Reales:* ${usuariosReales.length}\nüìÖ *Citas Totales:* ${citasReales.length}\n‚è≥ *Pendientes:* ${citasPendientes}\n\n‚úÖ _Datos verificados._`;\n\nreturn [{ json: { msg: msg } }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2672,
        23648
      ],
      "id": "62431600-1324-4310-881b-0c97ae30e8e8",
      "name": "Formatear_campos_estadisticas",
      "executeOnce": true
    },
    {
      "parameters": {
        "chatId": "={{ $node[\"Telegram Trigger1\"].json[\"message\"][\"chat\"][\"id\"] }}",
        "text": "={{ $json[\"msg\"] }}",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2896,
        23648
      ],
      "id": "f9ad146e-24a0-4613-be39-d92bc26f213e",
      "name": "Mensaje_sin citas_global1",
      "webhookId": "e85291c3-1b7e-48ad-8b3b-5569eb31d4c9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "pantalla_actual": "ADMIN_BROADCAST",
            "paso_actual": "0",
            "datos_parciales": "-"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        23072
      ],
      "id": "4d1c6213-ea73-4c3e-a675-0d4d607f9e83",
      "name": "Actualizar_estado (ADMIN_BROADCAST)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $node[\"Telegram Trigger1\"].json[\"message\"][\"chat\"][\"id\"] }}",
        "text": "=üì¢ *Nuevo Anuncio Global*\n\nPor favor, escribe el mensaje que quieres enviar a TODOS los usuarios.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        23072
      ],
      "id": "52191d0a-bc8e-4d9a-b105-0d138ea10ee2",
      "name": "Mensaje_solicitar_broadcast_global",
      "webhookId": "e85291c3-1b7e-48ad-8b3b-5569eb31d4c9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "pantalla_actual": "ADMIN_BROADCAST_CONFIRMAR",
            "paso_actual": "0",
            "datos_parciales": "={{ JSON.stringify({ \"mensaje_broadcast\": $node[\"Telegram Trigger1\"].json[\"message\"][\"text\"] }) }}"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2000,
        20768
      ],
      "id": "e99d7280-35c7-4b99-a1c1-2b169805ee1d",
      "name": "Actualizar_estado (ADMIN_BROADCAST_CONFIRMAR)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $node[\"Telegram Trigger1\"].json[\"message\"][\"chat\"][\"id\"] }}",
        "text": "=üëÅÔ∏è *VISTA PREVIA DEL ANUNCIO:*\n--------------------------------\n{{ $('Telegram Trigger1').item.json.message.text }}\n--------------------------------\n\n¬øEst√°s seguro de enviar esto a todos los usuarios?\n1. ‚úÖ S√ç, ENVIAR AHORA\n2. ‚ùå NO, CANCELAR",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2224,
        20768
      ],
      "id": "9a928307-25f4-45b2-9b1b-e9db03fe6577",
      "name": "Mensaje_previo_global",
      "webhookId": "21ceb000-bd6f-4287-8ed6-a0a8e7cef777",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "={{ \"1\" }}",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "9226d60b-f282-4492-900b-6dbd5ab3dc54"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "aa959bfe-d3e3-406a-bd96-da0c69bc03a6",
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "={{ \"2\" }}",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        2000,
        21824
      ],
      "id": "55888025-33c1-442c-9190-963c11e63c08",
      "name": "Switch_confirmar_mensaje_global"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "pantalla_actual": "MENU_ADMIN",
            "paso_actual": "0",
            "datos_parciales": "="
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        21920
      ],
      "id": "f6a60fde-c2a0-46e9-82e9-405d85391a7b",
      "name": "Actualizar_estado_cancelaci√≥n (MENU_ADMIN)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $node[\"Telegram Trigger1\"].json[\"message\"][\"chat\"][\"id\"] }}",
        "text": "=Operaci√≥n cancelada.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        21920
      ],
      "id": "c45d9b46-bf9d-4e63-9b71-1e1a5493a369",
      "name": "Mensaje_cancelaci√≥n_global",
      "webhookId": "21ceb000-bd6f-4287-8ed6-a0a8e7cef777",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        21728
      ],
      "id": "6c475886-9ecc-452f-8003-c4926c4d07b0",
      "name": "Obtener_sesiones_mensaje_global",
      "alwaysOutputData": true,
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "031761d0-329c-4c50-a02e-55f8162049f6",
              "leftValue": "={{ $json.telegram_user }}",
              "rightValue": 0,
              "operator": {
                "type": "number",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.filter",
      "typeVersion": 2.3,
      "position": [
        2448,
        21728
      ],
      "id": "82de2fe3-2655-4de6-aae3-fdb879f0e2df",
      "name": "Filter"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "pantalla_actual": "MENU_ADMIN",
            "paso_actual": "0",
            "datos_parciales": "="
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2896,
        21728
      ],
      "id": "2a68bbc7-fcdf-42e1-a1b6-dff3ff42982d",
      "name": "Actualizar_estado_exitoso (MENU_ADMIN)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $json[\"telegram_user\"] }}",
        "text": "=üì¢ *Anuncio Importante:*\n\nüì¢ *Anuncio Importante:*\n\n{{ JSON.parse($node[\"verificar_sesi√≥n\"].json[\"datos_parciales\"]).mensaje_broadcast }}",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2672,
        21728
      ],
      "id": "6bdca73f-da7b-437f-9434-57fe6d92329f",
      "name": "Mensaje_envio_global",
      "webhookId": "21ceb000-bd6f-4287-8ed6-a0a8e7cef777",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "=Mensaje enviado con exito, has sido devuelto al panel del administrador\n\nüïµÔ∏è‚Äç‚ôÇÔ∏è *Panel de Administrador*\n\n1Ô∏è. üåç Ver TODAS las citas (Global)\n2Ô∏è. üìä Ver Estad√≠sticas (Usuarios/Citas)\n3Ô∏è. üì¢ Enviar Anuncio Global (Broadcast)\n4Ô∏è. üîô Volver al Men√∫ Principal",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        3120,
        21728
      ],
      "id": "01076a6a-b07d-4d42-b1cd-556bb213feef",
      "name": "Mensaje_MENU_ADMIN1",
      "webhookId": "53686d34-b4e3-4ec5-8047-9eba5a560364",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "pantalla_actual": "MENU_PRINCIPAL",
            "paso_actual": "0",
            "datos_parciales": "="
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        23456
      ],
      "id": "24ea5ee0-3c92-4814-bc16-3f3068d02a14",
      "name": "Actualizar_estado_cancelaci√≥n (MENU_PRINCIPAL)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $node[\"Telegram Trigger1\"].json[\"message\"][\"chat\"][\"id\"] }}",
        "text": "=Saliendo al Men√∫ principal...\n(ADMIN)",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        23456
      ],
      "id": "9d224e7d-296d-4711-a2a8-a2bbeb11bcec",
      "name": "Mensaje_salir_admin",
      "webhookId": "e85291c3-1b7e-48ad-8b3b-5569eb31d4c9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "¬øEn qu√© te puedo ayudar hoy? üòä\n\nMen√∫ principal:\n0. Ayuda\n\n1. Agenda (citas)\n\n2. Tareas\n\n3. Recordatorios\n\n4. H√°bitos\n\n5. Listas\n\n6. Reportes\n\n7. Configuraci√≥n\n\n8. Administrador\n\nüí° Sugerencia:\nSi quieres empezar r√°pido, te recomiendo la opci√≥n 1 (Agenda).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2672,
        23456
      ],
      "id": "8f03345c-380e-4584-9f58-a93bc6714e32",
      "name": "Menu Principal1",
      "webhookId": "e85291c3-1b7e-48ad-8b3b-5569eb31d4c9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "¬øEn qu√© te puedo ayudar hoy? üòä\n\nMen√∫ principal:\n0. Ayuda\n\n1. Agenda (citas)\n\n2. Tareas\n\n3. Recordatorios\n\n4. H√°bitos\n\n5. Listas\n\n6. Reportes\n\n7. Configuraci√≥n\n\n8. Administrador\n\nüí° Sugerencia:\nSi quieres empezar r√°pido, te recomiendo la opci√≥n 1 (Agenda).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        16544
      ],
      "id": "c603fb76-9004-4e03-825e-2bbeca25d5b0",
      "name": "Menu Principal2",
      "webhookId": "e85291c3-1b7e-48ad-8b3b-5569eb31d4c9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "CITAS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=0"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "creado_por",
              "lookupValue": "={{ $('Telegram Trigger1').item.json.message.from.first_name }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2672,
        13656
      ],
      "id": "644e9939-906e-423d-a154-b4af0a109efb",
      "name": "Obtener_citas_verificacion_dovle_reserva",
      "alwaysOutputData": true,
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "1cd39e6d-23ff-4171-a149-57e5fbb9bf61",
              "leftValue": "={{ $json[\"conflictCount\"] }}",
              "rightValue": 0,
              "operator": {
                "type": "number",
                "operation": "gt"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        3120,
        13656
      ],
      "id": "0971055a-2e50-429a-9779-5895ca7173e5",
      "name": "If_citas_repetidas_fecha"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "8720a747-a549-41da-a2b5-4b7a230b865d",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "=^\\d{4}-\\d{2}-\\d{2}$",
              "operator": {
                "type": "string",
                "operation": "regex"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        2448,
        13368
      ],
      "id": "3597eca0-d8f8-41b0-aa38-9466be1813da",
      "name": "If_validar_formato_fecha"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "8720a747-a549-41da-a2b5-4b7a230b865d",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "=^([01]\\d|2[0-3]):[0-5]\\d$",
              "operator": {
                "type": "string",
                "operation": "regex"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        2448,
        13752
      ],
      "id": "5fcdc8d1-991e-458a-b6b7-020d1006eca2",
      "name": "If_validar_formato_hora"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "2c064515-ed9d-4706-aafd-b6338a08fcdf",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "={{ $now.setZone('America/Bogota').toFormat('yyyy-MM-dd') }}",
              "operator": {
                "type": "dateTime",
                "operation": "afterOrEquals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        2224,
        20384
      ],
      "id": "b089936b-9187-431e-b71f-1638d3551907",
      "name": "If_validar_fecha_reprogramar1"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "8720a747-a549-41da-a2b5-4b7a230b865d",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "=^\\d{4}-\\d{2}-\\d{2}$",
              "operator": {
                "type": "string",
                "operation": "regex"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        2000,
        20480
      ],
      "id": "e63a2656-8c96-4dba-a180-66fc4b3f237c",
      "name": "If_validar_formato_fecha_reprogramar1"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "=Ups üòÖ la fecha no tiene el formato correcto.\n\nRecuerda usar: YYYY-MM-DD\nEjemplo: 2025-12-20\n\n9. Cancelar",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2224,
        20576
      ],
      "id": "1dca7f98-48fb-47c2-9078-5baede1fb6b3",
      "name": "Fecha Invalida_reprogramar1",
      "webhookId": "032cae0e-0c44-46ea-ab8d-e61649d9bca9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "Hmm ü§î esa fecha ya pas√≥.\n\nPor favor ingresa una fecha futura.\n\nEjemplo: 2026-12-20\n\n9. Cancelar",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        20576
      ],
      "id": "89a7930d-4618-4f56-a08d-745199f0718d",
      "name": "Fecha en el pasado_reprogramar1",
      "webhookId": "431e9db7-ea8c-443c-bb82-65fa90992bd9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "8720a747-a549-41da-a2b5-4b7a230b865d",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "=^([01]\\d|2[0-3]):[0-5]\\d$",
              "operator": {
                "type": "string",
                "operation": "regex"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        2000,
        19616
      ],
      "id": "0fe09fd0-e551-4d11-8847-fbee28229ba3",
      "name": "If_validar_formato_hora_reprogramar"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "=Ups üòÖ la hora no tiene un formato v√°lido.\n\nRecuerda usar formato 24 horas:\nHH:MM\n\nEjemplo: 14:30\n\n9. Cancelar",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2224,
        19712
      ],
      "id": "2269bb9e-9465-499e-96cf-75ec74d97abe",
      "name": "Hora Invalida_reprogramar",
      "webhookId": "89a3d27f-d5de-425c-8c71-1bdf700a711e",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "8720a747-a549-41da-a2b5-4b7a230b865d",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "=^([01]\\d|2[0-3]):[0-5]\\d$",
              "operator": {
                "type": "string",
                "operation": "regex"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        2000,
        18848
      ],
      "id": "f82e189a-80c6-482f-b0cd-3594386d6558",
      "name": "If_validar_formato_hora_actualizar"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "=Ups üòÖ la hora no tiene un formato v√°lido.\n\nRecuerda usar formato 24 horas:\nHH:MM\n\nEjemplo: 14:30\n\n9. Cancelar",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2224,
        18944
      ],
      "id": "c9b7a47f-32da-4b66-99f0-1d1a42d03e73",
      "name": "Hora Invalida_actualizar",
      "webhookId": "89a3d27f-d5de-425c-8c71-1bdf700a711e",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "=Ups üòÖ la fecha no tiene el formato correcto.\n\nRecuerda usar: YYYY-MM-DD\nEjemplo: 2025-12-20\n\n9. Cancelar",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2224,
        18368
      ],
      "id": "ae433a61-9ab0-4e06-a17f-65a14b69f951",
      "name": "Fecha Invalida_reprogramar",
      "webhookId": "032cae0e-0c44-46ea-ab8d-e61649d9bca9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "Hmm ü§î esa fecha ya pas√≥.\n\nPor favor ingresa una fecha futura.\n\nEjemplo: 2026-12-20\n\n9. Cancelar",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        18368
      ],
      "id": "da20cb02-f3a2-4d53-86bb-263b182c377e",
      "name": "Fecha en el pasado_reprogramar",
      "webhookId": "431e9db7-ea8c-443c-bb82-65fa90992bd9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "8720a747-a549-41da-a2b5-4b7a230b865d",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "=^\\d{4}-\\d{2}-\\d{2}$",
              "operator": {
                "type": "string",
                "operation": "regex"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        2000,
        18272
      ],
      "id": "32e17a93-bbb5-44a3-8cd0-9ed6c24d5328",
      "name": "If_validar_formato_fecha_reprogramar"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "2c064515-ed9d-4706-aafd-b6338a08fcdf",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "={{ $now.setZone('America/Bogota').toFormat('yyyy-MM-dd') }}",
              "operator": {
                "type": "dateTime",
                "operation": "afterOrEquals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        2224,
        18176
      ],
      "id": "69810e75-3d7a-4cf7-ac85-c510c380b673",
      "name": "If_fecha_v√°lida_reprogramar"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "pantalla_actual": "MENU_RECORDATORIOS",
            "paso_actual": "0"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        15968
      ],
      "id": "eb18e58d-4c43-4170-b69d-2dcbfec464f4",
      "name": "Actualizar_estado (MENU_RECORDATORIOS)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "={{ \"1\" }}",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "11f20b04-e6fd-4377-8a88-119ba53234a8"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "404735d4-b0ce-49f1-a877-311c79b0535f",
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "={{ \"2\" }}",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "e6b3ddff-3dca-4ac5-8876-6f0ee8bc8d1e",
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "={{ \"3\" }}",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        2000,
        21328
      ],
      "id": "47c01492-5481-47a1-af42-9d701290c217",
      "name": "Switch_menu_recordatorios"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "pantalla_actual": "REC_CAMBIAR_TIEMPO",
            "paso_actual": "0",
            "datos_parciales": "="
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        20960
      ],
      "id": "824fae65-7dd5-4197-bfe6-904f98cff2d9",
      "name": "Actualizar_estado (REC_CAMBIAR_TIEMPO)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $json[\"telegram_user\"] }}",
        "text": "=‚è±Ô∏è *Selecciona la antelaci√≥n:*\n\n¬øCu√°nto tiempo antes de la cita quieres recibir el mensaje?\n\n1. ‚ö° 30 Minutos antes\n2. üïê 1 Hora antes\n3. üìÖ 1 D√≠a antes (24h)\n4. üîô Cancelar",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        20960
      ],
      "id": "a7198f7c-d65a-400e-9064-90700eb52e5f",
      "name": "Mensaje_submenu_recordatorio",
      "webhookId": "21ceb000-bd6f-4287-8ed6-a0a8e7cef777",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "preferencia_aviso": "30"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "preferencia_aviso",
              "displayName": "preferencia_aviso",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "alertas_activas",
              "displayName": "alertas_activas",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        22112
      ],
      "id": "9d7df192-5802-40b2-bf52-e165ce2bf628",
      "name": "Cambiar_preferencia (30 min)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "pantalla_actual": "MENU_RECORDATORIOS",
            "paso_actual": "0",
            "datos_parciales": "="
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2672,
        22496
      ],
      "id": "d1492938-c3cc-4526-812b-e4daf8d9c531",
      "name": "Actualizar_estado_cancelaci√≥n (MENU_ADMIN)1",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "=üîî *Configuraci√≥n de Recordatorios*\n\nAqu√≠ decides cu√°ndo quieres que te avise de tus citas.\n\n‚öôÔ∏è *Tu configuraci√≥n actual:*\n‚Ä¢ Tiempo: {{ $node[\"verificar_sesi√≥n\"].json[\"preferencia_aviso\"] || 60 }} min antes.\n‚Ä¢ Estado: {{ $node[\"verificar_sesi√≥n\"].json[\"alertas_activas\"] == \"FALSE\" ? \"üîï Apagado\" : \"üîî Encendido\" }}\n\n1Ô∏è. Cambiar tiempo de aviso (30min / 1h / 1 d√≠a)\n2Ô∏è. Apagar/Encender notificaciones\n3Ô∏è. üîô Volver al men√∫ principal",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        15968
      ],
      "id": "55337e6c-b4e2-4330-aa19-9a691160a275",
      "name": "Mensaje_Menue_recordatorios",
      "webhookId": "53686d34-b4e3-4ec5-8047-9eba5a560364",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "=üîî *Configuraci√≥n de Recordatorios*\n\nAqu√≠ decides cu√°ndo quieres que te avise de tus citas.\n\n‚öôÔ∏è *Tu configuraci√≥n actual:*\n‚Ä¢ Tiempo: {{ $node[\"verificar_sesi√≥n\"].json[\"preferencia_aviso\"] || 60 }} min antes.\n‚Ä¢ Estado: {{ $node[\"verificar_sesi√≥n\"].json[\"alertas_activas\"] == \"FALSE\" ? \"üîï Apagado\" : \"üîî Encendido\" }}\n\n1Ô∏è. Cambiar tiempo de aviso (30min / 1h / 1 d√≠a)\n2Ô∏è. Apagar/Encender notificaciones\n3Ô∏è. üîô Volver al men√∫ principal",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2896,
        22496
      ],
      "id": "8754ad3f-f65e-46e5-a363-c5aa0ad4e6a5",
      "name": "Mensaje_Menu_recordatorios_volver",
      "webhookId": "53686d34-b4e3-4ec5-8047-9eba5a560364",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "={{ \"1\" }}",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "ee38d133-05be-48b9-900a-0e5b727d53db"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "d85c1447-d74f-4104-921b-d94884eb77e6",
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "={{ \"2\" }}",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "3bfb9a3f-a83b-4c67-8316-6833a0006b65",
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "={{ \"3\" }}",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "4d10898c-8f21-46e7-b20b-c09bf3312d41",
                    "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
                    "rightValue": "={{ \"4\" }}",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        2000,
        22464
      ],
      "id": "fc6bd5cb-2f3c-446e-ba04-c84ca2addd8b",
      "name": "Switch_preferencia_recordatorios"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "preferencia_aviso": "60"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "preferencia_aviso",
              "displayName": "preferencia_aviso",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "alertas_activas",
              "displayName": "alertas_activas",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        22304
      ],
      "id": "70a1dfd7-3749-4189-a1c1-fb459addd0e9",
      "name": "Cambiar_preferencia (1h)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "preferencia_aviso": "1440"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "preferencia_aviso",
              "displayName": "preferencia_aviso",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "alertas_activas",
              "displayName": "alertas_activas",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        22496
      ],
      "id": "c469e684-2c60-4ac7-8497-9cb2d02854d9",
      "name": "Cambiar_preferencia (1D)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "pantalla_actual": "MENU_RECORDATORIOS",
            "paso_actual": "0",
            "datos_parciales": "="
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        22688
      ],
      "id": "8df69230-b584-4577-b741-2169a50a7667",
      "name": "Actualizar_estado_cancelaci√≥n (MENU_ADMIN)3",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $node[\"Telegram Trigger1\"].json[\"message\"][\"chat\"][\"id\"] }}",
        "text": "=‚úÖ Configuraci√≥n actualizada",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        22496
      ],
      "id": "634d5555-2d41-4944-8e25-73323bfa6c7d",
      "name": "Mensaje_preferencia_cambiada",
      "webhookId": "e85291c3-1b7e-48ad-8b3b-5569eb31d4c9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "paso_actual": "0",
            "timestamp_ultima_interaccion": "={{$now}}",
            "alertas_activas": "={{ $node[\"verificar_sesi√≥n\"].json[\"alertas_activas\"] == \"TRUE\" ? \"FALSE\" : \"TRUE\" }}"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "preferencia_aviso",
              "displayName": "preferencia_aviso",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "alertas_activas",
              "displayName": "alertas_activas",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        21152
      ],
      "id": "738eb799-9315-4f64-bb50-36753e641a84",
      "name": "Cambiar_aviso",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $json[\"telegram_user\"] }}",
        "text": "=üîÑ *Cambio realizado*\n\nEl estado de tus notificaciones ha cambiado.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        21152
      ],
      "id": "2299c5b1-c4f9-4198-9ca6-a142a9d90a1a",
      "name": "Mensaje_cambiar_aviso",
      "webhookId": "21ceb000-bd6f-4287-8ed6-a0a8e7cef777",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "pantalla_actual": "MENU_PRINCIPAL",
            "datos_parciales": "={}"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "preferencia_aviso",
              "displayName": "preferencia_aviso",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "alertas_activas",
              "displayName": "alertas_activas",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        21536
      ],
      "id": "4bca9834-5ccb-4f5e-bfca-f9b390554122",
      "name": "Actualizar_estado_recordatorios (MENU_PRINCIPAL)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $node[\"Telegram Trigger1\"].json[\"message\"][\"chat\"][\"id\"] }}",
        "text": "=Hola, soy AgendaBot üëã\n\nEstoy aqu√≠ para ayudarte a organizar tus citas, tareas y recordatorios\nde forma sencilla y sin complicaciones.\n\nPuedes escribirme en cualquier momento.\nPara avanzar, solo tienes que escribir el n√∫mero de la opci√≥n que quieras usar.\n\nMen√∫ principal:\n0. Ayuda\n1. Agenda (citas)\n2. Tareas\n3. Recordatorios\n4. H√°bitos\n5. Listas\n6. Reportes\n7. Configuraci√≥n\n8. Administrador",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        21536
      ],
      "id": "f1a7a3f0-70cd-4304-ba60-7a43047325bc",
      "name": "Mensaje_volver_recordatorio_menu_principal",
      "webhookId": "e85291c3-1b7e-48ad-8b3b-5569eb31d4c9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "¬øEn qu√© te puedo ayudar hoy? üòä\n\nMen√∫ principal:\n0. Ayuda\n\n1. Agenda (citas)\n\n2. Tareas\n\n3. Recordatorios\n\n4. H√°bitos\n\n5. Listas\n\n6. Reportes\n\n7. Configuraci√≥n\n\n8. Administrador\n\nüí° Sugerencia:\nSi quieres empezar r√°pido, te recomiendo la opci√≥n 1 (Agenda).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2672,
        13080
      ],
      "id": "67450b17-998a-4dbc-973d-042368b22c62",
      "name": "Menu Principal3",
      "webhookId": "e85291c3-1b7e-48ad-8b3b-5569eb31d4c9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "=üîî *Configuraci√≥n de Recordatorios*\n\nAqu√≠ decides cu√°ndo quieres que te avise de tus citas.\n\n‚öôÔ∏è *Tu configuraci√≥n actual:*\n‚Ä¢ Tiempo: {{ $node[\"verificar_sesi√≥n\"].json[\"preferencia_aviso\"] || 60 }} min antes.\n‚Ä¢ Estado: {{ $node[\"verificar_sesi√≥n\"].json[\"alertas_activas\"] == \"FALSE\" ? \"üîï Apagado\" : \"üîî Encendido\" }}\n\n1Ô∏è. Cambiar tiempo de aviso (30min / 1h / 1 d√≠a)\n2Ô∏è. Apagar/Encender notificaciones\n3Ô∏è. üîô Volver al men√∫ principal",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2672,
        21152
      ],
      "id": "d0c64ad7-e337-4050-9664-7ce0f6eade59",
      "name": "Mensaje_Menu_recordatorios_aviso",
      "webhookId": "53686d34-b4e3-4ec5-8047-9eba5a560364",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "CITAS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=0"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "telegram_user",
              "lookupValue": "={{ $('Telegram Trigger1').item.json.message.chat.id }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        15776
      ],
      "id": "33077934-7755-4507-bbfd-b2e2e0cbffff",
      "name": "Obtener_citas_reportes",
      "alwaysOutputData": true,
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const citas = $input.all().map(item => item.json);\nconst ZONA_HORARIA = 'America/Bogota';\n\nif (citas.length === 0) {\n  return [{ json: { mensaje: \"üì≠ **Sin Historial**\\n\\nA√∫n no tienes citas registradas en nuestro sistema.\" } }];\n}\n\nlet total = citas.length;\nlet pendientes = 0;\nlet canceladas = 0;\nlet finalizadas = 0;\n\nconst listaPendientes = [];\nconst listaHistorial = [];\n\nconst ahora = DateTime.now().setZone(ZONA_HORARIA);\n\nfor (const c of citas) {\n  const estado = (c.estado || \"\").toLowerCase();\n  \n  let horaLimpia = c.hora ? c.hora.toString().trim() : \"00:00\";\n  if (horaLimpia.indexOf(':') === 1) horaLimpia = \"0\" + horaLimpia;\n  const fechaIso = `${c.fecha}T${horaLimpia}:00`;\n  const fechaObj = DateTime.fromISO(fechaIso, { zone: ZONA_HORARIA });\n\n  if (estado.includes('cancel')) {\n    canceladas++;\n  } else if (fechaObj.isValid && fechaObj > ahora && estado !== 'finalizada') {\n    pendientes++;\n    listaPendientes.push({ fecha: c.fecha, hora: c.hora, obj: fechaObj });\n  } else {\n    finalizadas++;\n    listaHistorial.push({ fecha: c.fecha, hora: c.hora, estado: c.estado, obj: fechaObj });\n  }\n}\n\nlistaPendientes.sort((a, b) => a.obj - b.obj);\n\nlistaHistorial.sort((a, b) => b.obj - a.obj);\n\nlet msg = `üìä **TU REPORTE DE ACTIVIDAD**\\n`;\nmsg += `-----------------------------\\n`;\nmsg += `üìÖ Total Citas: **${total}**\\n`;\nmsg += `‚úÖ Asistidas/Pasadas: **${finalizadas}**\\n`;\nmsg += `‚è≥ Pendientes: **${pendientes}**\\n`;\nmsg += `üö´ Canceladas: **${canceladas}**\\n\\n`;\n\nif (listaPendientes.length > 0) {\n  const proxima = listaPendientes[0];\n  msg += `üöÄ **Tu Pr√≥xima Cita:**\\n`;\n  msg += `üóì ${proxima.fecha} a las ${proxima.hora}\\n\\n`;\n}\n\nif (listaHistorial.length > 0) {\n  msg += `üìú **Historial Reciente:**\\n`;\n  for (let i = 0; i < Math.min(3, listaHistorial.length); i++) {\n    const h = listaHistorial[i];\n    msg += `‚Ä¢ ${h.fecha} - ${h.estado || 'Finalizada'}\\n`;\n  }\n} else {\n    msg += `üìú **Historial:** A√∫n no tienes citas pasadas.`;\n}\n\nreturn [{ json: { mensaje: msg } }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2448,
        15776
      ],
      "id": "64023524-81ce-4d63-9b61-c723546dfb57",
      "name": "Procesar_reporte"
    },
    {
      "parameters": {
        "chatId": "={{ $node[\"Telegram Trigger1\"].json[\"message\"][\"chat\"]['id'] }}",
        "text": "={{ $json[\"mensaje\"] }}",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2672,
        15776
      ],
      "id": "45b040e6-df47-4574-812f-6582c5969fd7",
      "name": "Mensaje_reporte",
      "webhookId": "e85291c3-1b7e-48ad-8b3b-5569eb31d4c9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $node[\"Telegram Trigger1\"].json[\"message\"][\"chat\"]['id'] }}",
        "text": "=Men√∫ principal:\n0. Ayuda\n\n1. Agenda (citas)\n\n2. Tareas\n\n3. Recordatorios\n\n4. H√°bitos\n\n5. Listas\n\n6. Reportes\n\n7. Configuraci√≥n\n\n8. Administrador\n\nüí° Sugerencia:\nSi quieres empezar r√°pido, te recomiendo la opci√≥n 1 (Agenda).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2896,
        15776
      ],
      "id": "14e65f3d-7db1-4b37-9f9a-1247a14f9dd8",
      "name": "Menu Principal4",
      "webhookId": "e85291c3-1b7e-48ad-8b3b-5569eb31d4c9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog",
          "mode": "list",
          "cachedResultName": "Agenda_bot_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1301766078,
          "mode": "list",
          "cachedResultName": "SESSIONS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lbVT2-3mihfAwOVcJHO2MWlbExKG3T3PULHCbHlEFog/edit#gid=1301766078"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "telegram_user": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "pantalla_actual": "MENU_PRINCIPAL",
            "paso_actual": "",
            "datos_parciales": "={}"
          },
          "matchingColumns": [
            "telegram_user"
          ],
          "schema": [
            {
              "id": "telegram_user",
              "displayName": "telegram_user",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "pantalla_actual",
              "displayName": "pantalla_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "paso_actual",
              "displayName": "paso_actual",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "datos_parciales",
              "displayName": "datos_parciales",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "timestamp_ultima_interaccion",
              "displayName": "timestamp_ultima_interaccion",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        24224
      ],
      "id": "fa75e2d8-9af7-4afe-8ab9-60aedf41c953",
      "name": "Actualizar_estado_regreso (MENU_PRINCIPAL)",
      "credentials": {
        "googleApi": {
          "id": "hGSQSmHO3j7zYLyG",
          "name": "Google Service Account account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "MENU_PRINCIPAL",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "f3f4f434-051e-44c0-8efc-a4999d4e9480"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "2b381b4c-36e3-43b7-a1e6-85fdc2cab3f7",
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "AGENDAR",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "4bc74d3f-e04d-4ba8-9ea2-b5c552e58045",
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "VER_TAREAS",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "c2c1da07-4dec-40ba-b975-8136a3d1716c",
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "MENU_CITAS",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "5fe7b320-8cd9-4a51-a352-8e9597ae88d6",
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "CONFIRMACION_CITA",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "3036d160-6de1-42bf-9fab-2ec09275ba88",
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "MENU_EDITAR",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "2b4b63cb-c605-4e31-928f-9c2ac0eb4bda",
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "EDITAR_FECHA",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "f402180b-d94f-4ccf-944b-b7ed7af32094",
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "EDITAR_NOMBRE",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "0bc45694-e9b0-47bf-977f-0f96875fe1d7",
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "EDITAR_HORA",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "2d3b638b-f9f4-4afc-8cc9-4bc37c907729",
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "EDITAR_MOTIVO",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "6cd9ea69-7844-440c-80c2-410ae0acf72a",
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "EDITAR_CANAL",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "00ceec0c-d319-4ab9-8370-44251b5c6d05",
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "REPROGRAMAR_ESPERAR_ID",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "3f79320d-4e00-4702-b9a4-2dd5cc8918e8",
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "REPROGRAMAR_FECHA",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "82494dc6-c6e0-41cc-a649-5cb6ac55d6eb",
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "REPROGRAMAR_HORA",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "dd1ab552-b179-421e-8dc1-2c21d6d7927e",
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "CANCELAR_ESPERAR_ID",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "9b801476-b0c3-4ad0-8adc-a6614f99e7dc",
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "COMPLETAR_ESPERAR_ID",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "b677689b-5a9f-4903-82c3-7df31b4d1481",
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "MENU_CONFIGURACION",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "11e32e75-854d-49ed-b1d7-0c4514db52b9",
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "MENU_ADMIN",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "498d9634-699d-49e5-b15f-765b8b30cb99",
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "ADMIN_BROADCAST",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "945cbe81-f3ed-4902-aa28-6f16a3c87e20",
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "ADMIN_BROADCAST_CONFIRMAR",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "3f69b34a-8995-42af-9e55-2e381ba4add1",
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "MENU_RECORDATORIOS",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "c9971cec-3f0a-45d9-a4f8-81bd234b5997",
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "REC_CAMBIAR_TIEMPO",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "853c6c63-8af7-4cc7-a5ad-82a3925d3d97",
                    "leftValue": "={{ $json.pantalla_actual }}",
                    "rightValue": "VERIFICACION",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {
          "fallbackOutput": "extra"
        }
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        1776,
        20032
      ],
      "id": "e6843875-2f7e-43a9-8cf3-23e69c3cbc46",
      "name": "CEREBRO_PRINCIPAL1"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "Hmm ü§î esa fecha ya pas√≥.\n\nPor favor ingresa una fecha futura.\n\nEjemplo: 2026-12-20\n\n9. Cancelar",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2896,
        13368
      ],
      "id": "7d6ccaf0-262b-4cb5-9e57-82d4f4a7cfb0",
      "name": "Fecha en el pasado1",
      "webhookId": "431e9db7-ea8c-443c-bb82-65fa90992bd9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "=Ups üòÖ la fecha no tiene el formato correcto.\n\nRecuerda usar: YYYY-MM-DD\nEjemplo: 2025-12-20\n\n9. Cancelar",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2672,
        13464
      ],
      "id": "3304fa32-ecf3-4166-80df-bfabd5684f74",
      "name": "Fecha Invalida2",
      "webhookId": "032cae0e-0c44-46ea-ab8d-e61649d9bca9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "=Ups, esa opci√≥n no existe en este men√∫ üòÖ\n\nPor favor escribe uno de los n√∫meros que ves en pantalla.\n\nEst√°s en: {{ $json.pantalla_actual }}\nOpciones disponibles: 0 al 8\n\nüëâ Tip: escribe solo el n√∫mero (por ejemplo: 1).",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2000,
        24408
      ],
      "id": "55a02e76-a2c4-4616-b9ac-4db3f0159da6",
      "name": "Opci√≥n No Valida1",
      "webhookId": "e85291c3-1b7e-48ad-8b3b-5569eb31d4c9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "Hola, soy AgendaBot üëã\n\nEstoy aqu√≠ para ayudarte a organizar tus citas, tareas y recordatorios\nde forma sencilla y sin complicaciones.\n\nPuedes escribirme en cualquier momento.\nPara avanzar, solo tienes que escribir el n√∫mero de la opci√≥n que quieras usar.\n\nMen√∫ principal:\n0. Ayuda\n\n1. Agenda (citas)\n\n2. Tareas\n\n3. Recordatorios\n\n4. H√°bitos\n\n5. Listas\n\n6. Reportes\n\n7. Configuraci√≥n\n\n8. Administrador\n\nTip r√°pido:\nescribe solo el n√∫mero (por ejemplo: 1) y presiona enviar.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2448,
        15200
      ],
      "id": "5c96fc24-e421-4905-bee7-58bb6497d8f5",
      "name": "Bienvenida1",
      "webhookId": "e85291c3-1b7e-48ad-8b3b-5569eb31d4c9",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "\nlet mensaje = \"üìÖ *Tu Agenda Actual:*\\n\\n\";\n\nfor (let i = 0; i < items.length; i++) {\n  const cita = items[i].json;\n  \n  // 3. Construimos el bloque de texto para cada cita\n  mensaje += `*${i + 1}.* üóì ${cita.fecha || \"Sin fecha\"} - ‚è∞ ${cita.hora || \"Sin hora\"}\\n`;\n  mensaje += `    üë§ Nombre: ${cita.nombre}\\n`;\n  mensaje += `    üìù Motivo: ${cita.motivo}\\n`;\n  mensaje += `    üîπ Estado: \\`${cita.estado}\\`\\n`; \n  mensaje += `    üÜî ID: \\`${cita.id_cita}\\`\\n`;\n  mensaje += `    -------------------------\\n`;\n}\n\nmensaje += \"\\n¬øQu√© deseas hacer ahora? (Elige una opci√≥n del men√∫ anterior)\";\n\nreturn [{ json: { texto_final: mensaje } }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2672,
        25760
      ],
      "id": "5b511127-f43a-4348-800f-43c5444f6cba",
      "name": "Code in JavaScript2"
    },
    {
      "parameters": {
        "jsCode": "// 1. Traemos todas las citas\nconst citas = $input.all();\n\nlet fechaDeseada = \"\";\nlet horaDeseada = \"\";\n\ntry {\n    // Obtenemos los datos del usuario\n    fechaDeseada = JSON.parse($items(\"verificar_sesi√≥n\")[0].json[\"datos_parciales\"]).fecha;\n    horaDeseada = $items(\"Telegram Trigger1\")[0].json[\"message\"][\"text\"];\n} catch (e) { }\n\n// FUNCI√ìN DE AYUDA: Limpia la hora para quedarse solo con HH:MM\n// Convierte \"14:30:00\" -> \"14:30\" y \"14:30\" -> \"14:30\"\nconst limpiarHora = (h) => {\n    if (!h) return \"\";\n    return h.toString().trim().substring(0, 5); // Toma solo los primeros 5 caracteres\n};\n\n// 2. Buscamos conflictos usando la hora limpia\nconst conflictos = citas.filter(item => {\n    const c = item.json;\n    \n    // Normalizamos las horas antes de comparar\n    const horaSheet = limpiarHora(c.hora);\n    const horaUser = limpiarHora(horaDeseada);\n\n    // LOGICA DE COLISI√ìN:\n    // - Misma Fecha\n    // - Misma Hora (ignorando segundos)\n    // - Estado NO es 'Cancelada' (Ocupado si es Pendiente, Completada, etc.)\n    return c.fecha == fechaDeseada && \n           horaSheet == horaUser && \n           c.estado != 'Cancelada';\n});\n\n// 3. Devolvemos el resultado\nreturn [{\n    json: {\n        conflictCount: conflictos.length,\n        debug: `Compar√© ${fechaDeseada} ${limpiarHora(horaDeseada)} con ${citas.length} citas.` // Info extra para ti\n    }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2896,
        13656
      ],
      "id": "be9526a4-d59f-4fdd-ae51-0721cbda8309",
      "name": "Code in JavaScript3"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "2c064515-ed9d-4706-aafd-b6338a08fcdf",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "={{ $now.setZone('America/Bogota').toFormat('yyyy-MM-dd') }}",
              "operator": {
                "type": "dateTime",
                "operation": "afterOrEquals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        2672,
        13272
      ],
      "id": "cbec2ebe-e737-4637-bab1-f4fcea7a3d6a",
      "name": "If1"
    },
    {
      "parameters": {
        "mode": "raw",
        "jsonOutput": "={\n  \"timestamp\": {{$now}},\n  \"telegram_user\": {{ $json.telegram_user }},\n  \"pantalla\": {{ $json.pantalla_actual }},\n  \"opcion_elegida\": {{ $('Telegram Trigger1').item.json.message.text }},\n  \"resultado\": {{ \"opcion \" +  $('Telegram Trigger1').item.json.message.text + \" del menu \" +$('verificar_sesi√≥n').item.json.pantalla_actual + \" ejecutada correctamente\"}}\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2224,
        23264
      ],
      "id": "e0fb0799-39b6-4a9e-aabe-4df99c62864f",
      "name": "Edit To Log4"
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "value": "QMKXdvzOL7ZZR0EF",
          "mode": "list",
          "cachedResultName": "My Sub-Workflow 2",
          "cachedResultUrl": "/workflow/QMKXdvzOL7ZZR0EF"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {},
          "matchingColumns": [],
          "schema": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": true
        },
        "mode": "each",
        "options": {}
      },
      "type": "n8n-nodes-base.executeWorkflow",
      "typeVersion": 1.3,
      "position": [
        2448,
        23264
      ],
      "id": "6aea7733-e4ae-4dbb-8284-5460e5bdf3ed",
      "name": "Call 'My Sub-Workflow 2'4"
    },
    {
      "parameters": {
        "mode": "raw",
        "jsonOutput": "={\n  \"timestamp\": {{$now}},\n  \"telegram_user\": {{ $json.telegram_user }},\n  \"pantalla\": {{ $json.pantalla_actual }},\n  \"opcion_elegida\": {{ $('Telegram Trigger1').item.json.message.text }},\n  \"resultado\": {{ \"opcion \" +  $('Telegram Trigger1').item.json.message.text + \" del menu \" +$('verificar_sesi√≥n').item.json.pantalla_actual + \" ejecutada correctamente\"}}\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2224,
        21344
      ],
      "id": "c2a6d5a9-5354-4645-ae4d-c0f24ce055c5",
      "name": "Edit To Log5"
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "value": "QMKXdvzOL7ZZR0EF",
          "mode": "list",
          "cachedResultName": "My Sub-Workflow 2",
          "cachedResultUrl": "/workflow/QMKXdvzOL7ZZR0EF"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {},
          "matchingColumns": [],
          "schema": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": true
        },
        "mode": "each",
        "options": {}
      },
      "type": "n8n-nodes-base.executeWorkflow",
      "typeVersion": 1.3,
      "position": [
        2448,
        21344
      ],
      "id": "8fc5bd32-227b-44c2-876f-da9617d05f44",
      "name": "Call 'My Sub-Workflow 2'5"
    },
    {
      "parameters": {
        "mode": "raw",
        "jsonOutput": "={\n  \"timestamp\": {{$now}},\n  \"telegram_user\": {{ $json.telegram_user }},\n  \"pantalla\": {{ $json.pantalla_actual }},\n  \"opcion_elegida\": {{ $('Telegram Trigger1').item.json.message.text }},\n  \"resultado\": {{ \"opcion \" +  $('Telegram Trigger1').item.json.message.text + \" del menu \" +$('verificar_sesi√≥n').item.json.pantalla_actual + \" ejecutada correctamente\"}}\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2224,
        16160
      ],
      "id": "03e8ba02-faf3-43a4-b25f-979b4e489c7c",
      "name": "Edit To Log6"
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "value": "QMKXdvzOL7ZZR0EF",
          "mode": "list",
          "cachedResultName": "My Sub-Workflow 2",
          "cachedResultUrl": "/workflow/QMKXdvzOL7ZZR0EF"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {},
          "matchingColumns": [],
          "schema": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": true
        },
        "mode": "each",
        "options": {}
      },
      "type": "n8n-nodes-base.executeWorkflow",
      "typeVersion": 1.3,
      "position": [
        2448,
        16160
      ],
      "id": "3862967f-9456-400a-96e3-f7dfa09bd1a8",
      "name": "Call 'My Sub-Workflow 2'6"
    },
    {
      "parameters": {
        "mode": "raw",
        "jsonOutput": "={\n  \"timestamp\": {{$now}},\n  \"telegram_user\": {{ $json.telegram_user }},\n  \"pantalla\": {{ $json.pantalla_actual }},\n  \"opcion_elegida\": {{ $('Telegram Trigger1').item.json.message.text }},\n  \"resultado\": {{ \"opcion \" +  $('Telegram Trigger1').item.json.message.text + \" del menu \" +$('verificar_sesi√≥n').item.json.pantalla_actual + \" ejecutada correctamente\"}}\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2224,
        27488
      ],
      "id": "d515555f-f88d-44f4-8961-646f3049c3c2",
      "name": "Edit To Log7"
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "value": "QMKXdvzOL7ZZR0EF",
          "mode": "list",
          "cachedResultName": "My Sub-Workflow 2",
          "cachedResultUrl": "/workflow/QMKXdvzOL7ZZR0EF"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {},
          "matchingColumns": [],
          "schema": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": true
        },
        "mode": "each",
        "options": {}
      },
      "type": "n8n-nodes-base.executeWorkflow",
      "typeVersion": 1.3,
      "position": [
        2448,
        27488
      ],
      "id": "e5352bfb-456c-4ea6-90e9-f5e48fa7fe73",
      "name": "Call 'My Sub-Workflow 2'7"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
        "text": "=Al parecer no elegiste correctamente, elige las opciones del 1 al 3 unicamente para continuar con la agendaci√≥n de la cita.",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2224,
        24992
      ],
      "id": "b15344b8-8ebc-4f7c-b4d4-b9080f1aa814",
      "name": "Mensaje_elecci√≥n_incorrecta_editar",
      "webhookId": "53686d34-b4e3-4ec5-8047-9eba5a560364",
      "credentials": {
        "telegramApi": {
          "id": "9O34GtDHCzgXdfGS",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 3
          },
          "conditions": [
            {
              "id": "b017c2c5-0b9c-4443-8e51-5dd620bc6acc",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "2",
              "operator": {
                "type": "string",
                "operation": "notEquals"
              }
            },
            {
              "id": "03d3e139-dcff-4110-af25-5b9ff2019dc0",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "4",
              "operator": {
                "type": "string",
                "operation": "notEquals"
              }
            },
            {
              "id": "2090b930-34f1-4d89-a19a-87ff2ba65345",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "0",
              "operator": {
                "type": "string",
                "operation": "notEquals"
              }
            },
            {
              "id": "e7f67aa4-af4b-4fdc-9c9b-40e35ecae011",
              "leftValue": "={{ $('Telegram Trigger1').item.json.message.text }}",
              "rightValue": "5",
              "operator": {
                "type": "string",
                "operation": "notEquals"
              }
            }
          ],
          "combinator": "and"
        },
        "looseTypeValidation": true,
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        2224,
        16544
      ],
      "id": "d817eaf5-1d6f-41db-8745-311d74685b2c",
      "name": "IF NO MENU ARRIBA"
    }
  ],
  "pinData": {},
  "connections": {
    "verificar_usuario": {
      "main": [
        [
          {
            "node": "IF_usuario_existe",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Telegram Trigger1": {
      "main": [
        [
          {
            "node": "verificar_usuario",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "verificar_sesi√≥n": {
      "main": [
        [
          {
            "node": "IF_sesion_iniciada",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF_usuario_existe": {
      "main": [
        [
          {
            "node": "verificar_sesi√≥n",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Crear Usuario",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF_sesion_iniciada": {
      "main": [
        [
          {
            "node": "Append_session",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "CEREBRO_PRINCIPAL",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append_session": {
      "main": [
        [
          {
            "node": "CEREBRO_PRINCIPAL",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "CEREBRO_PRINCIPAL": {
      "main": [
        [
          {
            "node": "IF_ayuda",
            "type": "main",
            "index": 0
          },
          {
            "node": "IF_habitos",
            "type": "main",
            "index": 0
          },
          {
            "node": "IF_tarea",
            "type": "main",
            "index": 0
          },
          {
            "node": "IF_Listas",
            "type": "main",
            "index": 0
          },
          {
            "node": "CEREBRO_PRINCIPAL1",
            "type": "main",
            "index": 0
          }
        ],
        [],
        [],
        [
          {
            "node": "IF_menu_ayuda_opcion_1",
            "type": "main",
            "index": 0
          },
          {
            "node": "IF_menu_ayuda_opcion_2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "IF_menu_tareas_opcion_1",
            "type": "main",
            "index": 0
          },
          {
            "node": "IF_menu_tareas_opcion_2",
            "type": "main",
            "index": 0
          },
          {
            "node": "IF_menu_tareas_opcion_3",
            "type": "main",
            "index": 0
          },
          {
            "node": "IF_menu_tareas_opcion_4",
            "type": "main",
            "index": 0
          },
          {
            "node": "IF_menu_tareas_opcion_no_valida",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "IF no cancelar crear tarea?",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "IF_menu_habitos_opcion_1",
            "type": "main",
            "index": 0
          },
          {
            "node": "IF_menu_habitos_opcion_2",
            "type": "main",
            "index": 0
          },
          {
            "node": "IF_menu_habitos_opcion_3",
            "type": "main",
            "index": 0
          },
          {
            "node": "IF_menu_habitos_opcion_4",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Update row Marcar Tarea Completada",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Bienvenida",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Get row(s) in sheet2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "IF no cancelar crear habito?",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "IF_menu_listas_opcion_1",
            "type": "main",
            "index": 0
          },
          {
            "node": "IF_menu_listas_opcion_2",
            "type": "main",
            "index": 0
          },
          {
            "node": "IF_menu_listas_opcion_3",
            "type": "main",
            "index": 0
          },
          {
            "node": "IF_menu_listas_opcion_4",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "IF no cancelar crear lista?",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Get Lista por ID",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "IF no cancelar crear lista?1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "CEREBRO_PRINCIPAL1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF_ayuda": {
      "main": [
        [
          {
            "node": "Men√∫ Ayuda",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF_tarea": {
      "main": [
        [
          {
            "node": "Men√∫ Tareas",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF_habitos": {
      "main": [
        [
          {
            "node": "Men√∫ Habitos",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF_menu_ayuda_opcion_1": {
      "main": [
        [
          {
            "node": "Menu Principal_",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit To Log3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF_menu_ayuda_opcion_2": {
      "main": [
        [
          {
            "node": "Mensaje de Salida",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit To Log3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Men√∫ Ayuda": {
      "main": [
        [
          {
            "node": "Update State MENU_AYUDA",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Menu Principal_": {
      "main": [
        [
          {
            "node": "Update State MENU_PRINCIPAL",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Mensaje de Salida": {
      "main": [
        [
          {
            "node": "Update State BIENVENIDA",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Men√∫ Tareas": {
      "main": [
        [
          {
            "node": "Update State MENU_TAREAS",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF_menu_tareas_opcion_1": {
      "main": [
        [
          {
            "node": "Crear Tarea Paso 1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit To Log2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Crear Tarea Paso 1": {
      "main": [
        [
          {
            "node": "Update State CREAR TAREA - PASO 1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Pasos Tareas": {
      "main": [
        [
          {
            "node": "Update DATOS PARCIALES TITULO",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Switch1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Fecha Formato Valido?",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Confirmar tarea?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Crear Tarea Paso 2": {
      "main": [
        [
          {
            "node": "Update State CREAR HABITO- PASO 2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Crear Tarea Paso 3": {
      "main": [
        [
          {
            "node": "Update State CREAR TAREA - PASO 3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update DATOS PARCIALES TITULO": {
      "main": [
        [
          {
            "node": "Crear Tarea Paso 2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch1": {
      "main": [
        [
          {
            "node": "PARSE AND ADD PRIORIDAD ALTA",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "PARSE AND ADD PRIORIDAD MEDIA",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "PARSE AND ADD PRIORIDAD BAJA",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "TEXTO CANCELACION TAREA",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "PARSE AND ADD PRIORIDAD ALTA": {
      "main": [
        [
          {
            "node": "Update DATOS PARCIALES PRIORIDAD",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "PARSE AND ADD PRIORIDAD MEDIA": {
      "main": [
        [
          {
            "node": "Update DATOS PARCIALES PRIORIDAD",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "PARSE AND ADD PRIORIDAD BAJA": {
      "main": [
        [
          {
            "node": "Update DATOS PARCIALES PRIORIDAD",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Men√∫ Tareas1": {
      "main": [
        [
          {
            "node": "Update State MENU_TAREAS1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "TEXTO CANCELACION TAREA": {
      "main": [
        [
          {
            "node": "Men√∫ Tareas1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Men√∫ Habitos": {
      "main": [
        [
          {
            "node": "Update State MENU_HABITOS",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Fecha Formato Valido?": {
      "main": [
        [
          {
            "node": "Fecha Futura?",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Fecha Invalida",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Fecha Futura?": {
      "main": [
        [
          {
            "node": "PARSE AND ADD FECHA OBJETIVO",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Fecha en el pasado",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "PARSE AND ADD FECHA OBJETIVO": {
      "main": [
        [
          {
            "node": "Update DATOS PARCIALES E1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update DATOS PARCIALES E1": {
      "main": [
        [
          {
            "node": "Crear Tarea PASO 3 Confirmaci√≥n",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update DATOS PARCIALES PRIORIDAD": {
      "main": [
        [
          {
            "node": "Crear Tarea Paso 3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Crear Tarea PASO 3 Confirmaci√≥n": {
      "main": [
        [
          {
            "node": "Update State CREAR TAREA - PASO 4  ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Confirmar tarea?": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Cancelado Creaci√≥n Tarea Texto",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet": {
      "main": [
        [
          {
            "node": "Crypto",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Crypto": {
      "main": [
        [
          {
            "node": "Append TAREA",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append TAREA": {
      "main": [
        [
          {
            "node": "Tarea Guardada Correctamente",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF_menu_tareas_opcion_2": {
      "main": [
        [
          {
            "node": "Get row(s) Traer Tareas",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit To Log2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items": {
      "main": [
        [
          {
            "node": "Men√∫ Tareas5",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Mostrar Tarea Mensaje",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Mostrar Tarea Mensaje": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Cancelado Creaci√≥n Tarea Texto": {
      "main": [
        [
          {
            "node": "Men√∫ Tareas2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Men√∫ Tareas2": {
      "main": [
        [
          {
            "node": "Update State MENU_TAREAS2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Cancelado Creaci√≥n Tarea Texto1": {
      "main": [
        [
          {
            "node": "Men√∫ Tareas4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Men√∫ Tareas4": {
      "main": [
        [
          {
            "node": "Update State MENU_TAREAS4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Menu Principal_1": {
      "main": [
        [
          {
            "node": "Update State MENU_PRINCIPAL1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF_menu_tareas_opcion_4": {
      "main": [
        [
          {
            "node": "Menu Principal_1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit To Log2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items1": {
      "main": [
        [
          {
            "node": "Pedir ID Tarea para completar",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Mostrar Tarea Mensaje1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Mostrar Tarea Mensaje1": {
      "main": [
        [
          {
            "node": "Loop Over Items1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF_menu_tareas_opcion_3": {
      "main": [
        [
          {
            "node": "Get row(s) Traer Tareas No Completadas2",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit To Log2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Pedir ID Tarea para completar": {
      "main": [
        [
          {
            "node": "Update State COMPLETAR TAREA - PASO 1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Men√∫ Tareas5": {
      "main": [
        [
          {
            "node": "Update State MENU_TAREAS5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row Marcar Tarea Completada": {
      "main": [
        [
          {
            "node": "Se actualizo correcto?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Se actualizo correcto?": {
      "main": [
        [
          {
            "node": "TAREA ACTUALIZADA TEXTO",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "VOLVIENDO MENU TAREAS TEXTO",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Men√∫ Tareas6": {
      "main": [
        [
          {
            "node": "Update State MENU_TAREAS6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "VOLVIENDO MENU TAREAS TEXTO": {
      "main": [
        [
          {
            "node": "Men√∫ Tareas6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Crear Usuario": {
      "main": [
        [
          {
            "node": "IF_sesion_iniciada",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Bienvenida": {
      "main": [
        [
          {
            "node": "Update State MENU_PRINCIPAL2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "TAREA ACTUALIZADA TEXTO": {
      "main": [
        [
          {
            "node": "Men√∫ Tareas6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF_menu_tareas_opcion_no_valida": {
      "main": [
        [
          {
            "node": "Opci√≥n No Valida",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Opci√≥n No Valida": {
      "main": [
        [
          {
            "node": "Men√∫ Tareas7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF_menu_habitos_opcion_1": {
      "main": [
        [
          {
            "node": "CREAR HABITO PASO 1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit To Log",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "CREAR HABITO PASO 1": {
      "main": [
        [
          {
            "node": "Update State CREAR HABITO - PASO 1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF no cancelar crear tarea?": {
      "main": [
        [
          {
            "node": "Pasos Tareas",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Cancelado Creaci√≥n Tarea Texto1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF no cancelar crear habito?": {
      "main": [
        [
          {
            "node": "Pasos Habitos",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Cancelado Creaci√≥n Habito",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Cancelado Creaci√≥n Habito": {
      "main": [
        [
          {
            "node": "Men√∫ Habitos1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Men√∫ Habitos1": {
      "main": [
        [
          {
            "node": "Update State MENU_HABITOS1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Pasos Habitos": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Switch2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Fecha Formato Valido?1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Get row(s) in sheet3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update DATOS PARCIALES Nombre HABITO": {
      "main": [
        [
          {
            "node": "Crear Habito Paso 2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch2": {
      "main": [
        [
          {
            "node": "PARSE AND ADD PRIORIDAD ALTA1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "PARSE AND ADD PRIORIDAD MEDIA1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "PARSE AND ADD PRIORIDAD BAJA1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "PARSE AND ADD PRIORIDAD ALTA1": {
      "main": [
        [
          {
            "node": "Update DATOS PARCIALES FRECUENCIA Crear Habito",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "PARSE AND ADD PRIORIDAD MEDIA1": {
      "main": [
        [
          {
            "node": "Update DATOS PARCIALES FRECUENCIA Crear Habito",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "PARSE AND ADD PRIORIDAD BAJA1": {
      "main": [
        [
          {
            "node": "Update DATOS PARCIALES FRECUENCIA Crear Habito",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF_menu_habitos_opcion_2": {
      "main": [
        [
          {
            "node": "Get row(s) Traer Habitos",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit To Log",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update DATOS PARCIALES FRECUENCIA Crear Habito": {
      "main": [
        [
          {
            "node": "Crear Habito Paso 3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Crear Habito Paso 3": {
      "main": [
        [
          {
            "node": "Update State CREAR HABITO - PASO 3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Crear Habito Paso 2": {
      "main": [
        [
          {
            "node": "Update State CREAR HABITO - PASO 2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Fecha Formato Valido?1": {
      "main": [
        [
          {
            "node": "PARSE AND ADD Hora Recordatorio Habito",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Fecha Invalida1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "PARSE AND ADD Hora Recordatorio Habito": {
      "main": [
        [
          {
            "node": "Update DATOS PARCIALES HORA Crear Habito",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update DATOS PARCIALES HORA Crear Habito": {
      "main": [
        [
          {
            "node": "Crear Habito PASO 3 Confirmaci√≥n1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Crear Habito PASO 3 Confirmaci√≥n1": {
      "main": [
        [
          {
            "node": "Update State CREAR TAREA - PASO 4  1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Men√∫ Habitos2": {
      "main": [
        [
          {
            "node": "Update State MENU_HABITOS2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet3": {
      "main": [
        [
          {
            "node": "Crypto1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Crypto1": {
      "main": [
        [
          {
            "node": "Append HABITO",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append HABITO": {
      "main": [
        [
          {
            "node": "Habito Guardado Correctamente",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Habito Guardado Correctamente": {
      "main": [
        [
          {
            "node": "Men√∫ Habitos2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Menu Principal_2": {
      "main": [
        [
          {
            "node": "Update State MENU_PRINCIPAL3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF_menu_habitos_opcion_4": {
      "main": [
        [
          {
            "node": "Menu Principal_2",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit To Log",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) Traer Tareas": {
      "main": [
        [
          {
            "node": "HAY TAREAS",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) Traer Tareas No Completadas2": {
      "main": [
        [
          {
            "node": "HAY TAREAS1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items2": {
      "main": [
        [
          {
            "node": "Men√∫ Habitos3",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Mostrar Habitos Mensaje2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) Traer Habitos": {
      "main": [
        [
          {
            "node": "IF TIENE HABITOS?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Men√∫ Habitos3": {
      "main": [
        [
          {
            "node": "Update State MENU_HABITOS3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items3": {
      "main": [
        [
          {
            "node": "Pedir ID Habito para Toogle",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Mostrar Tarea Mensaje3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Mostrar Tarea Mensaje3": {
      "main": [
        [
          {
            "node": "Loop Over Items3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF_menu_habitos_opcion_3": {
      "main": [
        [
          {
            "node": "Get row(s) Traer Habitos1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit To Log",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) Traer Habitos1": {
      "main": [
        [
          {
            "node": "IF TIENE HABITOS?1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Pedir ID Habito para Toogle": {
      "main": [
        [
          {
            "node": "Update State COMPLETAR TAREA - PASO ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Se actualizo correcto?1": {
      "main": [
        [
          {
            "node": "HABITO ACTUALIZADA TEXTO1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "VOLVIENDO MENU TAREAS TEXTO1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "VOLVIENDO MENU TAREAS TEXTO1": {
      "main": [
        [
          {
            "node": "Men√∫ Habitos4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet2": {
      "main": [
        [
          {
            "node": "Update row Marcar Habito Activado / Desactivado",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row Marcar Habito Activado / Desactivado": {
      "main": [
        [
          {
            "node": "Se actualizo correcto?1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HABITO ACTUALIZADA TEXTO1": {
      "main": [
        [
          {
            "node": "Men√∫ Habitos4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Men√∫ Habitos4": {
      "main": [
        [
          {
            "node": "Update State MENU_HABITOS4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "Update DATOS PARCIALES Nombre HABITO",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Invalido NOMBRE HABITO VACIO",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF TIENE HABITOS?": {
      "main": [
        [
          {
            "node": "Loop Over Items2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "NO TIENE HABITOS",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF TIENE HABITOS?1": {
      "main": [
        [
          {
            "node": "Loop Over Items3",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "NO TIENE HABITOS",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Men√∫ Habitos5": {
      "main": [
        [
          {
            "node": "Update State MENU_HABITOS5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "NO TIENE HABITOS": {
      "main": [
        [
          {
            "node": "Men√∫ Habitos5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF_Listas": {
      "main": [
        [
          {
            "node": "Men√∫ Listas",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Men√∫ Listas": {
      "main": [
        [
          {
            "node": "Update State MENU_LISTAS",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF_menu_listas_opcion_1": {
      "main": [
        [
          {
            "node": "Crear Lista Paso 1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit To Log1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Crear Lista Paso 1": {
      "main": [
        [
          {
            "node": "Update State CREAR LISTAS - PASO 1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF no cancelar crear lista?": {
      "main": [
        [
          {
            "node": "Pasos Listas",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Cancelado Creaci√≥n Lista",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update DATOS PARCIALES NOMBRE LISTA": {
      "main": [
        [
          {
            "node": "Crear LISTA Paso 2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Crear LISTA Paso 2": {
      "main": [
        [
          {
            "node": "Update State CREAR LISTA- PASO 2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet4": {
      "main": [
        [
          {
            "node": "Crypto2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Crypto2": {
      "main": [
        [
          {
            "node": "Append LISTA",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Habito Guardado Correctamente1": {
      "main": [
        [
          {
            "node": "Men√∫ Listas1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append LISTA": {
      "main": [
        [
          {
            "node": "Habito Guardado Correctamente1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Men√∫ Listas1": {
      "main": [
        [
          {
            "node": "Update State MENU_LISTAS1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Pasos Listas": {
      "main": [
        [
          {
            "node": "Update DATOS PARCIALES NOMBRE LISTA",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Get row(s) in sheet4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Men√∫ Listas2": {
      "main": [
        [
          {
            "node": "Update State MENU_LISTAS2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items4": {
      "main": [
        [
          {
            "node": "Men√∫ Listas3",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Mostrar Listas Mensaje",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF_menu_listas_opcion_2": {
      "main": [
        [
          {
            "node": "Get row(s) Traer Listas",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit To Log1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) Traer Listas": {
      "main": [
        [
          {
            "node": "IF THERES LISTAS?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF_menu_listas_opcion_4": {
      "main": [
        [
          {
            "node": "Menu Principal_3",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit To Log1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Men√∫ Listas3": {
      "main": [
        [
          {
            "node": "Update State MENU_LISTAS3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) Traer Listas1": {
      "main": [
        [
          {
            "node": "IF THERES LISTAS?1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF_menu_listas_opcion_3": {
      "main": [
        [
          {
            "node": "Get row(s) Traer Listas1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit To Log1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "NO TIENE LISTAS": {
      "main": [
        [
          {
            "node": "Men√∫ Listas5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Men√∫ Listas5": {
      "main": [
        [
          {
            "node": "Update State MENU_LISTAS5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF THERES LISTAS?": {
      "main": [
        [
          {
            "node": "Loop Over Items4",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "NO TIENE LISTAS",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items5": {
      "main": [
        [
          {
            "node": "Pedir ID Lista para A√±adir Item",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Mostrar Lista Mensaje5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF THERES LISTAS?1": {
      "main": [
        [
          {
            "node": "Loop Over Items5",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "NO TIENE LISTAS",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Mostrar Lista Mensaje5": {
      "main": [
        [
          {
            "node": "Loop Over Items5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HAY TAREAS": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "NO TIENE TAREAS SIN COMPLETAR1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HAY TAREAS1": {
      "main": [
        [
          {
            "node": "Loop Over Items1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "NO TIENE TAREAS SIN COMPLETAR",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Men√∫ Tareas8": {
      "main": [
        [
          {
            "node": "Update State MENU_TAREAS7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "NO TIENE TAREAS SIN COMPLETAR1": {
      "main": [
        [
          {
            "node": "Men√∫ Tareas8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "NO TIENE TAREAS SIN COMPLETAR": {
      "main": [
        [
          {
            "node": "Men√∫ Tareas8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Pedir ID Lista para A√±adir Item": {
      "main": [
        [
          {
            "node": "Update State COMPLETAR TAREA - PASO 2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Lista por ID": {
      "main": [
        [
          {
            "node": "Existe la lista y es del user?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AGREGAR ITEM A LISTA PASO 1": {
      "main": [
        [
          {
            "node": "Update State AGREGAR ITEM A LISTA - PASO ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Existe la lista y es del user?": {
      "main": [
        [
          {
            "node": "AGREGAR ITEM A LISTA PASO 1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "VOLVIENDO MENU LISTA",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Men√∫ Listas4": {
      "main": [
        [
          {
            "node": "Update State MENU_LISTAS4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "VOLVIENDO MENU LISTA": {
      "main": [
        [
          {
            "node": "Men√∫ Listas4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF no cancelar crear lista?1": {
      "main": [
        [
          {
            "node": "IF seguir a√±adiendo √≠tems",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Cancelado Adici√≥n de √çtems",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update State AGREGAR ITEM A LISTA - PASO ": {
      "main": [
        [
          {
            "node": "Update DATOS PARCIALES LISTA ID",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF seguir a√±adiendo √≠tems": {
      "main": [
        [
          {
            "node": "Code in JavaScript",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Parse Datos Parciales",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Cancelado Creaci√≥n Lista": {
      "main": [
        [
          {
            "node": "Men√∫ Listas2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Men√∫ Listas6": {
      "main": [
        [
          {
            "node": "Update State MENU_LISTAS6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Cancelado Adici√≥n de √çtems": {
      "main": [
        [
          {
            "node": "Men√∫ Listas6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript": {
      "main": [
        [
          {
            "node": "Update DATOS PARCIALES LISTA ID1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Parse Datos Parciales": {
      "main": [
        [
          {
            "node": "Code in JavaScript1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript1": {
      "main": [
        [
          {
            "node": "Loop Over Items6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items6": {
      "main": [
        [
          {
            "node": "Confirmaci√≥n √çtems Puestos",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Crypto3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append ITEM_LISTA": {
      "main": [
        [
          {
            "node": "Loop Over Items6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Crypto3": {
      "main": [
        [
          {
            "node": "Append ITEM_LISTA",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Mostrar Habitos Mensaje2": {
      "main": [
        [
          {
            "node": "Loop Over Items2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet1": {
      "main": [
        [
          {
            "node": "not empty?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Mostrar Listas √çtem Mensaje1": {
      "main": [
        [
          {
            "node": "Loop Over Items4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Mostrar Listas Mensaje": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Men√∫ Listas7": {
      "main": [
        [
          {
            "node": "Update State MENU_LISTAS7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Confirmaci√≥n √çtems Puestos": {
      "main": [
        [
          {
            "node": "Men√∫ Listas7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Menu Principal_3": {
      "main": [
        [
          {
            "node": "Update State MENU_PRINCIPAL4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "not empty?": {
      "main": [
        [
          {
            "node": "Mostrar Listas √çtem Mensaje1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Loop Over Items4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit To Log": {
      "main": [
        [
          {
            "node": "Call 'My Sub-Workflow 2'",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit To Log1": {
      "main": [
        [
          {
            "node": "Call 'My Sub-Workflow 2'1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit To Log2": {
      "main": [
        [
          {
            "node": "Call 'My Sub-Workflow 2'2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit To Log3": {
      "main": [
        [
          {
            "node": "Call 'My Sub-Workflow 2'3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Agendar_paso_1": {
      "main": [
        [
          {
            "node": "Agendar Cita Paso 2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Cancelar_agendamiento": {
      "main": [
        [
          {
            "node": "Cancelar_agendamiento_message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Agendar_paso_2": {
      "main": [
        [
          {
            "node": "Agendar Cita Paso 3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Agendar_paso_3": {
      "main": [
        [
          {
            "node": "Agendar Cita Paso 4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Agendar_paso_4": {
      "main": [
        [
          {
            "node": "Agendar Cita Paso 5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Monitor_edici√≥n": {
      "main": [
        [
          {
            "node": "If_validar_formato_fecha",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "If_validar_formato_hora",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Agendar_paso_3",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Agendar_paso_4",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Switch_tipo_canal",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Agendar_paso_5 (presencial)": {
      "main": [
        [
          {
            "node": "field_presencial",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Agendar_paso_5 (virtual)": {
      "main": [
        [
          {
            "node": "field_virtual",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Agendar_paso_5 (llamada)": {
      "main": [
        [
          {
            "node": "field_llamada",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF_cancelar_agendamiento": {
      "main": [
        [
          {
            "node": "Cancelar_agendamiento",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Monitor_edici√≥n",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "field_presencial": {
      "main": [
        [
          {
            "node": "Agendar Cita Paso 6 Confirmar",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "field_virtual": {
      "main": [
        [
          {
            "node": "Agendar Cita Paso 6 Confirmar",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "field_llamada": {
      "main": [
        [
          {
            "node": "Agendar Cita Paso 6 Confirmar",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append_cita": {
      "main": [
        [
          {
            "node": "Actualizar_estado (CONFIRMACION_CITA)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF_agendar_cita": {
      "main": [
        [
          {
            "node": "Actualizar_estado (MENU_CITAS)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Bienvenida1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Actualizar_estado (MENU_CITAS)": {
      "main": [
        [
          {
            "node": "Men√∫ Agenda",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch_MENU_CITAS": {
      "main": [
        [
          {
            "node": "Actualizar_estado (AGENDAR)",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit To Log7",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Obtener_citas",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit To Log7",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Obtener_citas1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit To Log7",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Obtener_citas2",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit To Log7",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Obtener_citas3",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit To Log7",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Actualizar_estado (MENU_PRINCIPAL) /SWITCH MENU_CITAS",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit To Log7",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Opci√≥n_no_valida (MENU_CITAS)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Actualizar_estado (AGENDAR)": {
      "main": [
        [
          {
            "node": "Agendar Cita Paso inicial",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Actualizar_estado (MENU_PRINCIPAL) /SWITCH MENU_CITAS": {
      "main": [
        [
          {
            "node": "mensaje_regreso_MENU_CITAS",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Cancelar_agendamiento_message": {
      "main": [
        [
          {
            "node": "Menu Principal3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch_tipo_canal": {
      "main": [
        [
          {
            "node": "Agendar_paso_5 (presencial)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Agendar_paso_5 (virtual)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Agendar_paso_5 (llamada)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch_edicion_creaci√≥n": {
      "main": [
        [
          {
            "node": "Append_cita",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Actualizar_estado (MENU_EDITAR)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch_CONFIRMACION_CITA": {
      "main": [
        [
          {
            "node": "Actualizar_estado (volver MENU_CITAS)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Actualizar_estado (volver MENU_PRINCIPAL)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Actualizar_estado (volver MENU_CITAS)": {
      "main": [
        [
          {
            "node": "Mostrar_Menu_agenda",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Actualizar_estado (volver MENU_PRINCIPAL)": {
      "main": [
        [
          {
            "node": "Mostrar_menu_principal",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Actualizar_estado (CONFIRMACION_CITA)": {
      "main": [
        [
          {
            "node": "Mensaje_registro_exitoso",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch_edici√≥n_cita": {
      "main": [
        [
          {
            "node": "Actualizar_estado (EDITAR_NOMBRE)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Actualizar_estado (EDITAR FECHA)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Actualizar_estado (EDITAR_HORA)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Actualizar_estado (EDITAR_MOTIVO)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Actualizar_estado (EDITAR_CANAL)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Actualizar_estado (VALIDACION)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Opci√≥n_no_valida (MENU_EDITAR)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Actualizar_estado (EDITAR FECHA)": {
      "main": [
        [
          {
            "node": "Mensaje_nueva_fecha",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Actualizar_estado (EDITAR_NOMBRE)": {
      "main": [
        [
          {
            "node": "Mensaje_nuevo_nombre",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Actualizar_estado (EDITAR_HORA)": {
      "main": [
        [
          {
            "node": "Mensaje_nueva_hora",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Actualizar_campo (fecha)": {
      "main": [
        [
          {
            "node": "Agendar Cita Paso 6 Confirmar (EDITAR_FECHA)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Actualizar_estado (MENU_EDITAR)": {
      "main": [
        [
          {
            "node": "Mensaje_edicion_cita",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Actualizar_campo (nombre)": {
      "main": [
        [
          {
            "node": "Agendar Cita Paso 6 Confirmar (EDITAR_NOMBRE)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Actualizar_campo (motivo)": {
      "main": [
        [
          {
            "node": "Agendar Cita Paso 6 Confirmar (EDITAR_MOTIVO)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Actualizar_campo (hora)": {
      "main": [
        [
          {
            "node": "Agendar Cita Paso 6 Confirmar (EDITAR_HORA)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Agendar_paso_5 (virtual)1": {
      "main": [
        [
          {
            "node": "field_virtual1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "field_presencial1": {
      "main": [
        [
          {
            "node": "Agendar Cita Paso 6 Confirmar (EDITAR_CANAL)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "field_virtual1": {
      "main": [
        [
          {
            "node": "Agendar Cita Paso 6 Confirmar (EDITAR_CANAL)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Agendar_paso_5 (llamada)1": {
      "main": [
        [
          {
            "node": "field_llamada1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "field_llamada1": {
      "main": [
        [
          {
            "node": "Agendar Cita Paso 6 Confirmar (EDITAR_CANAL)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch_editar_tipo_canal": {
      "main": [
        [
          {
            "node": "Actualizar_campo (motivo)1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Agendar_paso_5 (virtual)1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Agendar_paso_5 (llamada)1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Mensaje_elecci√≥n_incorrecta_editar",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Actualizar_campo (motivo)1": {
      "main": [
        [
          {
            "node": "field_presencial1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Actualizar_estado (EDITAR_CANAL)": {
      "main": [
        [
          {
            "node": "Mensaje_nuevo_canal",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Actualizar_estado (EDITAR_MOTIVO)": {
      "main": [
        [
          {
            "node": "Mensaje_nuevo_motivo",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Actualizar_estado (VALIDACION)": {
      "main": [
        [
          {
            "node": "Mensaje_cancelaci√≥n_edici√≥n",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Mensaje_cancelaci√≥n_edici√≥n": {
      "main": [
        [
          {
            "node": "Agendar Cita Paso 6 Confirmar1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Obtener_citas": {
      "main": [
        [
          {
            "node": "IF_revisar_citas1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Obtener_citas1": {
      "main": [
        [
          {
            "node": "IF_revisar_citas_reprogramar",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF_revisar_citas1": {
      "main": [
        [
          {
            "node": "Code in JavaScript2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Mensaje_sin_citas",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF_revisar_citas_reprogramar": {
      "main": [
        [
          {
            "node": "Obtener_formater_citas (REPROGRAMAR_CITA)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Mensaje_sin_citas_reprogramar",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Actualizar_estado (REPROGRAMAR_FECHA)": {
      "main": [
        [
          {
            "node": "Mensaje_reprogramar_citas",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Actualizar_estado (REPROGRAMAR_HORA)": {
      "main": [
        [
          {
            "node": "Mensaje_reprogramar_hora",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Reprogramar_cita": {
      "main": [
        [
          {
            "node": "Actualizar_estado-reprogramar (volver MENU_CITAS)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Actualizar_estado-reprogramar (volver MENU_CITAS)": {
      "main": [
        [
          {
            "node": "Mensaje_reprogramar_cita_resultado",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Obtener_formater_citas (REPROGRAMAR_CITA)": {
      "main": [
        [
          {
            "node": "Actualizar_estado (REPROGRAMAR_ESPERAR_ID)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Actualizar_estado (REPROGRAMAR_ESPERAR_ID)": {
      "main": [
        [
          {
            "node": "Mensaje_solicitar_cita_id",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Obtener_citas2": {
      "main": [
        [
          {
            "node": "IF_revisar_citas_cancelar",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF_revisar_citas_cancelar": {
      "main": [
        [
          {
            "node": "Obtener_cancelar_citas (CANCELAR_CITA)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Mensaje_sin_citas_cancelar",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Obtener_cancelar_citas (CANCELAR_CITA)": {
      "main": [
        [
          {
            "node": "Actualizar_estado (CANCELAR_ESPERAR_ID)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Actualizar_estado (CANCELAR_ESPERAR_ID)": {
      "main": [
        [
          {
            "node": "Mensaje_solicitar_cita_id_cancelar",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Actualizar_campo (CANCELAR)": {
      "main": [
        [
          {
            "node": "Actualizar_estado_cancelar (MENU_CITAS)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Actualizar_estado_cancelar (MENU_CITAS)": {
      "main": [
        [
          {
            "node": "Mensaje_cancelar_cita_resultado",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Obtener_citas3": {
      "main": [
        [
          {
            "node": "IF_revisar_citas_completar",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF_revisar_citas_completar": {
      "main": [
        [
          {
            "node": "Obtener_completar_citas (CCOMPLETAR_CITA)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Mensaje_sin_citas_completar",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Obtener_completar_citas (CCOMPLETAR_CITA)": {
      "main": [
        [
          {
            "node": "Actualizar_estado (COMPLETAR_ESPERAR_ID)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Actualizar_estado (COMPLETAR_ESPERAR_ID)": {
      "main": [
        [
          {
            "node": "Mensaje_solicitar_cita_id_completar",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Actualizar_campo (COMPLETAR)": {
      "main": [
        [
          {
            "node": "Actualizar_estado_completar (MENU_CITAS)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Actualizar_estado_completar (MENU_CITAS)": {
      "main": [
        [
          {
            "node": "Mensaje_completar_cita_resultado",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch_menu_principal": {
      "main": [
        [
          {
            "node": "IF_agendar_cita",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit To Log6",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Actualizar_estado (MENU_RECORDATORIOS)",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit To Log6",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Obtener_citas_reportes",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit To Log6",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Actualizar_estado (MENU_CONFIGURACION)",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit To Log6",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Obtener_usuario",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit To Log6",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "IF NO MENU ARRIBA",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Actualizar_estado (MENU_CONFIGURACION)": {
      "main": [
        [
          {
            "node": "Mensaje_menu_configuracion",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch_menu_configuracion": {
      "main": [
        [
          {
            "node": "Mensaje_user_info",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Actualizar_estado_reinicio (MENU_PRINCIPAL)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Actualizar_estado_regreso (MENU_PRINCIPAL)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Actualizar_estado_reinicio (MENU_PRINCIPAL)": {
      "main": [
        [
          {
            "node": "Mensaje_user_reinicio",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Mensaje_user_reinicio": {
      "main": [
        [
          {
            "node": "Mensaje_user_menu_principal",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If_es_ADMIN?": {
      "main": [
        [
          {
            "node": "Actualizar_estado (MENU_ADMIN)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Mensaje_denegacion_permiso",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Obtener_usuario": {
      "main": [
        [
          {
            "node": "If_es_ADMIN?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Actualizar_estado (MENU_ADMIN)": {
      "main": [
        [
          {
            "node": "Mensaje_MENU_ADMIN",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch_ADMIN": {
      "main": [
        [
          {
            "node": "Obtener_citas_global",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit To Log4",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Obtener_sesiones_global_estadisticas",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit To Log4",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Actualizar_estado (ADMIN_BROADCAST)",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit To Log4",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Actualizar_estado_cancelaci√≥n (MENU_PRINCIPAL)",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit To Log4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Obtener_citas_global": {
      "main": [
        [
          {
            "node": "IF_revisar_citas_global",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF_revisar_citas_global": {
      "main": [
        [
          {
            "node": "Obtener_citas (global)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Mensaje_sin citas_global",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Obtener_citas (global)": {
      "main": [
        [
          {
            "node": "Mensaje_citas_global",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Obtener_citas_global_estadisticas": {
      "main": [
        [
          {
            "node": "Formatear_campos_estadisticas",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Obtener_sesiones_global_estadisticas": {
      "main": [
        [
          {
            "node": "Obtener_citas_global_estadisticas",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Formatear_campos_estadisticas": {
      "main": [
        [
          {
            "node": "Mensaje_sin citas_global1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Actualizar_estado (ADMIN_BROADCAST)": {
      "main": [
        [
          {
            "node": "Mensaje_solicitar_broadcast_global",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Actualizar_estado (ADMIN_BROADCAST_CONFIRMAR)": {
      "main": [
        [
          {
            "node": "Mensaje_previo_global",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch_confirmar_mensaje_global": {
      "main": [
        [
          {
            "node": "Obtener_sesiones_mensaje_global",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Actualizar_estado_cancelaci√≥n (MENU_ADMIN)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Actualizar_estado_cancelaci√≥n (MENU_ADMIN)": {
      "main": [
        [
          {
            "node": "Mensaje_cancelaci√≥n_global",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Obtener_sesiones_mensaje_global": {
      "main": [
        [
          {
            "node": "Filter",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Filter": {
      "main": [
        [
          {
            "node": "Mensaje_envio_global",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Actualizar_estado_exitoso (MENU_ADMIN)": {
      "main": [
        [
          {
            "node": "Mensaje_MENU_ADMIN1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Mensaje_envio_global": {
      "main": [
        [
          {
            "node": "Actualizar_estado_exitoso (MENU_ADMIN)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Actualizar_estado_cancelaci√≥n (MENU_PRINCIPAL)": {
      "main": [
        [
          {
            "node": "Mensaje_salir_admin",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Mensaje_salir_admin": {
      "main": [
        [
          {
            "node": "Menu Principal1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Obtener_citas_verificacion_dovle_reserva": {
      "main": [
        [
          {
            "node": "Code in JavaScript3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If_citas_repetidas_fecha": {
      "main": [
        [
          {
            "node": "Error Doble Reserva",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Agendar_paso_2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If_validar_formato_fecha": {
      "main": [
        [
          {
            "node": "If1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Fecha Invalida2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If_validar_formato_hora": {
      "main": [
        [
          {
            "node": "Obtener_citas_verificacion_dovle_reserva",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Hora Invalida",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If_validar_fecha_reprogramar1": {
      "main": [
        [
          {
            "node": "Actualizar_estado (REPROGRAMAR_HORA)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Fecha en el pasado_reprogramar1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If_validar_formato_fecha_reprogramar1": {
      "main": [
        [
          {
            "node": "If_validar_fecha_reprogramar1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Fecha Invalida_reprogramar1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If_validar_formato_hora_reprogramar": {
      "main": [
        [
          {
            "node": "Reprogramar_cita",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Hora Invalida_reprogramar",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If_validar_formato_hora_actualizar": {
      "main": [
        [
          {
            "node": "Actualizar_campo (hora)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Hora Invalida_actualizar",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If_validar_formato_fecha_reprogramar": {
      "main": [
        [
          {
            "node": "If_fecha_v√°lida_reprogramar",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Fecha Invalida_reprogramar",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If_fecha_v√°lida_reprogramar": {
      "main": [
        [
          {
            "node": "Actualizar_campo (fecha)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Fecha en el pasado_reprogramar",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Actualizar_estado (MENU_RECORDATORIOS)": {
      "main": [
        [
          {
            "node": "Mensaje_Menue_recordatorios",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch_menu_recordatorios": {
      "main": [
        [
          {
            "node": "Actualizar_estado (REC_CAMBIAR_TIEMPO)",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit To Log5",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Cambiar_aviso",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit To Log5",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Actualizar_estado_recordatorios (MENU_PRINCIPAL)",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit To Log5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Actualizar_estado (REC_CAMBIAR_TIEMPO)": {
      "main": [
        [
          {
            "node": "Mensaje_submenu_recordatorio",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Cambiar_preferencia (30 min)": {
      "main": [
        [
          {
            "node": "Mensaje_preferencia_cambiada",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Actualizar_estado_cancelaci√≥n (MENU_ADMIN)1": {
      "main": [
        [
          {
            "node": "Mensaje_Menu_recordatorios_volver",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch_preferencia_recordatorios": {
      "main": [
        [
          {
            "node": "Cambiar_preferencia (30 min)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Cambiar_preferencia (1h)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Cambiar_preferencia (1D)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Actualizar_estado_cancelaci√≥n (MENU_ADMIN)3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Cambiar_preferencia (1h)": {
      "main": [
        [
          {
            "node": "Mensaje_preferencia_cambiada",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Cambiar_preferencia (1D)": {
      "main": [
        [
          {
            "node": "Mensaje_preferencia_cambiada",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Actualizar_estado_cancelaci√≥n (MENU_ADMIN)3": {
      "main": [
        [
          {
            "node": "Mensaje_preferencia_cambiada",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Mensaje_preferencia_cambiada": {
      "main": [
        [
          {
            "node": "Actualizar_estado_cancelaci√≥n (MENU_ADMIN)1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Cambiar_aviso": {
      "main": [
        [
          {
            "node": "Mensaje_cambiar_aviso",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Mensaje_cambiar_aviso": {
      "main": [
        [
          {
            "node": "Mensaje_Menu_recordatorios_aviso",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Actualizar_estado_recordatorios (MENU_PRINCIPAL)": {
      "main": [
        [
          {
            "node": "Mensaje_volver_recordatorio_menu_principal",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Obtener_citas_reportes": {
      "main": [
        [
          {
            "node": "Procesar_reporte",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Procesar_reporte": {
      "main": [
        [
          {
            "node": "Mensaje_reporte",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Mensaje_reporte": {
      "main": [
        [
          {
            "node": "Menu Principal4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Actualizar_estado_regreso (MENU_PRINCIPAL)": {
      "main": [
        [
          {
            "node": "Menu Principal_regreso",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "CEREBRO_PRINCIPAL1": {
      "main": [
        [
          {
            "node": "Switch_menu_principal",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "IF_cancelar_agendamiento",
            "type": "main",
            "index": 0
          }
        ],
        [],
        [
          {
            "node": "Switch_MENU_CITAS",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Switch_CONFIRMACION_CITA",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Switch_edici√≥n_cita",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "If_validar_formato_fecha_reprogramar",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Actualizar_campo (nombre)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "If_validar_formato_hora_actualizar",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Actualizar_campo (motivo)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Switch_editar_tipo_canal",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Actualizar_estado (REPROGRAMAR_FECHA)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "If_validar_formato_fecha_reprogramar1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "If_validar_formato_hora_reprogramar",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Actualizar_campo (CANCELAR)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Actualizar_campo (COMPLETAR)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Switch_menu_configuracion",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Switch_ADMIN",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Actualizar_estado (ADMIN_BROADCAST_CONFIRMAR)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Switch_confirmar_mensaje_global",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Switch_menu_recordatorios",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Switch_preferencia_recordatorios",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Switch_edicion_creaci√≥n",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Opci√≥n No Valida1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Bienvenida1": {
      "main": [
        [
          {
            "node": "Menu Principal",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript2": {
      "main": [
        [
          {
            "node": "Mensaje_citas_resultado",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript3": {
      "main": [
        [
          {
            "node": "If_citas_repetidas_fecha",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If1": {
      "main": [
        [
          {
            "node": "Agendar_paso_1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Fecha en el pasado1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit To Log4": {
      "main": [
        [
          {
            "node": "Call 'My Sub-Workflow 2'4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit To Log5": {
      "main": [
        [
          {
            "node": "Call 'My Sub-Workflow 2'5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit To Log6": {
      "main": [
        [
          {
            "node": "Call 'My Sub-Workflow 2'6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit To Log7": {
      "main": [
        [
          {
            "node": "Call 'My Sub-Workflow 2'7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Tarea Guardada Correctamente": {
      "main": [
        [
          {
            "node": "Men√∫ Tareas2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF NO MENU ARRIBA": {
      "main": [
        [
          {
            "node": "Menu Principal2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1",
    "availableInMCP": false
  },
  "versionId": "52d7915a-18da-4519-9717-fbf5dd977cc5",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "8b7b70b82f260dd84cef69378d5fb96b8373c4e2539cba617c61d23378f57a56"
  },
  "id": "gEtvU0EozZIeDpqh80YRw",
  "tags": []
}